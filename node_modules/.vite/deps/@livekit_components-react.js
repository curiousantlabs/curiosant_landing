import {
  ConnectionQuality,
  ConnectionState,
  LocalTrackPublication,
  LogLevel,
  MediaDeviceFailure,
  ParticipantEvent,
  ParticipantInfo_Kind,
  RemoteAudioTrack,
  RemoteTrackPublication,
  Room,
  RoomEvent,
  TokenSourceConfigurable,
  Track,
  TrackEvent,
  VideoPresets,
  _,
  compareVersions,
  createAudioAnalyser,
  createLocalAudioTrack,
  createLocalTracks,
  createLocalVideoTrack,
  decodeTokenPayload,
  facingModeFromLocalTrack,
  getBrowser,
  setLogExtension,
  setLogLevel
} from "./chunk-2GPH5UO5.js";
import {
  require_react
} from "./chunk-PMKBOVCG.js";
import {
  __toESM
} from "./chunk-G3PMV62Z.js";

// node_modules/@livekit/components-react/dist/hooks-yU-srrIO.mjs
var s = __toESM(require_react(), 1);
var import_react = __toESM(require_react(), 1);

// node_modules/@livekit/components-react/dist/contexts-CsO1QZ3r.mjs
var I = __toESM(require_react(), 1);
var De = Math.min;
var ue = Math.max;
var $e = Math.round;
var _e = Math.floor;
var J = (e3) => ({
  x: e3,
  y: e3
});
var Jn = {
  left: "right",
  right: "left",
  bottom: "top",
  top: "bottom"
};
var Xn = {
  start: "end",
  end: "start"
};
function Et(e3, t, n) {
  return ue(e3, De(t, n));
}
function He(e3, t) {
  return typeof e3 == "function" ? e3(t) : e3;
}
function le(e3) {
  return e3.split("-")[0];
}
function ze(e3) {
  return e3.split("-")[1];
}
function Qt(e3) {
  return e3 === "x" ? "y" : "x";
}
function Jt(e3) {
  return e3 === "y" ? "height" : "width";
}
var Zn = /* @__PURE__ */ new Set(["top", "bottom"]);
function ie(e3) {
  return Zn.has(le(e3)) ? "y" : "x";
}
function Xt(e3) {
  return Qt(ie(e3));
}
function er(e3, t, n) {
  n === void 0 && (n = false);
  const r = ze(e3), i2 = Xt(e3), o = Jt(i2);
  let s2 = i2 === "x" ? r === (n ? "end" : "start") ? "right" : "left" : r === "start" ? "bottom" : "top";
  return t.reference[o] > t.floating[o] && (s2 = Ne(s2)), [s2, Ne(s2)];
}
function tr(e3) {
  const t = Ne(e3);
  return [st(e3), t, st(t)];
}
function st(e3) {
  return e3.replace(/start|end/g, (t) => Xn[t]);
}
var Ct = ["left", "right"];
var Pt = ["right", "left"];
var nr = ["top", "bottom"];
var rr = ["bottom", "top"];
function ir(e3, t, n) {
  switch (e3) {
    case "top":
    case "bottom":
      return n ? t ? Pt : Ct : t ? Ct : Pt;
    case "left":
    case "right":
      return t ? nr : rr;
    default:
      return [];
  }
}
function or(e3, t, n, r) {
  const i2 = ze(e3);
  let o = ir(le(e3), n === "start", r);
  return i2 && (o = o.map((s2) => s2 + "-" + i2), t && (o = o.concat(o.map(st)))), o;
}
function Ne(e3) {
  return e3.replace(/left|right|bottom|top/g, (t) => Jn[t]);
}
function sr(e3) {
  return {
    top: 0,
    right: 0,
    bottom: 0,
    left: 0,
    ...e3
  };
}
function ar(e3) {
  return typeof e3 != "number" ? sr(e3) : {
    top: e3,
    right: e3,
    bottom: e3,
    left: e3
  };
}
function Fe(e3) {
  const {
    x: t,
    y: n,
    width: r,
    height: i2
  } = e3;
  return {
    width: r,
    height: i2,
    top: n,
    left: t,
    right: t + r,
    bottom: n + i2,
    x: t,
    y: n
  };
}
function Ot(e3, t, n) {
  let {
    reference: r,
    floating: i2
  } = e3;
  const o = ie(t), s2 = Xt(t), a = Jt(s2), c = le(t), u = o === "y", l = r.x + r.width / 2 - i2.width / 2, f = r.y + r.height / 2 - i2.height / 2, v = r[a] / 2 - i2[a] / 2;
  let d;
  switch (c) {
    case "top":
      d = {
        x: l,
        y: r.y - i2.height
      };
      break;
    case "bottom":
      d = {
        x: l,
        y: r.y + r.height
      };
      break;
    case "right":
      d = {
        x: r.x + r.width,
        y: f
      };
      break;
    case "left":
      d = {
        x: r.x - i2.width,
        y: f
      };
      break;
    default:
      d = {
        x: r.x,
        y: r.y
      };
  }
  switch (ze(t)) {
    case "start":
      d[s2] -= v * (n && u ? -1 : 1);
      break;
    case "end":
      d[s2] += v * (n && u ? -1 : 1);
      break;
  }
  return d;
}
var cr = async (e3, t, n) => {
  const {
    placement: r = "bottom",
    strategy: i2 = "absolute",
    middleware: o = [],
    platform: s2
  } = n, a = o.filter(Boolean), c = await (s2.isRTL == null ? void 0 : s2.isRTL(t));
  let u = await s2.getElementRects({
    reference: e3,
    floating: t,
    strategy: i2
  }), {
    x: l,
    y: f
  } = Ot(u, r, c), v = r, d = {}, m = 0;
  for (let p = 0; p < a.length; p++) {
    const {
      name: g,
      fn: h
    } = a[p], {
      x: x2,
      y: E,
      data: O2,
      reset: b
    } = await h({
      x: l,
      y: f,
      initialPlacement: r,
      placement: v,
      strategy: i2,
      middlewareData: d,
      rects: u,
      platform: s2,
      elements: {
        reference: e3,
        floating: t
      }
    });
    l = x2 ?? l, f = E ?? f, d = {
      ...d,
      [g]: {
        ...d[g],
        ...O2
      }
    }, b && m <= 50 && (m++, typeof b == "object" && (b.placement && (v = b.placement), b.rects && (u = b.rects === true ? await s2.getElementRects({
      reference: e3,
      floating: t,
      strategy: i2
    }) : b.rects), {
      x: l,
      y: f
    } = Ot(u, v, c)), p = -1);
  }
  return {
    x: l,
    y: f,
    placement: v,
    strategy: i2,
    middlewareData: d
  };
};
async function Zt(e3, t) {
  var n;
  t === void 0 && (t = {});
  const {
    x: r,
    y: i2,
    platform: o,
    rects: s2,
    elements: a,
    strategy: c
  } = e3, {
    boundary: u = "clippingAncestors",
    rootBoundary: l = "viewport",
    elementContext: f = "floating",
    altBoundary: v = false,
    padding: d = 0
  } = He(t, e3), m = ar(d), g = a[v ? f === "floating" ? "reference" : "floating" : f], h = Fe(await o.getClippingRect({
    element: (n = await (o.isElement == null ? void 0 : o.isElement(g))) == null || n ? g : g.contextElement || await (o.getDocumentElement == null ? void 0 : o.getDocumentElement(a.floating)),
    boundary: u,
    rootBoundary: l,
    strategy: c
  })), x2 = f === "floating" ? {
    x: r,
    y: i2,
    width: s2.floating.width,
    height: s2.floating.height
  } : s2.reference, E = await (o.getOffsetParent == null ? void 0 : o.getOffsetParent(a.floating)), O2 = await (o.isElement == null ? void 0 : o.isElement(E)) ? await (o.getScale == null ? void 0 : o.getScale(E)) || {
    x: 1,
    y: 1
  } : {
    x: 1,
    y: 1
  }, b = Fe(o.convertOffsetParentRelativeRectToViewportRelativeRect ? await o.convertOffsetParentRelativeRectToViewportRelativeRect({
    elements: a,
    rect: x2,
    offsetParent: E,
    strategy: c
  }) : x2);
  return {
    top: (h.top - b.top + m.top) / O2.y,
    bottom: (b.bottom - h.bottom + m.bottom) / O2.y,
    left: (h.left - b.left + m.left) / O2.x,
    right: (b.right - h.right + m.right) / O2.x
  };
}
var ur = function(e3) {
  return e3 === void 0 && (e3 = {}), {
    name: "flip",
    options: e3,
    async fn(t) {
      var n, r;
      const {
        placement: i2,
        middlewareData: o,
        rects: s2,
        initialPlacement: a,
        platform: c,
        elements: u
      } = t, {
        mainAxis: l = true,
        crossAxis: f = true,
        fallbackPlacements: v,
        fallbackStrategy: d = "bestFit",
        fallbackAxisSideDirection: m = "none",
        flipAlignment: p = true,
        ...g
      } = He(e3, t);
      if ((n = o.arrow) != null && n.alignmentOffset)
        return {};
      const h = le(i2), x2 = ie(a), E = le(a) === a, O2 = await (c.isRTL == null ? void 0 : c.isRTL(u.floating)), b = v || (E || !p ? [Ne(a)] : tr(a)), S = m !== "none";
      !v && S && b.push(...or(a, p, m, O2));
      const C = [a, ...b], $2 = await Zt(t, g), M2 = [];
      let V2 = ((r = o.flip) == null ? void 0 : r.overflows) || [];
      if (l && M2.push($2[h]), f) {
        const Q2 = er(i2, s2, O2);
        M2.push($2[Q2[0]], $2[Q2[1]]);
      }
      if (V2 = [...V2, {
        placement: i2,
        overflows: M2
      }], !M2.every((Q2) => Q2 <= 0)) {
        var T2, _2;
        const Q2 = (((T2 = o.flip) == null ? void 0 : T2.index) || 0) + 1, Se3 = C[Q2];
        if (Se3 && (!(f === "alignment" ? x2 !== ie(Se3) : false) || // We leave the current main axis only if every placement on that axis
        // overflows the main axis.
        V2.every((Y2) => ie(Y2.placement) === x2 ? Y2.overflows[0] > 0 : true)))
          return {
            data: {
              index: Q2,
              overflows: V2
            },
            reset: {
              placement: Se3
            }
          };
        let Te2 = (_2 = V2.filter((ae2) => ae2.overflows[0] <= 0).sort((ae2, Y2) => ae2.overflows[1] - Y2.overflows[1])[0]) == null ? void 0 : _2.placement;
        if (!Te2)
          switch (d) {
            case "bestFit": {
              var ee3;
              const ae2 = (ee3 = V2.filter((Y2) => {
                if (S) {
                  const re2 = ie(Y2.placement);
                  return re2 === x2 || // Create a bias to the `y` side axis due to horizontal
                  // reading directions favoring greater width.
                  re2 === "y";
                }
                return true;
              }).map((Y2) => [Y2.placement, Y2.overflows.filter((re2) => re2 > 0).reduce((re2, Yn2) => re2 + Yn2, 0)]).sort((Y2, re2) => Y2[1] - re2[1])[0]) == null ? void 0 : ee3[0];
              ae2 && (Te2 = ae2);
              break;
            }
            case "initialPlacement":
              Te2 = a;
              break;
          }
        if (i2 !== Te2)
          return {
            reset: {
              placement: Te2
            }
          };
      }
      return {};
    }
  };
};
var lr = /* @__PURE__ */ new Set(["left", "top"]);
async function fr(e3, t) {
  const {
    placement: n,
    platform: r,
    elements: i2
  } = e3, o = await (r.isRTL == null ? void 0 : r.isRTL(i2.floating)), s2 = le(n), a = ze(n), c = ie(n) === "y", u = lr.has(s2) ? -1 : 1, l = o && c ? -1 : 1, f = He(t, e3);
  let {
    mainAxis: v,
    crossAxis: d,
    alignmentAxis: m
  } = typeof f == "number" ? {
    mainAxis: f,
    crossAxis: 0,
    alignmentAxis: null
  } : {
    mainAxis: f.mainAxis || 0,
    crossAxis: f.crossAxis || 0,
    alignmentAxis: f.alignmentAxis
  };
  return a && typeof m == "number" && (d = a === "end" ? m * -1 : m), c ? {
    x: d * l,
    y: v * u
  } : {
    x: v * u,
    y: d * l
  };
}
var dr = function(e3) {
  return e3 === void 0 && (e3 = 0), {
    name: "offset",
    options: e3,
    async fn(t) {
      var n, r;
      const {
        x: i2,
        y: o,
        placement: s2,
        middlewareData: a
      } = t, c = await fr(t, e3);
      return s2 === ((n = a.offset) == null ? void 0 : n.placement) && (r = a.arrow) != null && r.alignmentOffset ? {} : {
        x: i2 + c.x,
        y: o + c.y,
        data: {
          ...c,
          placement: s2
        }
      };
    }
  };
};
var pr = function(e3) {
  return e3 === void 0 && (e3 = {}), {
    name: "shift",
    options: e3,
    async fn(t) {
      const {
        x: n,
        y: r,
        placement: i2
      } = t, {
        mainAxis: o = true,
        crossAxis: s2 = false,
        limiter: a = {
          fn: (g) => {
            let {
              x: h,
              y: x2
            } = g;
            return {
              x: h,
              y: x2
            };
          }
        },
        ...c
      } = He(e3, t), u = {
        x: n,
        y: r
      }, l = await Zt(t, c), f = ie(le(i2)), v = Qt(f);
      let d = u[v], m = u[f];
      if (o) {
        const g = v === "y" ? "top" : "left", h = v === "y" ? "bottom" : "right", x2 = d + l[g], E = d - l[h];
        d = Et(x2, d, E);
      }
      if (s2) {
        const g = f === "y" ? "top" : "left", h = f === "y" ? "bottom" : "right", x2 = m + l[g], E = m - l[h];
        m = Et(x2, m, E);
      }
      const p = a.fn({
        ...t,
        [v]: d,
        [f]: m
      });
      return {
        ...p,
        data: {
          x: p.x - n,
          y: p.y - r,
          enabled: {
            [v]: o,
            [f]: s2
          }
        }
      };
    }
  };
};
function Ye() {
  return typeof window < "u";
}
function ye(e3) {
  return en(e3) ? (e3.nodeName || "").toLowerCase() : "#document";
}
function j(e3) {
  var t;
  return (e3 == null || (t = e3.ownerDocument) == null ? void 0 : t.defaultView) || window;
}
function Z(e3) {
  var t;
  return (t = (en(e3) ? e3.ownerDocument : e3.document) || window.document) == null ? void 0 : t.documentElement;
}
function en(e3) {
  return Ye() ? e3 instanceof Node || e3 instanceof j(e3).Node : false;
}
function K(e3) {
  return Ye() ? e3 instanceof Element || e3 instanceof j(e3).Element : false;
}
function X(e3) {
  return Ye() ? e3 instanceof HTMLElement || e3 instanceof j(e3).HTMLElement : false;
}
function At(e3) {
  return !Ye() || typeof ShadowRoot > "u" ? false : e3 instanceof ShadowRoot || e3 instanceof j(e3).ShadowRoot;
}
var hr = /* @__PURE__ */ new Set(["inline", "contents"]);
function Ae(e3) {
  const {
    overflow: t,
    overflowX: n,
    overflowY: r,
    display: i2
  } = G(e3);
  return /auto|scroll|overlay|hidden|clip/.test(t + r + n) && !hr.has(i2);
}
var vr = /* @__PURE__ */ new Set(["table", "td", "th"]);
function mr(e3) {
  return vr.has(ye(e3));
}
var gr = [":popover-open", ":modal"];
function qe(e3) {
  return gr.some((t) => {
    try {
      return e3.matches(t);
    } catch {
      return false;
    }
  });
}
var br = ["transform", "translate", "scale", "rotate", "perspective"];
var yr = ["transform", "translate", "scale", "rotate", "perspective", "filter"];
var wr = ["paint", "layout", "strict", "content"];
function pt(e3) {
  const t = ht(), n = K(e3) ? G(e3) : e3;
  return br.some((r) => n[r] ? n[r] !== "none" : false) || (n.containerType ? n.containerType !== "normal" : false) || !t && (n.backdropFilter ? n.backdropFilter !== "none" : false) || !t && (n.filter ? n.filter !== "none" : false) || yr.some((r) => (n.willChange || "").includes(r)) || wr.some((r) => (n.contain || "").includes(r));
}
function xr(e3) {
  let t = se(e3);
  for (; X(t) && !me(t); ) {
    if (pt(t))
      return t;
    if (qe(t))
      return null;
    t = se(t);
  }
  return null;
}
function ht() {
  return typeof CSS > "u" || !CSS.supports ? false : CSS.supports("-webkit-backdrop-filter", "none");
}
var Sr = /* @__PURE__ */ new Set(["html", "body", "#document"]);
function me(e3) {
  return Sr.has(ye(e3));
}
function G(e3) {
  return j(e3).getComputedStyle(e3);
}
function Ke(e3) {
  return K(e3) ? {
    scrollLeft: e3.scrollLeft,
    scrollTop: e3.scrollTop
  } : {
    scrollLeft: e3.scrollX,
    scrollTop: e3.scrollY
  };
}
function se(e3) {
  if (ye(e3) === "html")
    return e3;
  const t = (
    // Step into the shadow DOM of the parent of a slotted node.
    e3.assignedSlot || // DOM Element detected.
    e3.parentNode || // ShadowRoot detected.
    At(e3) && e3.host || // Fallback.
    Z(e3)
  );
  return At(t) ? t.host : t;
}
function tn(e3) {
  const t = se(e3);
  return me(t) ? e3.ownerDocument ? e3.ownerDocument.body : e3.body : X(t) && Ae(t) ? t : tn(t);
}
function Ce(e3, t, n) {
  var r;
  t === void 0 && (t = []), n === void 0 && (n = true);
  const i2 = tn(e3), o = i2 === ((r = e3.ownerDocument) == null ? void 0 : r.body), s2 = j(i2);
  if (o) {
    const a = at(s2);
    return t.concat(s2, s2.visualViewport || [], Ae(i2) ? i2 : [], a && n ? Ce(a) : []);
  }
  return t.concat(i2, Ce(i2, [], n));
}
function at(e3) {
  return e3.parent && Object.getPrototypeOf(e3.parent) ? e3.frameElement : null;
}
function nn(e3) {
  const t = G(e3);
  let n = parseFloat(t.width) || 0, r = parseFloat(t.height) || 0;
  const i2 = X(e3), o = i2 ? e3.offsetWidth : n, s2 = i2 ? e3.offsetHeight : r, a = $e(n) !== o || $e(r) !== s2;
  return a && (n = o, r = s2), {
    width: n,
    height: r,
    $: a
  };
}
function vt(e3) {
  return K(e3) ? e3 : e3.contextElement;
}
function he(e3) {
  const t = vt(e3);
  if (!X(t))
    return J(1);
  const n = t.getBoundingClientRect(), {
    width: r,
    height: i2,
    $: o
  } = nn(t);
  let s2 = (o ? $e(n.width) : n.width) / r, a = (o ? $e(n.height) : n.height) / i2;
  return (!s2 || !Number.isFinite(s2)) && (s2 = 1), (!a || !Number.isFinite(a)) && (a = 1), {
    x: s2,
    y: a
  };
}
var Tr = J(0);
function rn(e3) {
  const t = j(e3);
  return !ht() || !t.visualViewport ? Tr : {
    x: t.visualViewport.offsetLeft,
    y: t.visualViewport.offsetTop
  };
}
function Er(e3, t, n) {
  return t === void 0 && (t = false), !n || t && n !== j(e3) ? false : t;
}
function fe(e3, t, n, r) {
  t === void 0 && (t = false), n === void 0 && (n = false);
  const i2 = e3.getBoundingClientRect(), o = vt(e3);
  let s2 = J(1);
  t && (r ? K(r) && (s2 = he(r)) : s2 = he(e3));
  const a = Er(o, n, r) ? rn(o) : J(0);
  let c = (i2.left + a.x) / s2.x, u = (i2.top + a.y) / s2.y, l = i2.width / s2.x, f = i2.height / s2.y;
  if (o) {
    const v = j(o), d = r && K(r) ? j(r) : r;
    let m = v, p = at(m);
    for (; p && r && d !== m; ) {
      const g = he(p), h = p.getBoundingClientRect(), x2 = G(p), E = h.left + (p.clientLeft + parseFloat(x2.paddingLeft)) * g.x, O2 = h.top + (p.clientTop + parseFloat(x2.paddingTop)) * g.y;
      c *= g.x, u *= g.y, l *= g.x, f *= g.y, c += E, u += O2, m = j(p), p = at(m);
    }
  }
  return Fe({
    width: l,
    height: f,
    x: c,
    y: u
  });
}
function Ge(e3, t) {
  const n = Ke(e3).scrollLeft;
  return t ? t.left + n : fe(Z(e3)).left + n;
}
function on(e3, t) {
  const n = e3.getBoundingClientRect(), r = n.left + t.scrollLeft - Ge(e3, n), i2 = n.top + t.scrollTop;
  return {
    x: r,
    y: i2
  };
}
function Cr(e3) {
  let {
    elements: t,
    rect: n,
    offsetParent: r,
    strategy: i2
  } = e3;
  const o = i2 === "fixed", s2 = Z(r), a = t ? qe(t.floating) : false;
  if (r === s2 || a && o)
    return n;
  let c = {
    scrollLeft: 0,
    scrollTop: 0
  }, u = J(1);
  const l = J(0), f = X(r);
  if ((f || !f && !o) && ((ye(r) !== "body" || Ae(s2)) && (c = Ke(r)), X(r))) {
    const d = fe(r);
    u = he(r), l.x = d.x + r.clientLeft, l.y = d.y + r.clientTop;
  }
  const v = s2 && !f && !o ? on(s2, c) : J(0);
  return {
    width: n.width * u.x,
    height: n.height * u.y,
    x: n.x * u.x - c.scrollLeft * u.x + l.x + v.x,
    y: n.y * u.y - c.scrollTop * u.y + l.y + v.y
  };
}
function Pr(e3) {
  return Array.from(e3.getClientRects());
}
function Or(e3) {
  const t = Z(e3), n = Ke(e3), r = e3.ownerDocument.body, i2 = ue(t.scrollWidth, t.clientWidth, r.scrollWidth, r.clientWidth), o = ue(t.scrollHeight, t.clientHeight, r.scrollHeight, r.clientHeight);
  let s2 = -n.scrollLeft + Ge(e3);
  const a = -n.scrollTop;
  return G(r).direction === "rtl" && (s2 += ue(t.clientWidth, r.clientWidth) - i2), {
    width: i2,
    height: o,
    x: s2,
    y: a
  };
}
var kt = 25;
function Ar(e3, t) {
  const n = j(e3), r = Z(e3), i2 = n.visualViewport;
  let o = r.clientWidth, s2 = r.clientHeight, a = 0, c = 0;
  if (i2) {
    o = i2.width, s2 = i2.height;
    const l = ht();
    (!l || l && t === "fixed") && (a = i2.offsetLeft, c = i2.offsetTop);
  }
  const u = Ge(r);
  if (u <= 0) {
    const l = r.ownerDocument, f = l.body, v = getComputedStyle(f), d = l.compatMode === "CSS1Compat" && parseFloat(v.marginLeft) + parseFloat(v.marginRight) || 0, m = Math.abs(r.clientWidth - f.clientWidth - d);
    m <= kt && (o -= m);
  } else u <= kt && (o += u);
  return {
    width: o,
    height: s2,
    x: a,
    y: c
  };
}
var kr = /* @__PURE__ */ new Set(["absolute", "fixed"]);
function _r(e3, t) {
  const n = fe(e3, true, t === "fixed"), r = n.top + e3.clientTop, i2 = n.left + e3.clientLeft, o = X(e3) ? he(e3) : J(1), s2 = e3.clientWidth * o.x, a = e3.clientHeight * o.y, c = i2 * o.x, u = r * o.y;
  return {
    width: s2,
    height: a,
    x: c,
    y: u
  };
}
function _t(e3, t, n) {
  let r;
  if (t === "viewport")
    r = Ar(e3, n);
  else if (t === "document")
    r = Or(Z(e3));
  else if (K(t))
    r = _r(t, n);
  else {
    const i2 = rn(e3);
    r = {
      x: t.x - i2.x,
      y: t.y - i2.y,
      width: t.width,
      height: t.height
    };
  }
  return Fe(r);
}
function sn(e3, t) {
  const n = se(e3);
  return n === t || !K(n) || me(n) ? false : G(n).position === "fixed" || sn(n, t);
}
function Lr(e3, t) {
  const n = t.get(e3);
  if (n)
    return n;
  let r = Ce(e3, [], false).filter((a) => K(a) && ye(a) !== "body"), i2 = null;
  const o = G(e3).position === "fixed";
  let s2 = o ? se(e3) : e3;
  for (; K(s2) && !me(s2); ) {
    const a = G(s2), c = pt(s2);
    !c && a.position === "fixed" && (i2 = null), (o ? !c && !i2 : !c && a.position === "static" && !!i2 && kr.has(i2.position) || Ae(s2) && !c && sn(e3, s2)) ? r = r.filter((l) => l !== s2) : i2 = a, s2 = se(s2);
  }
  return t.set(e3, r), r;
}
function Ir(e3) {
  let {
    element: t,
    boundary: n,
    rootBoundary: r,
    strategy: i2
  } = e3;
  const s2 = [...n === "clippingAncestors" ? qe(t) ? [] : Lr(t, this._c) : [].concat(n), r], a = s2[0], c = s2.reduce((u, l) => {
    const f = _t(t, l, i2);
    return u.top = ue(f.top, u.top), u.right = De(f.right, u.right), u.bottom = De(f.bottom, u.bottom), u.left = ue(f.left, u.left), u;
  }, _t(t, a, i2));
  return {
    width: c.right - c.left,
    height: c.bottom - c.top,
    x: c.left,
    y: c.top
  };
}
function Mr(e3) {
  const {
    width: t,
    height: n
  } = nn(e3);
  return {
    width: t,
    height: n
  };
}
function Rr(e3, t, n) {
  const r = X(t), i2 = Z(t), o = n === "fixed", s2 = fe(e3, true, o, t);
  let a = {
    scrollLeft: 0,
    scrollTop: 0
  };
  const c = J(0);
  function u() {
    c.x = Ge(i2);
  }
  if (r || !r && !o)
    if ((ye(t) !== "body" || Ae(i2)) && (a = Ke(t)), r) {
      const d = fe(t, true, o, t);
      c.x = d.x + t.clientLeft, c.y = d.y + t.clientTop;
    } else i2 && u();
  o && !r && i2 && u();
  const l = i2 && !r && !o ? on(i2, a) : J(0), f = s2.left + a.scrollLeft - c.x - l.x, v = s2.top + a.scrollTop - c.y - l.y;
  return {
    x: f,
    y: v,
    width: s2.width,
    height: s2.height
  };
}
function et(e3) {
  return G(e3).position === "static";
}
function Lt(e3, t) {
  if (!X(e3) || G(e3).position === "fixed")
    return null;
  if (t)
    return t(e3);
  let n = e3.offsetParent;
  return Z(e3) === n && (n = n.ownerDocument.body), n;
}
function an(e3, t) {
  const n = j(e3);
  if (qe(e3))
    return n;
  if (!X(e3)) {
    let i2 = se(e3);
    for (; i2 && !me(i2); ) {
      if (K(i2) && !et(i2))
        return i2;
      i2 = se(i2);
    }
    return n;
  }
  let r = Lt(e3, t);
  for (; r && mr(r) && et(r); )
    r = Lt(r, t);
  return r && me(r) && et(r) && !pt(r) ? n : r || xr(e3) || n;
}
var Dr = async function(e3) {
  const t = this.getOffsetParent || an, n = this.getDimensions, r = await n(e3.floating);
  return {
    reference: Rr(e3.reference, await t(e3.floating), e3.strategy),
    floating: {
      x: 0,
      y: 0,
      width: r.width,
      height: r.height
    }
  };
};
function $r(e3) {
  return G(e3).direction === "rtl";
}
var Nr = {
  convertOffsetParentRelativeRectToViewportRelativeRect: Cr,
  getDocumentElement: Z,
  getClippingRect: Ir,
  getOffsetParent: an,
  getElementRects: Dr,
  getClientRects: Pr,
  getDimensions: Mr,
  getScale: he,
  isElement: K,
  isRTL: $r
};
function cn(e3, t) {
  return e3.x === t.x && e3.y === t.y && e3.width === t.width && e3.height === t.height;
}
function Fr(e3, t) {
  let n = null, r;
  const i2 = Z(e3);
  function o() {
    var a;
    clearTimeout(r), (a = n) == null || a.disconnect(), n = null;
  }
  function s2(a, c) {
    a === void 0 && (a = false), c === void 0 && (c = 1), o();
    const u = e3.getBoundingClientRect(), {
      left: l,
      top: f,
      width: v,
      height: d
    } = u;
    if (a || t(), !v || !d)
      return;
    const m = _e(f), p = _e(i2.clientWidth - (l + v)), g = _e(i2.clientHeight - (f + d)), h = _e(l), E = {
      rootMargin: -m + "px " + -p + "px " + -g + "px " + -h + "px",
      threshold: ue(0, De(1, c)) || 1
    };
    let O2 = true;
    function b(S) {
      const C = S[0].intersectionRatio;
      if (C !== c) {
        if (!O2)
          return s2();
        C ? s2(false, C) : r = setTimeout(() => {
          s2(false, 1e-7);
        }, 1e3);
      }
      C === 1 && !cn(u, e3.getBoundingClientRect()) && s2(), O2 = false;
    }
    try {
      n = new IntersectionObserver(b, {
        ...E,
        // Handle <iframe>s
        root: i2.ownerDocument
      });
    } catch {
      n = new IntersectionObserver(b, E);
    }
    n.observe(e3);
  }
  return s2(true), o;
}
function Ur(e3, t, n, r) {
  r === void 0 && (r = {});
  const {
    ancestorScroll: i2 = true,
    ancestorResize: o = true,
    elementResize: s2 = typeof ResizeObserver == "function",
    layoutShift: a = typeof IntersectionObserver == "function",
    animationFrame: c = false
  } = r, u = vt(e3), l = i2 || o ? [...u ? Ce(u) : [], ...Ce(t)] : [];
  l.forEach((h) => {
    i2 && h.addEventListener("scroll", n, {
      passive: true
    }), o && h.addEventListener("resize", n);
  });
  const f = u && a ? Fr(u, n) : null;
  let v = -1, d = null;
  s2 && (d = new ResizeObserver((h) => {
    let [x2] = h;
    x2 && x2.target === u && d && (d.unobserve(t), cancelAnimationFrame(v), v = requestAnimationFrame(() => {
      var E;
      (E = d) == null || E.observe(t);
    })), n();
  }), u && !c && d.observe(u), d.observe(t));
  let m, p = c ? fe(e3) : null;
  c && g();
  function g() {
    const h = fe(e3);
    p && !cn(p, h) && n(), p = h, m = requestAnimationFrame(g);
  }
  return n(), () => {
    var h;
    l.forEach((x2) => {
      i2 && x2.removeEventListener("scroll", n), o && x2.removeEventListener("resize", n);
    }), f == null || f(), (h = d) == null || h.disconnect(), d = null, c && cancelAnimationFrame(m);
  };
}
var Wr = dr;
var jr = pr;
var Br = ur;
var Vr = (e3, t, n) => {
  const r = /* @__PURE__ */ new Map(), i2 = {
    platform: Nr,
    ...n
  }, o = {
    ...i2.platform,
    _c: r
  };
  return cr(e3, t, {
    ...i2,
    platform: o
  });
};
var es = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function Hr(e3) {
  return e3 && e3.__esModule && Object.prototype.hasOwnProperty.call(e3, "default") ? e3.default : e3;
}
var Me = { exports: {} };
var zr = Me.exports;
var It;
function Yr() {
  return It || (It = 1, (function(e3) {
    (function(t, n) {
      e3.exports ? e3.exports = n() : t.log = n();
    })(zr, function() {
      var t = function() {
      }, n = "undefined", r = typeof window !== n && typeof window.navigator !== n && /Trident\/|MSIE /.test(window.navigator.userAgent), i2 = [
        "trace",
        "debug",
        "info",
        "warn",
        "error"
      ], o = {}, s2 = null;
      function a(p, g) {
        var h = p[g];
        if (typeof h.bind == "function")
          return h.bind(p);
        try {
          return Function.prototype.bind.call(h, p);
        } catch {
          return function() {
            return Function.prototype.apply.apply(h, [p, arguments]);
          };
        }
      }
      function c() {
        console.log && (console.log.apply ? console.log.apply(console, arguments) : Function.prototype.apply.apply(console.log, [console, arguments])), console.trace && console.trace();
      }
      function u(p) {
        return p === "debug" && (p = "log"), typeof console === n ? false : p === "trace" && r ? c : console[p] !== void 0 ? a(console, p) : console.log !== void 0 ? a(console, "log") : t;
      }
      function l() {
        for (var p = this.getLevel(), g = 0; g < i2.length; g++) {
          var h = i2[g];
          this[h] = g < p ? t : this.methodFactory(h, p, this.name);
        }
        if (this.log = this.debug, typeof console === n && p < this.levels.SILENT)
          return "No console available for logging";
      }
      function f(p) {
        return function() {
          typeof console !== n && (l.call(this), this[p].apply(this, arguments));
        };
      }
      function v(p, g, h) {
        return u(p) || f.apply(this, arguments);
      }
      function d(p, g) {
        var h = this, x2, E, O2, b = "loglevel";
        typeof p == "string" ? b += ":" + p : typeof p == "symbol" && (b = void 0);
        function S(T2) {
          var _2 = (i2[T2] || "silent").toUpperCase();
          if (!(typeof window === n || !b)) {
            try {
              window.localStorage[b] = _2;
              return;
            } catch {
            }
            try {
              window.document.cookie = encodeURIComponent(b) + "=" + _2 + ";";
            } catch {
            }
          }
        }
        function C() {
          var T2;
          if (!(typeof window === n || !b)) {
            try {
              T2 = window.localStorage[b];
            } catch {
            }
            if (typeof T2 === n)
              try {
                var _2 = window.document.cookie, ee3 = encodeURIComponent(b), Q2 = _2.indexOf(ee3 + "=");
                Q2 !== -1 && (T2 = /^([^;]+)/.exec(
                  _2.slice(Q2 + ee3.length + 1)
                )[1]);
              } catch {
              }
            return h.levels[T2] === void 0 && (T2 = void 0), T2;
          }
        }
        function $2() {
          if (!(typeof window === n || !b)) {
            try {
              window.localStorage.removeItem(b);
            } catch {
            }
            try {
              window.document.cookie = encodeURIComponent(b) + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC";
            } catch {
            }
          }
        }
        function M2(T2) {
          var _2 = T2;
          if (typeof _2 == "string" && h.levels[_2.toUpperCase()] !== void 0 && (_2 = h.levels[_2.toUpperCase()]), typeof _2 == "number" && _2 >= 0 && _2 <= h.levels.SILENT)
            return _2;
          throw new TypeError("log.setLevel() called with invalid level: " + T2);
        }
        h.name = p, h.levels = {
          TRACE: 0,
          DEBUG: 1,
          INFO: 2,
          WARN: 3,
          ERROR: 4,
          SILENT: 5
        }, h.methodFactory = g || v, h.getLevel = function() {
          return O2 ?? E ?? x2;
        }, h.setLevel = function(T2, _2) {
          return O2 = M2(T2), _2 !== false && S(O2), l.call(h);
        }, h.setDefaultLevel = function(T2) {
          E = M2(T2), C() || h.setLevel(T2, false);
        }, h.resetLevel = function() {
          O2 = null, $2(), l.call(h);
        }, h.enableAll = function(T2) {
          h.setLevel(h.levels.TRACE, T2);
        }, h.disableAll = function(T2) {
          h.setLevel(h.levels.SILENT, T2);
        }, h.rebuild = function() {
          if (s2 !== h && (x2 = M2(s2.getLevel())), l.call(h), s2 === h)
            for (var T2 in o)
              o[T2].rebuild();
        }, x2 = M2(
          s2 ? s2.getLevel() : "WARN"
        );
        var V2 = C();
        V2 != null && (O2 = M2(V2)), l.call(h);
      }
      s2 = new d(), s2.getLogger = function(g) {
        if (typeof g != "symbol" && typeof g != "string" || g === "")
          throw new TypeError("You must supply a name when creating a logger.");
        var h = o[g];
        return h || (h = o[g] = new d(
          g,
          s2.methodFactory
        )), h;
      };
      var m = typeof window !== n ? window.log : void 0;
      return s2.noConflict = function() {
        return typeof window !== n && window.log === s2 && (window.log = m), s2;
      }, s2.getLoggers = function() {
        return o;
      }, s2.default = s2, s2;
    });
  })(Me)), Me.exports;
}
var qr = Yr();
var Kr = Hr(qr);
var ct = function(e3, t) {
  return ct = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, r) {
    n.__proto__ = r;
  } || function(n, r) {
    for (var i2 in r) Object.prototype.hasOwnProperty.call(r, i2) && (n[i2] = r[i2]);
  }, ct(e3, t);
};
function ne(e3, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Class extends value " + String(t) + " is not a constructor or null");
  ct(e3, t);
  function n() {
    this.constructor = e3;
  }
  e3.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype, new n());
}
function Gr(e3, t, n, r) {
  function i2(o) {
    return o instanceof n ? o : new n(function(s2) {
      s2(o);
    });
  }
  return new (n || (n = Promise))(function(o, s2) {
    function a(l) {
      try {
        u(r.next(l));
      } catch (f) {
        s2(f);
      }
    }
    function c(l) {
      try {
        u(r.throw(l));
      } catch (f) {
        s2(f);
      }
    }
    function u(l) {
      l.done ? o(l.value) : i2(l.value).then(a, c);
    }
    u((r = r.apply(e3, t || [])).next());
  });
}
function un(e3, t) {
  var n = { label: 0, sent: function() {
    if (o[0] & 1) throw o[1];
    return o[1];
  }, trys: [], ops: [] }, r, i2, o, s2 = Object.create((typeof Iterator == "function" ? Iterator : Object).prototype);
  return s2.next = a(0), s2.throw = a(1), s2.return = a(2), typeof Symbol == "function" && (s2[Symbol.iterator] = function() {
    return this;
  }), s2;
  function a(u) {
    return function(l) {
      return c([u, l]);
    };
  }
  function c(u) {
    if (r) throw new TypeError("Generator is already executing.");
    for (; s2 && (s2 = 0, u[0] && (n = 0)), n; ) try {
      if (r = 1, i2 && (o = u[0] & 2 ? i2.return : u[0] ? i2.throw || ((o = i2.return) && o.call(i2), 0) : i2.next) && !(o = o.call(i2, u[1])).done) return o;
      switch (i2 = 0, o && (u = [u[0] & 2, o.value]), u[0]) {
        case 0:
        case 1:
          o = u;
          break;
        case 4:
          return n.label++, { value: u[1], done: false };
        case 5:
          n.label++, i2 = u[1], u = [0];
          continue;
        case 7:
          u = n.ops.pop(), n.trys.pop();
          continue;
        default:
          if (o = n.trys, !(o = o.length > 0 && o[o.length - 1]) && (u[0] === 6 || u[0] === 2)) {
            n = 0;
            continue;
          }
          if (u[0] === 3 && (!o || u[1] > o[0] && u[1] < o[3])) {
            n.label = u[1];
            break;
          }
          if (u[0] === 6 && n.label < o[1]) {
            n.label = o[1], o = u;
            break;
          }
          if (o && n.label < o[2]) {
            n.label = o[2], n.ops.push(u);
            break;
          }
          o[2] && n.ops.pop(), n.trys.pop();
          continue;
      }
      u = t.call(e3, n);
    } catch (l) {
      u = [6, l], i2 = 0;
    } finally {
      r = o = 0;
    }
    if (u[0] & 5) throw u[1];
    return { value: u[0] ? u[1] : void 0, done: true };
  }
}
function ge(e3) {
  var t = typeof Symbol == "function" && Symbol.iterator, n = t && e3[t], r = 0;
  if (n) return n.call(e3);
  if (e3 && typeof e3.length == "number") return {
    next: function() {
      return e3 && r >= e3.length && (e3 = void 0), { value: e3 && e3[r++], done: !e3 };
    }
  };
  throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function de(e3, t) {
  var n = typeof Symbol == "function" && e3[Symbol.iterator];
  if (!n) return e3;
  var r = n.call(e3), i2, o = [], s2;
  try {
    for (; (t === void 0 || t-- > 0) && !(i2 = r.next()).done; ) o.push(i2.value);
  } catch (a) {
    s2 = { error: a };
  } finally {
    try {
      i2 && !i2.done && (n = r.return) && n.call(r);
    } finally {
      if (s2) throw s2.error;
    }
  }
  return o;
}
function be(e3, t, n) {
  if (n || arguments.length === 2) for (var r = 0, i2 = t.length, o; r < i2; r++)
    (o || !(r in t)) && (o || (o = Array.prototype.slice.call(t, 0, r)), o[r] = t[r]);
  return e3.concat(o || Array.prototype.slice.call(t));
}
function ve(e3) {
  return this instanceof ve ? (this.v = e3, this) : new ve(e3);
}
function Qr(e3, t, n) {
  if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
  var r = n.apply(e3, t || []), i2, o = [];
  return i2 = Object.create((typeof AsyncIterator == "function" ? AsyncIterator : Object).prototype), a("next"), a("throw"), a("return", s2), i2[Symbol.asyncIterator] = function() {
    return this;
  }, i2;
  function s2(d) {
    return function(m) {
      return Promise.resolve(m).then(d, f);
    };
  }
  function a(d, m) {
    r[d] && (i2[d] = function(p) {
      return new Promise(function(g, h) {
        o.push([d, p, g, h]) > 1 || c(d, p);
      });
    }, m && (i2[d] = m(i2[d])));
  }
  function c(d, m) {
    try {
      u(r[d](m));
    } catch (p) {
      v(o[0][3], p);
    }
  }
  function u(d) {
    d.value instanceof ve ? Promise.resolve(d.value.v).then(l, f) : v(o[0][2], d);
  }
  function l(d) {
    c("next", d);
  }
  function f(d) {
    c("throw", d);
  }
  function v(d, m) {
    d(m), o.shift(), o.length && c(o[0][0], o[0][1]);
  }
}
function Jr(e3) {
  if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
  var t = e3[Symbol.asyncIterator], n;
  return t ? t.call(e3) : (e3 = typeof ge == "function" ? ge(e3) : e3[Symbol.iterator](), n = {}, r("next"), r("throw"), r("return"), n[Symbol.asyncIterator] = function() {
    return this;
  }, n);
  function r(o) {
    n[o] = e3[o] && function(s2) {
      return new Promise(function(a, c) {
        s2 = e3[o](s2), i2(a, c, s2.done, s2.value);
      });
    };
  }
  function i2(o, s2, a, c) {
    Promise.resolve(c).then(function(u) {
      o({ value: u, done: a });
    }, s2);
  }
}
function P(e3) {
  return typeof e3 == "function";
}
function mt(e3) {
  var t = function(r) {
    Error.call(r), r.stack = new Error().stack;
  }, n = e3(t);
  return n.prototype = Object.create(Error.prototype), n.prototype.constructor = n, n;
}
var tt = mt(function(e3) {
  return function(n) {
    e3(this), this.message = n ? n.length + ` errors occurred during unsubscription:
` + n.map(function(r, i2) {
      return i2 + 1 + ") " + r.toString();
    }).join(`
  `) : "", this.name = "UnsubscriptionError", this.errors = n;
  };
});
function Ue(e3, t) {
  if (e3) {
    var n = e3.indexOf(t);
    0 <= n && e3.splice(n, 1);
  }
}
var ke = (function() {
  function e3(t) {
    this.initialTeardown = t, this.closed = false, this._parentage = null, this._finalizers = null;
  }
  return e3.prototype.unsubscribe = function() {
    var t, n, r, i2, o;
    if (!this.closed) {
      this.closed = true;
      var s2 = this._parentage;
      if (s2)
        if (this._parentage = null, Array.isArray(s2))
          try {
            for (var a = ge(s2), c = a.next(); !c.done; c = a.next()) {
              var u = c.value;
              u.remove(this);
            }
          } catch (p) {
            t = { error: p };
          } finally {
            try {
              c && !c.done && (n = a.return) && n.call(a);
            } finally {
              if (t) throw t.error;
            }
          }
        else
          s2.remove(this);
      var l = this.initialTeardown;
      if (P(l))
        try {
          l();
        } catch (p) {
          o = p instanceof tt ? p.errors : [p];
        }
      var f = this._finalizers;
      if (f) {
        this._finalizers = null;
        try {
          for (var v = ge(f), d = v.next(); !d.done; d = v.next()) {
            var m = d.value;
            try {
              Mt(m);
            } catch (p) {
              o = o ?? [], p instanceof tt ? o = be(be([], de(o)), de(p.errors)) : o.push(p);
            }
          }
        } catch (p) {
          r = { error: p };
        } finally {
          try {
            d && !d.done && (i2 = v.return) && i2.call(v);
          } finally {
            if (r) throw r.error;
          }
        }
      }
      if (o)
        throw new tt(o);
    }
  }, e3.prototype.add = function(t) {
    var n;
    if (t && t !== this)
      if (this.closed)
        Mt(t);
      else {
        if (t instanceof e3) {
          if (t.closed || t._hasParent(this))
            return;
          t._addParent(this);
        }
        (this._finalizers = (n = this._finalizers) !== null && n !== void 0 ? n : []).push(t);
      }
  }, e3.prototype._hasParent = function(t) {
    var n = this._parentage;
    return n === t || Array.isArray(n) && n.includes(t);
  }, e3.prototype._addParent = function(t) {
    var n = this._parentage;
    this._parentage = Array.isArray(n) ? (n.push(t), n) : n ? [n, t] : t;
  }, e3.prototype._removeParent = function(t) {
    var n = this._parentage;
    n === t ? this._parentage = null : Array.isArray(n) && Ue(n, t);
  }, e3.prototype.remove = function(t) {
    var n = this._finalizers;
    n && Ue(n, t), t instanceof e3 && t._removeParent(this);
  }, e3.EMPTY = (function() {
    var t = new e3();
    return t.closed = true, t;
  })(), e3;
})();
var ln = ke.EMPTY;
function fn(e3) {
  return e3 instanceof ke || e3 && "closed" in e3 && P(e3.remove) && P(e3.add) && P(e3.unsubscribe);
}
function Mt(e3) {
  P(e3) ? e3() : e3.unsubscribe();
}
var Xr = {
  Promise: void 0
};
var Zr = {
  setTimeout: function(e3, t) {
    for (var n = [], r = 2; r < arguments.length; r++)
      n[r - 2] = arguments[r];
    return setTimeout.apply(void 0, be([e3, t], de(n)));
  },
  clearTimeout: function(e3) {
    return clearTimeout(e3);
  },
  delegate: void 0
};
function dn(e3) {
  Zr.setTimeout(function() {
    throw e3;
  });
}
function We() {
}
function Re(e3) {
  e3();
}
var gt = (function(e3) {
  ne(t, e3);
  function t(n) {
    var r = e3.call(this) || this;
    return r.isStopped = false, n ? (r.destination = n, fn(n) && n.add(r)) : r.destination = ni, r;
  }
  return t.create = function(n, r, i2) {
    return new Pe(n, r, i2);
  }, t.prototype.next = function(n) {
    this.isStopped || this._next(n);
  }, t.prototype.error = function(n) {
    this.isStopped || (this.isStopped = true, this._error(n));
  }, t.prototype.complete = function() {
    this.isStopped || (this.isStopped = true, this._complete());
  }, t.prototype.unsubscribe = function() {
    this.closed || (this.isStopped = true, e3.prototype.unsubscribe.call(this), this.destination = null);
  }, t.prototype._next = function(n) {
    this.destination.next(n);
  }, t.prototype._error = function(n) {
    try {
      this.destination.error(n);
    } finally {
      this.unsubscribe();
    }
  }, t.prototype._complete = function() {
    try {
      this.destination.complete();
    } finally {
      this.unsubscribe();
    }
  }, t;
})(ke);
var ei = (function() {
  function e3(t) {
    this.partialObserver = t;
  }
  return e3.prototype.next = function(t) {
    var n = this.partialObserver;
    if (n.next)
      try {
        n.next(t);
      } catch (r) {
        Le(r);
      }
  }, e3.prototype.error = function(t) {
    var n = this.partialObserver;
    if (n.error)
      try {
        n.error(t);
      } catch (r) {
        Le(r);
      }
    else
      Le(t);
  }, e3.prototype.complete = function() {
    var t = this.partialObserver;
    if (t.complete)
      try {
        t.complete();
      } catch (n) {
        Le(n);
      }
  }, e3;
})();
var Pe = (function(e3) {
  ne(t, e3);
  function t(n, r, i2) {
    var o = e3.call(this) || this, s2;
    return P(n) || !n ? s2 = {
      next: n ?? void 0,
      error: r ?? void 0,
      complete: i2 ?? void 0
    } : s2 = n, o.destination = new ei(s2), o;
  }
  return t;
})(gt);
function Le(e3) {
  dn(e3);
}
function ti(e3) {
  throw e3;
}
var ni = {
  closed: true,
  next: We,
  error: ti,
  complete: We
};
var bt = (function() {
  return typeof Symbol == "function" && Symbol.observable || "@@observable";
})();
function Qe(e3) {
  return e3;
}
function ri(e3) {
  return e3.length === 0 ? Qe : e3.length === 1 ? e3[0] : function(n) {
    return e3.reduce(function(r, i2) {
      return i2(r);
    }, n);
  };
}
var k = (function() {
  function e3(t) {
    t && (this._subscribe = t);
  }
  return e3.prototype.lift = function(t) {
    var n = new e3();
    return n.source = this, n.operator = t, n;
  }, e3.prototype.subscribe = function(t, n, r) {
    var i2 = this, o = oi(t) ? t : new Pe(t, n, r);
    return Re(function() {
      var s2 = i2, a = s2.operator, c = s2.source;
      o.add(a ? a.call(o, c) : c ? i2._subscribe(o) : i2._trySubscribe(o));
    }), o;
  }, e3.prototype._trySubscribe = function(t) {
    try {
      return this._subscribe(t);
    } catch (n) {
      t.error(n);
    }
  }, e3.prototype.forEach = function(t, n) {
    var r = this;
    return n = Rt(n), new n(function(i2, o) {
      var s2 = new Pe({
        next: function(a) {
          try {
            t(a);
          } catch (c) {
            o(c), s2.unsubscribe();
          }
        },
        error: o,
        complete: i2
      });
      r.subscribe(s2);
    });
  }, e3.prototype._subscribe = function(t) {
    var n;
    return (n = this.source) === null || n === void 0 ? void 0 : n.subscribe(t);
  }, e3.prototype[bt] = function() {
    return this;
  }, e3.prototype.pipe = function() {
    for (var t = [], n = 0; n < arguments.length; n++)
      t[n] = arguments[n];
    return ri(t)(this);
  }, e3.prototype.toPromise = function(t) {
    var n = this;
    return t = Rt(t), new t(function(r, i2) {
      var o;
      n.subscribe(function(s2) {
        return o = s2;
      }, function(s2) {
        return i2(s2);
      }, function() {
        return r(o);
      });
    });
  }, e3.create = function(t) {
    return new e3(t);
  }, e3;
})();
function Rt(e3) {
  var t;
  return (t = e3 ?? Xr.Promise) !== null && t !== void 0 ? t : Promise;
}
function ii(e3) {
  return e3 && P(e3.next) && P(e3.error) && P(e3.complete);
}
function oi(e3) {
  return e3 && e3 instanceof gt || ii(e3) && fn(e3);
}
function si(e3) {
  return P(e3 == null ? void 0 : e3.lift);
}
function W(e3) {
  return function(t) {
    if (si(t))
      return t.lift(function(n) {
        try {
          return e3(n, this);
        } catch (r) {
          this.error(r);
        }
      });
    throw new TypeError("Unable to lift unknown Observable type");
  };
}
function F(e3, t, n, r, i2) {
  return new ai(e3, t, n, r, i2);
}
var ai = (function(e3) {
  ne(t, e3);
  function t(n, r, i2, o, s2, a) {
    var c = e3.call(this, n) || this;
    return c.onFinalize = s2, c.shouldUnsubscribe = a, c._next = r ? function(u) {
      try {
        r(u);
      } catch (l) {
        n.error(l);
      }
    } : e3.prototype._next, c._error = o ? function(u) {
      try {
        o(u);
      } catch (l) {
        n.error(l);
      } finally {
        this.unsubscribe();
      }
    } : e3.prototype._error, c._complete = i2 ? function() {
      try {
        i2();
      } catch (u) {
        n.error(u);
      } finally {
        this.unsubscribe();
      }
    } : e3.prototype._complete, c;
  }
  return t.prototype.unsubscribe = function() {
    var n;
    if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {
      var r = this.closed;
      e3.prototype.unsubscribe.call(this), !r && ((n = this.onFinalize) === null || n === void 0 || n.call(this));
    }
  }, t;
})(gt);
var ci = mt(function(e3) {
  return function() {
    e3(this), this.name = "ObjectUnsubscribedError", this.message = "object unsubscribed";
  };
});
var te = (function(e3) {
  ne(t, e3);
  function t() {
    var n = e3.call(this) || this;
    return n.closed = false, n.currentObservers = null, n.observers = [], n.isStopped = false, n.hasError = false, n.thrownError = null, n;
  }
  return t.prototype.lift = function(n) {
    var r = new Dt(this, this);
    return r.operator = n, r;
  }, t.prototype._throwIfClosed = function() {
    if (this.closed)
      throw new ci();
  }, t.prototype.next = function(n) {
    var r = this;
    Re(function() {
      var i2, o;
      if (r._throwIfClosed(), !r.isStopped) {
        r.currentObservers || (r.currentObservers = Array.from(r.observers));
        try {
          for (var s2 = ge(r.currentObservers), a = s2.next(); !a.done; a = s2.next()) {
            var c = a.value;
            c.next(n);
          }
        } catch (u) {
          i2 = { error: u };
        } finally {
          try {
            a && !a.done && (o = s2.return) && o.call(s2);
          } finally {
            if (i2) throw i2.error;
          }
        }
      }
    });
  }, t.prototype.error = function(n) {
    var r = this;
    Re(function() {
      if (r._throwIfClosed(), !r.isStopped) {
        r.hasError = r.isStopped = true, r.thrownError = n;
        for (var i2 = r.observers; i2.length; )
          i2.shift().error(n);
      }
    });
  }, t.prototype.complete = function() {
    var n = this;
    Re(function() {
      if (n._throwIfClosed(), !n.isStopped) {
        n.isStopped = true;
        for (var r = n.observers; r.length; )
          r.shift().complete();
      }
    });
  }, t.prototype.unsubscribe = function() {
    this.isStopped = this.closed = true, this.observers = this.currentObservers = null;
  }, Object.defineProperty(t.prototype, "observed", {
    get: function() {
      var n;
      return ((n = this.observers) === null || n === void 0 ? void 0 : n.length) > 0;
    },
    enumerable: false,
    configurable: true
  }), t.prototype._trySubscribe = function(n) {
    return this._throwIfClosed(), e3.prototype._trySubscribe.call(this, n);
  }, t.prototype._subscribe = function(n) {
    return this._throwIfClosed(), this._checkFinalizedStatuses(n), this._innerSubscribe(n);
  }, t.prototype._innerSubscribe = function(n) {
    var r = this, i2 = this, o = i2.hasError, s2 = i2.isStopped, a = i2.observers;
    return o || s2 ? ln : (this.currentObservers = null, a.push(n), new ke(function() {
      r.currentObservers = null, Ue(a, n);
    }));
  }, t.prototype._checkFinalizedStatuses = function(n) {
    var r = this, i2 = r.hasError, o = r.thrownError, s2 = r.isStopped;
    i2 ? n.error(o) : s2 && n.complete();
  }, t.prototype.asObservable = function() {
    var n = new k();
    return n.source = this, n;
  }, t.create = function(n, r) {
    return new Dt(n, r);
  }, t;
})(k);
var Dt = (function(e3) {
  ne(t, e3);
  function t(n, r) {
    var i2 = e3.call(this) || this;
    return i2.destination = n, i2.source = r, i2;
  }
  return t.prototype.next = function(n) {
    var r, i2;
    (i2 = (r = this.destination) === null || r === void 0 ? void 0 : r.next) === null || i2 === void 0 || i2.call(r, n);
  }, t.prototype.error = function(n) {
    var r, i2;
    (i2 = (r = this.destination) === null || r === void 0 ? void 0 : r.error) === null || i2 === void 0 || i2.call(r, n);
  }, t.prototype.complete = function() {
    var n, r;
    (r = (n = this.destination) === null || n === void 0 ? void 0 : n.complete) === null || r === void 0 || r.call(n);
  }, t.prototype._subscribe = function(n) {
    var r, i2;
    return (i2 = (r = this.source) === null || r === void 0 ? void 0 : r.subscribe(n)) !== null && i2 !== void 0 ? i2 : ln;
  }, t;
})(te);
var pn = (function(e3) {
  ne(t, e3);
  function t(n) {
    var r = e3.call(this) || this;
    return r._value = n, r;
  }
  return Object.defineProperty(t.prototype, "value", {
    get: function() {
      return this.getValue();
    },
    enumerable: false,
    configurable: true
  }), t.prototype._subscribe = function(n) {
    var r = e3.prototype._subscribe.call(this, n);
    return !r.closed && n.next(this._value), r;
  }, t.prototype.getValue = function() {
    var n = this, r = n.hasError, i2 = n.thrownError, o = n._value;
    if (r)
      throw i2;
    return this._throwIfClosed(), o;
  }, t.prototype.next = function(n) {
    e3.prototype.next.call(this, this._value = n);
  }, t;
})(te);
var ui = {
  now: function() {
    return Date.now();
  }
};
var li = (function(e3) {
  ne(t, e3);
  function t(n, r) {
    return e3.call(this) || this;
  }
  return t.prototype.schedule = function(n, r) {
    return this;
  }, t;
})(ke);
var $t = {
  setInterval: function(e3, t) {
    for (var n = [], r = 2; r < arguments.length; r++)
      n[r - 2] = arguments[r];
    return setInterval.apply(void 0, be([e3, t], de(n)));
  },
  clearInterval: function(e3) {
    return clearInterval(e3);
  },
  delegate: void 0
};
var fi = (function(e3) {
  ne(t, e3);
  function t(n, r) {
    var i2 = e3.call(this, n, r) || this;
    return i2.scheduler = n, i2.work = r, i2.pending = false, i2;
  }
  return t.prototype.schedule = function(n, r) {
    var i2;
    if (r === void 0 && (r = 0), this.closed)
      return this;
    this.state = n;
    var o = this.id, s2 = this.scheduler;
    return o != null && (this.id = this.recycleAsyncId(s2, o, r)), this.pending = true, this.delay = r, this.id = (i2 = this.id) !== null && i2 !== void 0 ? i2 : this.requestAsyncId(s2, this.id, r), this;
  }, t.prototype.requestAsyncId = function(n, r, i2) {
    return i2 === void 0 && (i2 = 0), $t.setInterval(n.flush.bind(n, this), i2);
  }, t.prototype.recycleAsyncId = function(n, r, i2) {
    if (i2 === void 0 && (i2 = 0), i2 != null && this.delay === i2 && this.pending === false)
      return r;
    r != null && $t.clearInterval(r);
  }, t.prototype.execute = function(n, r) {
    if (this.closed)
      return new Error("executing a cancelled action");
    this.pending = false;
    var i2 = this._execute(n, r);
    if (i2)
      return i2;
    this.pending === false && this.id != null && (this.id = this.recycleAsyncId(this.scheduler, this.id, null));
  }, t.prototype._execute = function(n, r) {
    var i2 = false, o;
    try {
      this.work(n);
    } catch (s2) {
      i2 = true, o = s2 || new Error("Scheduled action threw falsy error");
    }
    if (i2)
      return this.unsubscribe(), o;
  }, t.prototype.unsubscribe = function() {
    if (!this.closed) {
      var n = this, r = n.id, i2 = n.scheduler, o = i2.actions;
      this.work = this.state = this.scheduler = null, this.pending = false, Ue(o, this), r != null && (this.id = this.recycleAsyncId(i2, r, null)), this.delay = null, e3.prototype.unsubscribe.call(this);
    }
  }, t;
})(li);
var Nt = (function() {
  function e3(t, n) {
    n === void 0 && (n = e3.now), this.schedulerActionCtor = t, this.now = n;
  }
  return e3.prototype.schedule = function(t, n, r) {
    return n === void 0 && (n = 0), new this.schedulerActionCtor(this, t).schedule(r, n);
  }, e3.now = ui.now, e3;
})();
var di = (function(e3) {
  ne(t, e3);
  function t(n, r) {
    r === void 0 && (r = Nt.now);
    var i2 = e3.call(this, n, r) || this;
    return i2.actions = [], i2._active = false, i2;
  }
  return t.prototype.flush = function(n) {
    var r = this.actions;
    if (this._active) {
      r.push(n);
      return;
    }
    var i2;
    this._active = true;
    do
      if (i2 = n.execute(n.state, n.delay))
        break;
    while (n = r.shift());
    if (this._active = false, i2) {
      for (; n = r.shift(); )
        n.unsubscribe();
      throw i2;
    }
  }, t;
})(Nt);
var pi = new di(fi);
function hi(e3) {
  return e3 && P(e3.schedule);
}
function vi(e3) {
  return e3[e3.length - 1];
}
function yt(e3) {
  return hi(vi(e3)) ? e3.pop() : void 0;
}
var wt = (function(e3) {
  return e3 && typeof e3.length == "number" && typeof e3 != "function";
});
function hn(e3) {
  return P(e3 == null ? void 0 : e3.then);
}
function vn(e3) {
  return P(e3[bt]);
}
function mn(e3) {
  return Symbol.asyncIterator && P(e3 == null ? void 0 : e3[Symbol.asyncIterator]);
}
function gn(e3) {
  return new TypeError("You provided " + (e3 !== null && typeof e3 == "object" ? "an invalid object" : "'" + e3 + "'") + " where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.");
}
function mi() {
  return typeof Symbol != "function" || !Symbol.iterator ? "@@iterator" : Symbol.iterator;
}
var bn = mi();
function yn(e3) {
  return P(e3 == null ? void 0 : e3[bn]);
}
function wn(e3) {
  return Qr(this, arguments, function() {
    var n, r, i2, o;
    return un(this, function(s2) {
      switch (s2.label) {
        case 0:
          n = e3.getReader(), s2.label = 1;
        case 1:
          s2.trys.push([1, , 9, 10]), s2.label = 2;
        case 2:
          return [4, ve(n.read())];
        case 3:
          return r = s2.sent(), i2 = r.value, o = r.done, o ? [4, ve(void 0)] : [3, 5];
        case 4:
          return [2, s2.sent()];
        case 5:
          return [4, ve(i2)];
        case 6:
          return [4, s2.sent()];
        case 7:
          return s2.sent(), [3, 2];
        case 8:
          return [3, 10];
        case 9:
          return n.releaseLock(), [7];
        case 10:
          return [2];
      }
    });
  });
}
function xn(e3) {
  return P(e3 == null ? void 0 : e3.getReader);
}
function z(e3) {
  if (e3 instanceof k)
    return e3;
  if (e3 != null) {
    if (vn(e3))
      return gi(e3);
    if (wt(e3))
      return bi(e3);
    if (hn(e3))
      return yi(e3);
    if (mn(e3))
      return Sn(e3);
    if (yn(e3))
      return wi(e3);
    if (xn(e3))
      return xi(e3);
  }
  throw gn(e3);
}
function gi(e3) {
  return new k(function(t) {
    var n = e3[bt]();
    if (P(n.subscribe))
      return n.subscribe(t);
    throw new TypeError("Provided object does not correctly implement Symbol.observable");
  });
}
function bi(e3) {
  return new k(function(t) {
    for (var n = 0; n < e3.length && !t.closed; n++)
      t.next(e3[n]);
    t.complete();
  });
}
function yi(e3) {
  return new k(function(t) {
    e3.then(function(n) {
      t.closed || (t.next(n), t.complete());
    }, function(n) {
      return t.error(n);
    }).then(null, dn);
  });
}
function wi(e3) {
  return new k(function(t) {
    var n, r;
    try {
      for (var i2 = ge(e3), o = i2.next(); !o.done; o = i2.next()) {
        var s2 = o.value;
        if (t.next(s2), t.closed)
          return;
      }
    } catch (a) {
      n = { error: a };
    } finally {
      try {
        o && !o.done && (r = i2.return) && r.call(i2);
      } finally {
        if (n) throw n.error;
      }
    }
    t.complete();
  });
}
function Sn(e3) {
  return new k(function(t) {
    Si(e3, t).catch(function(n) {
      return t.error(n);
    });
  });
}
function xi(e3) {
  return Sn(wn(e3));
}
function Si(e3, t) {
  var n, r, i2, o;
  return Gr(this, void 0, void 0, function() {
    var s2, a;
    return un(this, function(c) {
      switch (c.label) {
        case 0:
          c.trys.push([0, 5, 6, 11]), n = Jr(e3), c.label = 1;
        case 1:
          return [4, n.next()];
        case 2:
          if (r = c.sent(), !!r.done) return [3, 4];
          if (s2 = r.value, t.next(s2), t.closed)
            return [2];
          c.label = 3;
        case 3:
          return [3, 1];
        case 4:
          return [3, 11];
        case 5:
          return a = c.sent(), i2 = { error: a }, [3, 11];
        case 6:
          return c.trys.push([6, , 9, 10]), r && !r.done && (o = n.return) ? [4, o.call(n)] : [3, 8];
        case 7:
          c.sent(), c.label = 8;
        case 8:
          return [3, 10];
        case 9:
          if (i2) throw i2.error;
          return [7];
        case 10:
          return [7];
        case 11:
          return t.complete(), [2];
      }
    });
  });
}
function oe(e3, t, n, r, i2) {
  r === void 0 && (r = 0), i2 === void 0 && (i2 = false);
  var o = t.schedule(function() {
    n(), i2 ? e3.add(this.schedule(null, r)) : this.unsubscribe();
  }, r);
  if (e3.add(o), !i2)
    return o;
}
function Tn(e3, t) {
  return t === void 0 && (t = 0), W(function(n, r) {
    n.subscribe(F(r, function(i2) {
      return oe(r, e3, function() {
        return r.next(i2);
      }, t);
    }, function() {
      return oe(r, e3, function() {
        return r.complete();
      }, t);
    }, function(i2) {
      return oe(r, e3, function() {
        return r.error(i2);
      }, t);
    }));
  });
}
function En(e3, t) {
  return t === void 0 && (t = 0), W(function(n, r) {
    r.add(e3.schedule(function() {
      return n.subscribe(r);
    }, t));
  });
}
function Ti(e3, t) {
  return z(e3).pipe(En(t), Tn(t));
}
function Ei(e3, t) {
  return z(e3).pipe(En(t), Tn(t));
}
function Ci(e3, t) {
  return new k(function(n) {
    var r = 0;
    return t.schedule(function() {
      r === e3.length ? n.complete() : (n.next(e3[r++]), n.closed || this.schedule());
    });
  });
}
function Pi(e3, t) {
  return new k(function(n) {
    var r;
    return oe(n, t, function() {
      r = e3[bn](), oe(n, t, function() {
        var i2, o, s2;
        try {
          i2 = r.next(), o = i2.value, s2 = i2.done;
        } catch (a) {
          n.error(a);
          return;
        }
        s2 ? n.complete() : n.next(o);
      }, 0, true);
    }), function() {
      return P(r == null ? void 0 : r.return) && r.return();
    };
  });
}
function Cn(e3, t) {
  if (!e3)
    throw new Error("Iterable cannot be null");
  return new k(function(n) {
    oe(n, t, function() {
      var r = e3[Symbol.asyncIterator]();
      oe(n, t, function() {
        r.next().then(function(i2) {
          i2.done ? n.complete() : n.next(i2.value);
        });
      }, 0, true);
    });
  });
}
function Oi(e3, t) {
  return Cn(wn(e3), t);
}
function Ai(e3, t) {
  if (e3 != null) {
    if (vn(e3))
      return Ti(e3, t);
    if (wt(e3))
      return Ci(e3, t);
    if (hn(e3))
      return Ei(e3, t);
    if (mn(e3))
      return Cn(e3, t);
    if (yn(e3))
      return Pi(e3, t);
    if (xn(e3))
      return Oi(e3, t);
  }
  throw gn(e3);
}
function Je(e3, t) {
  return t ? Ai(e3, t) : z(e3);
}
function Ft() {
  for (var e3 = [], t = 0; t < arguments.length; t++)
    e3[t] = arguments[t];
  var n = yt(e3);
  return Je(e3, n);
}
function ki(e3) {
  return e3 instanceof Date && !isNaN(e3);
}
var _i = mt(function(e3) {
  return function(n) {
    n === void 0 && (n = null), e3(this), this.message = "Timeout has occurred", this.name = "TimeoutError", this.info = n;
  };
});
function Li(e3, t) {
  var n = ki(e3) ? { first: e3 } : typeof e3 == "number" ? { each: e3 } : e3, r = n.first, i2 = n.each, o = n.with, s2 = o === void 0 ? Ii : o, a = n.scheduler, c = a === void 0 ? pi : a, u = n.meta, l = u === void 0 ? null : u;
  if (r == null && i2 == null)
    throw new TypeError("No timeout provided.");
  return W(function(f, v) {
    var d, m, p = null, g = 0, h = function(x2) {
      m = oe(v, c, function() {
        try {
          d.unsubscribe(), z(s2({
            meta: l,
            lastValue: p,
            seen: g
          })).subscribe(v);
        } catch (E) {
          v.error(E);
        }
      }, x2);
    };
    d = f.subscribe(F(v, function(x2) {
      m == null || m.unsubscribe(), g++, v.next(p = x2), i2 > 0 && h(i2);
    }, void 0, void 0, function() {
      m != null && m.closed || m == null || m.unsubscribe(), p = null;
    })), !g && h(r != null ? typeof r == "number" ? r : +r - c.now() : i2);
  });
}
function Ii(e3) {
  throw new _i(e3);
}
function A(e3, t) {
  return W(function(n, r) {
    var i2 = 0;
    n.subscribe(F(r, function(o) {
      r.next(e3.call(t, o, i2++));
    }));
  });
}
var Mi = Array.isArray;
function Ri(e3, t) {
  return Mi(t) ? e3.apply(void 0, be([], de(t))) : e3(t);
}
function Di(e3) {
  return A(function(t) {
    return Ri(e3, t);
  });
}
function $i(e3, t, n, r, i2, o, s2, a) {
  var c = [], u = 0, l = 0, f = false, v = function() {
    f && !c.length && !u && t.complete();
  }, d = function(p) {
    return u < r ? m(p) : c.push(p);
  }, m = function(p) {
    u++;
    var g = false;
    z(n(p, l++)).subscribe(F(t, function(h) {
      t.next(h);
    }, function() {
      g = true;
    }, void 0, function() {
      if (g)
        try {
          u--;
          for (var h = function() {
            var x2 = c.shift();
            s2 || m(x2);
          }; c.length && u < r; )
            h();
          v();
        } catch (x2) {
          t.error(x2);
        }
    }));
  };
  return e3.subscribe(F(t, d, function() {
    f = true, v();
  })), function() {
  };
}
function xt(e3, t, n) {
  return n === void 0 && (n = 1 / 0), P(t) ? xt(function(r, i2) {
    return A(function(o, s2) {
      return t(r, o, i2, s2);
    })(z(e3(r, i2)));
  }, n) : (typeof t == "number" && (n = t), W(function(r, i2) {
    return $i(r, i2, e3, n);
  }));
}
function Ni(e3) {
  return xt(Qe, e3);
}
function Fi() {
  return Ni(1);
}
function je() {
  for (var e3 = [], t = 0; t < arguments.length; t++)
    e3[t] = arguments[t];
  return Fi()(Je(e3, yt(e3)));
}
var Ui = ["addListener", "removeListener"];
var Wi = ["addEventListener", "removeEventListener"];
var ji = ["on", "off"];
function ut(e3, t, n, r) {
  if (P(n) && (r = n, n = void 0), r)
    return ut(e3, t, n).pipe(Di(r));
  var i2 = de(Hi(e3) ? Wi.map(function(a) {
    return function(c) {
      return e3[a](t, c, n);
    };
  }) : Bi(e3) ? Ui.map(Ut(e3, t)) : Vi(e3) ? ji.map(Ut(e3, t)) : [], 2), o = i2[0], s2 = i2[1];
  if (!o && wt(e3))
    return xt(function(a) {
      return ut(a, t, n);
    })(z(e3));
  if (!o)
    throw new TypeError("Invalid event target");
  return new k(function(a) {
    var c = function() {
      for (var u = [], l = 0; l < arguments.length; l++)
        u[l] = arguments[l];
      return a.next(1 < u.length ? u : u[0]);
    };
    return o(c), function() {
      return s2(c);
    };
  });
}
function Ut(e3, t) {
  return function(n) {
    return function(r) {
      return e3[n](t, r);
    };
  };
}
function Bi(e3) {
  return P(e3.addListener) && P(e3.removeListener);
}
function Vi(e3) {
  return P(e3.on) && P(e3.off);
}
function Hi(e3) {
  return P(e3.addEventListener) && P(e3.removeEventListener);
}
function Xe(e3, t) {
  return W(function(n, r) {
    var i2 = 0;
    n.subscribe(F(r, function(o) {
      return e3.call(t, o, i2++) && r.next(o);
    }));
  });
}
function zi(e3, t, n, r, i2) {
  return function(o, s2) {
    var a = n, c = t, u = 0;
    o.subscribe(F(s2, function(l) {
      var f = u++;
      c = a ? e3(c, l, f) : (a = true, l), s2.next(c);
    }, i2));
  };
}
function Yi(e3, t) {
  return t === void 0 && (t = Qe), e3 = e3 ?? qi, W(function(n, r) {
    var i2, o = true;
    n.subscribe(F(r, function(s2) {
      var a = t(s2);
      (o || !e3(i2, a)) && (o = false, i2 = a, r.next(s2));
    }));
  });
}
function qi(e3, t) {
  return e3 === t;
}
function lt(e3, t) {
  return W(zi(e3, t, arguments.length >= 2, true));
}
function Ki(e3) {
  e3 === void 0 && (e3 = {});
  var t = e3.connector, n = t === void 0 ? function() {
    return new te();
  } : t, r = e3.resetOnError, i2 = r === void 0 ? true : r, o = e3.resetOnComplete, s2 = o === void 0 ? true : o, a = e3.resetOnRefCountZero, c = a === void 0 ? true : a;
  return function(u) {
    var l, f, v, d = 0, m = false, p = false, g = function() {
      f == null || f.unsubscribe(), f = void 0;
    }, h = function() {
      g(), l = v = void 0, m = p = false;
    }, x2 = function() {
      var E = l;
      h(), E == null || E.unsubscribe();
    };
    return W(function(E, O2) {
      d++, !p && !m && g();
      var b = v = v ?? n();
      O2.add(function() {
        d--, d === 0 && !p && !m && (f = nt(x2, c));
      }), b.subscribe(O2), !l && d > 0 && (l = new Pe({
        next: function(S) {
          return b.next(S);
        },
        error: function(S) {
          p = true, g(), f = nt(h, i2, S), b.error(S);
        },
        complete: function() {
          m = true, g(), f = nt(h, s2), b.complete();
        }
      }), z(E).subscribe(l));
    })(u);
  };
}
function nt(e3, t) {
  for (var n = [], r = 2; r < arguments.length; r++)
    n[r - 2] = arguments[r];
  if (t === true) {
    e3();
    return;
  }
  if (t !== false) {
    var i2 = new Pe({
      next: function() {
        i2.unsubscribe(), e3();
      }
    });
    return z(t.apply(void 0, be([], de(n)))).subscribe(i2);
  }
}
function Gi(e3) {
  return W(function(t, n) {
    var r = false, i2 = F(n, function() {
      i2 == null || i2.unsubscribe(), r = true;
    }, We);
    z(e3).subscribe(i2), t.subscribe(F(n, function(o) {
      return r && n.next(o);
    }));
  });
}
function D() {
  for (var e3 = [], t = 0; t < arguments.length; t++)
    e3[t] = arguments[t];
  var n = yt(e3);
  return W(function(r, i2) {
    (n ? je(e3, r, n) : je(e3, r)).subscribe(i2);
  });
}
function Pn(e3, t) {
  return W(function(n, r) {
    var i2 = null, o = 0, s2 = false, a = function() {
      return s2 && !i2 && r.complete();
    };
    n.subscribe(F(r, function(c) {
      i2 == null || i2.unsubscribe();
      var u = 0, l = o++;
      z(e3(c, l)).subscribe(i2 = F(r, function(f) {
        return r.next(t ? t(c, f, l, u++) : f);
      }, function() {
        i2 = null, a();
      }));
    }, function() {
      s2 = true, a();
    }));
  });
}
function Wt(e3) {
  return W(function(t, n) {
    z(e3).subscribe(F(n, function() {
      return n.complete();
    }, We)), !n.closed && t.subscribe(n);
  });
}
function Qi(e3, t, n) {
  var r = P(e3) || t || n ? { next: e3, error: t, complete: n } : e3;
  return r ? W(function(i2, o) {
    var s2;
    (s2 = r.subscribe) === null || s2 === void 0 || s2.call(r);
    var a = true;
    i2.subscribe(F(o, function(c) {
      var u;
      (u = r.next) === null || u === void 0 || u.call(r, c), o.next(c);
    }, function() {
      var c;
      a = false, (c = r.complete) === null || c === void 0 || c.call(r), o.complete();
    }, function(c) {
      var u;
      a = false, (u = r.error) === null || u === void 0 || u.call(r, c), o.error(c);
    }, function() {
      var c, u;
      a && ((c = r.unsubscribe) === null || c === void 0 || c.call(r)), (u = r.finalize) === null || u === void 0 || u.call(r);
    }));
  }) : Qe;
}
var Ji = Object.defineProperty;
var Xi = Object.defineProperties;
var Zi = Object.getOwnPropertyDescriptors;
var jt = Object.getOwnPropertySymbols;
var eo = Object.prototype.hasOwnProperty;
var to = Object.prototype.propertyIsEnumerable;
var Bt = (e3, t, n) => t in e3 ? Ji(e3, t, { enumerable: true, configurable: true, writable: true, value: n }) : e3[t] = n;
var q = (e3, t) => {
  for (var n in t || (t = {}))
    eo.call(t, n) && Bt(e3, n, t[n]);
  if (jt)
    for (var n of jt(t))
      to.call(t, n) && Bt(e3, n, t[n]);
  return e3;
};
var ce = (e3, t) => Xi(e3, Zi(t));
var H = (e3, t, n) => new Promise((r, i2) => {
  var o = (c) => {
    try {
      a(n.next(c));
    } catch (u) {
      i2(u);
    }
  }, s2 = (c) => {
    try {
      a(n.throw(c));
    } catch (u) {
      i2(u);
    }
  }, a = (c) => c.done ? r(c.value) : Promise.resolve(c.value).then(o, s2);
  a((n = n.apply(e3, t)).next());
});
var On = "lk";
function B(e3) {
  return typeof e3 > "u" ? false : no(e3) || ro(e3);
}
function no(e3) {
  var t;
  return e3 ? e3.hasOwnProperty("participant") && e3.hasOwnProperty("source") && e3.hasOwnProperty("track") && typeof ((t = e3.publication) == null ? void 0 : t.track) < "u" : false;
}
function ro(e3) {
  return e3 ? e3.hasOwnProperty("participant") && e3.hasOwnProperty("source") && e3.hasOwnProperty("publication") && typeof e3.publication < "u" : false;
}
function Oe(e3) {
  return e3 ? e3.hasOwnProperty("participant") && e3.hasOwnProperty("source") && typeof e3.publication > "u" : false;
}
function N(e3) {
  if (typeof e3 == "string" || typeof e3 == "number")
    return `${e3}`;
  if (Oe(e3))
    return `${e3.participant.identity}_${e3.source}_placeholder`;
  if (B(e3))
    return `${e3.participant.identity}_${e3.publication.source}_${e3.publication.trackSid}`;
  throw new Error(`Can't generate a id for the given track reference: ${e3}`);
}
function ts(e3, t) {
  return e3 === void 0 || t === void 0 ? false : B(e3) && B(t) ? e3.publication.trackSid === t.publication.trackSid : N(e3) === N(t);
}
function ns(e3, t) {
  return typeof t > "u" ? false : B(e3) ? t.some(
    (n) => n.participant.identity === e3.participant.identity && B(n) && n.publication.trackSid === e3.publication.trackSid
  ) : Oe(e3) ? t.some(
    (n) => n.participant.identity === e3.participant.identity && Oe(n) && n.source === e3.source
  ) : false;
}
function io(e3, t) {
  return Oe(e3) && B(t) && t.participant.identity === e3.participant.identity && t.source === e3.source;
}
function rs() {
  const e3 = document.createElement("p");
  e3.style.width = "100%", e3.style.height = "200px";
  const t = document.createElement("div");
  t.style.position = "absolute", t.style.top = "0px", t.style.left = "0px", t.style.visibility = "hidden", t.style.width = "200px", t.style.height = "150px", t.style.overflow = "hidden", t.appendChild(e3), document.body.appendChild(t);
  const n = e3.offsetWidth;
  t.style.overflow = "scroll";
  let r = e3.offsetWidth;
  return n === r && (r = t.clientWidth), document.body.removeChild(t), n - r;
}
function is() {
  return typeof document < "u";
}
function oo(e3) {
  e3 = q({}, e3);
  const t = "(?:(?:[a-z]+:)?//)?", n = "(?:\\S+(?::\\S*)?@)?", r = new RegExp(
    "(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",
    "g"
  ).source, u = `(?:${t}|www\\.)${n}(?:localhost|${r}|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#][^\\s"]*)?`;
  return e3.exact ? new RegExp(`(?:^${u}$)`, "i") : new RegExp(u, "ig");
}
var Vt = "[^\\.\\s@:](?:[^\\s@:]*[^\\s@:\\.])?@[^\\.\\s@]+(?:\\.[^\\.\\s@]+)*";
function so({ exact: e3 } = {}) {
  return e3 ? new RegExp(`^${Vt}$`) : new RegExp(Vt, "g");
}
function os(e3, t, n) {
  return Ur(e3, t, () => H(this, null, function* () {
    const { x: i2, y: o } = yield Vr(e3, t, {
      placement: "top",
      middleware: [Wr(6), Br(), jr({ padding: 5 })]
    });
    n == null || n(i2, o);
  }));
}
function ss(e3, t) {
  return !e3.contains(t.target);
}
var as = () => ({
  email: so(),
  url: oo({})
});
function cs(e3, t) {
  const n = Object.entries(t).map(
    ([o, s2], a) => Array.from(e3.matchAll(s2)).map(({ index: c, 0: u }) => ({
      type: o,
      weight: a,
      content: u,
      index: c ?? 0
    }))
  ).flat().sort((o, s2) => {
    const a = o.index - s2.index;
    return a !== 0 ? a : o.weight - s2.weight;
  }).filter(({ index: o }, s2, a) => {
    if (s2 === 0) return true;
    const c = a[s2 - 1];
    return c.index + c.content.length <= o;
  }), r = [];
  let i2 = 0;
  for (const { type: o, content: s2, index: a } of n)
    a > i2 && r.push(e3.substring(i2, a)), r.push({ type: o, content: s2 }), i2 = a + s2.length;
  return e3.length > i2 && r.push(e3.substring(i2)), r;
}
var ao = [
  RoomEvent.ConnectionStateChanged,
  RoomEvent.RoomMetadataChanged,
  RoomEvent.ActiveSpeakersChanged,
  RoomEvent.ConnectionQualityChanged,
  RoomEvent.ParticipantConnected,
  RoomEvent.ParticipantDisconnected,
  RoomEvent.ParticipantPermissionsChanged,
  RoomEvent.ParticipantMetadataChanged,
  RoomEvent.ParticipantNameChanged,
  RoomEvent.ParticipantAttributesChanged,
  RoomEvent.TrackMuted,
  RoomEvent.TrackUnmuted,
  RoomEvent.TrackPublished,
  RoomEvent.TrackUnpublished,
  RoomEvent.TrackStreamStateChanged,
  RoomEvent.TrackSubscriptionFailed,
  RoomEvent.TrackSubscriptionPermissionChanged,
  RoomEvent.TrackSubscriptionStatusChanged
];
var An = [
  ...ao,
  RoomEvent.LocalTrackPublished,
  RoomEvent.LocalTrackUnpublished
];
var co = [
  ParticipantEvent.TrackPublished,
  ParticipantEvent.TrackUnpublished,
  ParticipantEvent.TrackMuted,
  ParticipantEvent.TrackUnmuted,
  ParticipantEvent.TrackStreamStateChanged,
  ParticipantEvent.TrackSubscribed,
  ParticipantEvent.TrackUnsubscribed,
  ParticipantEvent.TrackSubscriptionPermissionChanged,
  ParticipantEvent.TrackSubscriptionFailed,
  ParticipantEvent.LocalTrackPublished,
  ParticipantEvent.LocalTrackUnpublished
];
var uo = [
  ParticipantEvent.ConnectionQualityChanged,
  ParticipantEvent.IsSpeakingChanged,
  ParticipantEvent.ParticipantMetadataChanged,
  ParticipantEvent.ParticipantPermissionsChanged,
  ParticipantEvent.TrackMuted,
  ParticipantEvent.TrackUnmuted,
  ParticipantEvent.TrackPublished,
  ParticipantEvent.TrackUnpublished,
  ParticipantEvent.TrackStreamStateChanged,
  ParticipantEvent.TrackSubscriptionFailed,
  ParticipantEvent.TrackSubscriptionPermissionChanged,
  ParticipantEvent.TrackSubscriptionStatusChanged
];
var kn = [
  ...uo,
  ParticipantEvent.LocalTrackPublished,
  ParticipantEvent.LocalTrackUnpublished
];
var L = Kr.getLogger("lk-components-js");
L.setDefaultLevel("WARN");
function us(e3, t = {}) {
  var n;
  L.setLevel(e3), setLogLevel((n = t.liveKitClientLogLevel) != null ? n : e3);
}
function ls(e3, t = {}) {
  var n;
  const r = L.methodFactory;
  L.methodFactory = (i2, o, s2) => {
    const a = r(i2, o, s2), c = LogLevel[i2], u = c >= o && c < LogLevel.silent;
    return (l, f) => {
      f ? a(l, f) : a(l), u && e3(c, l, f);
    };
  }, L.setLevel(L.getLevel()), setLogExtension((n = t.liveKitClientLogExtension) != null ? n : e3);
}
var fs = [
  {
    columns: 1,
    rows: 1
  },
  {
    columns: 1,
    rows: 2,
    orientation: "portrait"
  },
  {
    columns: 2,
    rows: 1,
    orientation: "landscape"
  },
  {
    columns: 2,
    rows: 2,
    minWidth: 560
  },
  {
    columns: 3,
    rows: 3,
    minWidth: 700
  },
  {
    columns: 4,
    rows: 4,
    minWidth: 960
  },
  {
    columns: 5,
    rows: 5,
    minWidth: 1100
  }
];
function lo(e3, t, n, r) {
  if (e3.length < 1)
    throw new Error("At least one grid layout definition must be provided.");
  const i2 = fo(e3);
  if (n <= 0 || r <= 0)
    return i2[0];
  let o = 0;
  const s2 = n / r > 1 ? "landscape" : "portrait";
  let a = i2.find((c, u, l) => {
    o = u;
    const f = l.findIndex((v, d) => {
      const m = !v.orientation || v.orientation === s2, p = d > u, g = v.maxTiles === c.maxTiles;
      return p && g && m;
    }) !== -1;
    return c.maxTiles >= t && !f;
  });
  if (a === void 0)
    if (a = i2[i2.length - 1], a)
      L.warn(
        `No layout found for: participantCount: ${t}, width/height: ${n}/${r} fallback to biggest available layout (${a}).`
      );
    else
      throw new Error("No layout or fallback layout found.");
  if ((n < a.minWidth || r < a.minHeight) && o > 0) {
    const c = i2[o - 1];
    a = lo(
      i2.slice(0, o),
      c.maxTiles,
      n,
      r
    );
  }
  return a;
}
function fo(e3) {
  return [...e3].map((t) => {
    var n, r;
    return {
      name: `${t.columns}x${t.rows}`,
      columns: t.columns,
      rows: t.rows,
      maxTiles: t.columns * t.rows,
      minWidth: (n = t.minWidth) != null ? n : 0,
      minHeight: (r = t.minHeight) != null ? r : 0,
      orientation: t.orientation
    };
  }).sort((t, n) => t.maxTiles !== n.maxTiles ? t.maxTiles - n.maxTiles : t.minWidth !== 0 || n.minWidth !== 0 ? t.minWidth - n.minWidth : t.minHeight !== 0 || n.minHeight !== 0 ? t.minHeight - n.minHeight : 0);
}
function ds() {
  return typeof navigator < "u" && navigator.mediaDevices && !!navigator.mediaDevices.getDisplayMedia;
}
function ps(e3, t) {
  var n;
  return ce(q({}, e3), {
    receivedAtMediaTimestamp: (n = t.rtpTimestamp) != null ? n : 0,
    receivedAt: t.timestamp
  });
}
function hs(e3, t, n) {
  return [...e3, ...t].reduceRight((r, i2) => (r.find((o) => o.id === i2.id) || r.unshift(i2), r), []).slice(0 - n);
}
var po = ((e3) => (e3.AgentState = "lk.agent.state", e3.PublishOnBehalf = "lk.publish_on_behalf", e3.TranscriptionFinal = "lk.transcription_final", e3.TranscriptionSegmentId = "lk.segment_id", e3.TranscribedTrackId = "lk.transcribed_track_id", e3))(po || {});
var _n = [];
var Ln = {
  showChat: false,
  unreadMessages: 0,
  showSettings: false
};
function ho(e3) {
  return typeof e3 == "object";
}
function vs(e3) {
  return Array.isArray(e3) && e3.filter(ho).length > 0;
}
function In(e3, t) {
  return t.audioLevel - e3.audioLevel;
}
function Mn(e3, t) {
  return e3.isSpeaking === t.isSpeaking ? 0 : e3.isSpeaking ? -1 : 1;
}
function Rn(e3, t) {
  var n, r, i2, o;
  return e3.lastSpokeAt !== void 0 || t.lastSpokeAt !== void 0 ? ((r = (n = t.lastSpokeAt) == null ? void 0 : n.getTime()) != null ? r : 0) - ((o = (i2 = e3.lastSpokeAt) == null ? void 0 : i2.getTime()) != null ? o : 0) : 0;
}
function Be(e3, t) {
  var n, r, i2, o;
  return ((r = (n = e3.joinedAt) == null ? void 0 : n.getTime()) != null ? r : 0) - ((o = (i2 = t.joinedAt) == null ? void 0 : i2.getTime()) != null ? o : 0);
}
function vo(e3, t) {
  return B(e3) ? B(t) ? 0 : -1 : B(t) ? 1 : 0;
}
function mo(e3, t) {
  const n = e3.participant.isCameraEnabled, r = t.participant.isCameraEnabled;
  return n !== r ? n ? -1 : 1 : 0;
}
function ms(e3) {
  const t = [], n = [], r = [], i2 = [];
  e3.forEach((a) => {
    a.participant.isLocal && a.source === Track.Source.Camera ? t.push(a) : a.source === Track.Source.ScreenShare ? n.push(a) : a.source === Track.Source.Camera ? r.push(a) : i2.push(a);
  });
  const o = go(n), s2 = bo(r);
  return [...t, ...o, ...s2, ...i2];
}
function go(e3) {
  const t = [], n = [];
  return e3.forEach((i2) => {
    i2.participant.isLocal ? t.push(i2) : n.push(i2);
  }), t.sort((i2, o) => Be(i2.participant, o.participant)), n.sort((i2, o) => Be(i2.participant, o.participant)), [...n, ...t];
}
function bo(e3) {
  const t = [], n = [];
  return e3.forEach((r) => {
    r.participant.isLocal ? t.push(r) : n.push(r);
  }), n.sort((r, i2) => r.participant.isSpeaking && i2.participant.isSpeaking ? In(r.participant, i2.participant) : r.participant.isSpeaking !== i2.participant.isSpeaking ? Mn(r.participant, i2.participant) : r.participant.lastSpokeAt !== i2.participant.lastSpokeAt ? Rn(r.participant, i2.participant) : B(r) !== B(i2) ? vo(r, i2) : r.participant.isCameraEnabled !== i2.participant.isCameraEnabled ? mo(r, i2) : Be(r.participant, i2.participant)), [...t, ...n];
}
function gs(e3) {
  const t = [...e3];
  t.sort((r, i2) => {
    if (r.isSpeaking && i2.isSpeaking)
      return In(r, i2);
    if (r.isSpeaking !== i2.isSpeaking)
      return Mn(r, i2);
    if (r.lastSpokeAt !== i2.lastSpokeAt)
      return Rn(r, i2);
    const o = r.videoTrackPublications.size > 0, s2 = i2.videoTrackPublications.size > 0;
    return o !== s2 ? o ? -1 : 1 : Be(r, i2);
  });
  const n = t.find((r) => r.isLocal);
  if (n) {
    const r = t.indexOf(n);
    r >= 0 && (t.splice(r, 1), t.length > 0 ? t.splice(0, 0, n) : t.push(n));
  }
  return t;
}
function yo(e3, t) {
  return e3.reduce(
    (n, r, i2) => i2 % t === 0 ? [...n, [r]] : [...n.slice(0, -1), [...n.slice(-1)[0], r]],
    []
  );
}
function Ht(e3, t) {
  const n = Math.max(e3.length, t.length);
  return new Array(n).fill([]).map((r, i2) => [e3[i2], t[i2]]);
}
function Ve(e3, t, n) {
  return e3.filter((r) => !t.map((i2) => n(i2)).includes(n(r)));
}
function ft(e3) {
  return e3.map((t) => typeof t == "string" || typeof t == "number" ? `${t}` : N(t));
}
function wo(e3, t) {
  return {
    dropped: Ve(e3, t, N),
    added: Ve(t, e3, N)
  };
}
function xo(e3) {
  return e3.added.length !== 0 || e3.dropped.length !== 0;
}
function dt(e3, t) {
  const n = t.findIndex(
    (r) => N(r) === N(e3)
  );
  if (n === -1)
    throw new Error(
      `Element not part of the array: ${N(
        e3
      )} not in ${ft(t)}`
    );
  return n;
}
function So(e3, t, n) {
  const r = dt(e3, n), i2 = dt(t, n);
  return n.splice(r, 1, t), n.splice(i2, 1, e3), n;
}
function To(e3, t) {
  const n = dt(e3, t);
  return t.splice(n, 1), t;
}
function Eo(e3, t) {
  return [...t, e3];
}
function rt(e3, t) {
  return yo(e3, t);
}
function bs(e3, t, n) {
  let r = Co(e3, t);
  if (r.length < t.length) {
    const s2 = Ve(t, r, N);
    r = [...r, ...s2];
  }
  const i2 = rt(r, n), o = rt(t, n);
  if (Ht(i2, o).forEach(([s2, a], c) => {
    if (s2 && a) {
      const u = rt(r, n)[c], l = wo(u, a);
      xo(l) && (L.debug(
        `Detected visual changes on page: ${c}, current: ${ft(
          s2
        )}, next: ${ft(a)}`,
        { changes: l }
      ), l.added.length === l.dropped.length && Ht(l.added, l.dropped).forEach(([f, v]) => {
        if (f && v)
          r = So(f, v, r);
        else
          throw new Error(
            `For a swap action we need a addition and a removal one is missing: ${f}, ${v}`
          );
      }), l.added.length === 0 && l.dropped.length > 0 && l.dropped.forEach((f) => {
        r = To(f, r);
      }), l.added.length > 0 && l.dropped.length === 0 && l.added.forEach((f) => {
        r = Eo(f, r);
      }));
    }
  }), r.length > t.length) {
    const s2 = Ve(r, t, N);
    r = r.filter(
      (a) => !s2.map(N).includes(N(a))
    );
  }
  return r;
}
function Co(e3, t) {
  return e3.map((n) => {
    const r = t.find(
      (i2) => (
        // If the IDs match or ..
        N(n) === N(i2) || // ... if the current item is a placeholder and the new item is the track reference can replace it.
        typeof n != "number" && Oe(n) && B(i2) && io(n, i2)
      )
    );
    return r ?? n;
  });
}
function U(e3) {
  return `${On}-${e3}`;
}
function ys(e3) {
  const t = zt(e3), n = Dn(e3.participant).pipe(
    A(() => zt(e3)),
    D(t)
  );
  return { className: U(
    e3.source === Track.Source.Camera || e3.source === Track.Source.ScreenShare ? "participant-media-video" : "participant-media-audio"
  ), trackObserver: n };
}
function zt(e3) {
  if (B(e3))
    return e3.publication;
  {
    const { source: t, name: n, participant: r } = e3;
    if (t && n)
      return r.getTrackPublications().find((i2) => i2.source === t && i2.trackName === n);
    if (n)
      return r.getTrackPublicationByName(n);
    if (t)
      return r.getTrackPublication(t);
    throw new Error("At least one of source and name needs to be defined");
  }
}
function pe(e3, ...t) {
  return new k((r) => {
    const i2 = () => {
      r.next(e3);
    };
    return t.forEach((s2) => {
      e3.on(s2, i2);
    }), () => {
      t.forEach((s2) => {
        e3.off(s2, i2);
      });
    };
  }).pipe(D(e3));
}
function we(e3, t) {
  return new k((r) => {
    const i2 = (...s2) => {
      r.next(s2);
    };
    return e3.on(t, i2), () => {
      e3.off(t, i2);
    };
  });
}
function ws(e3) {
  return we(e3, RoomEvent.ConnectionStateChanged).pipe(
    A(([t]) => t),
    D(e3.state)
  );
}
function xs(e3) {
  return pe(
    e3,
    RoomEvent.RoomMetadataChanged,
    RoomEvent.ConnectionStateChanged
  ).pipe(
    A((n) => ({ name: n.name, metadata: n.metadata }))
  );
}
function Ss(e3) {
  return we(e3, RoomEvent.ActiveSpeakersChanged).pipe(
    A(([t]) => t)
  );
}
function Ts(e3, t, n = true) {
  const r = new k((o) => {
    Room.getLocalDevices(e3, n).then((s2) => {
      o.next(s2), o.complete();
    }).catch((s2) => {
      t == null || t(s2), o.next([]), o.complete();
    });
  }), i2 = new k((o) => {
    var s2;
    const a = () => H(this, null, function* () {
      try {
        const c = yield Room.getLocalDevices(e3, n);
        o.next(c);
      } catch (c) {
        t == null || t(c);
      }
    });
    if (typeof window < "u") {
      if (!window.isSecureContext)
        throw new Error(
          "Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices"
        );
      (s2 = navigator == null ? void 0 : navigator.mediaDevices) == null || s2.addEventListener("devicechange", a);
    }
    return () => {
      var c;
      (c = navigator == null ? void 0 : navigator.mediaDevices) == null || c.removeEventListener("devicechange", a);
    };
  });
  return je(r, i2);
}
function Po(e3) {
  return we(e3, RoomEvent.DataReceived);
}
function Oo(e3) {
  return pe(e3, RoomEvent.AudioPlaybackStatusChanged).pipe(
    A((n) => ({ canPlayAudio: n.canPlaybackAudio }))
  );
}
function Ao(e3) {
  return pe(e3, RoomEvent.VideoPlaybackStatusChanged).pipe(
    A((n) => ({ canPlayVideo: n.canPlaybackVideo }))
  );
}
function ko(e3, t) {
  return we(e3, RoomEvent.ActiveDeviceChanged).pipe(
    Xe(([n]) => n === t),
    A(([n, r]) => (L.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged", { kind: n, deviceId: r }), r))
  );
}
function Es(e3, t) {
  return we(e3, RoomEvent.ParticipantEncryptionStatusChanged).pipe(
    Xe(
      ([, n]) => (t == null ? void 0 : t.identity) === (n == null ? void 0 : n.identity) || !n && (t == null ? void 0 : t.identity) === e3.localParticipant.identity
    ),
    A(([n]) => n),
    D(
      t != null && t.isLocal ? t.isE2EEEnabled : !!(t != null && t.isEncrypted)
    )
  );
}
function Cs(e3) {
  return we(e3, RoomEvent.RecordingStatusChanged).pipe(
    A(([t]) => t),
    D(e3.isRecording)
  );
}
function xe(e3, ...t) {
  return new k((r) => {
    const i2 = () => {
      r.next(e3);
    };
    return t.forEach((s2) => {
      e3.on(s2, i2);
    }), () => {
      t.forEach((s2) => {
        e3.off(s2, i2);
      });
    };
  }).pipe(D(e3));
}
function Dn(e3) {
  return xe(
    e3,
    ParticipantEvent.TrackMuted,
    ParticipantEvent.TrackUnmuted,
    ParticipantEvent.ParticipantPermissionsChanged,
    // ParticipantEvent.IsSpeakingChanged,
    ParticipantEvent.TrackPublished,
    ParticipantEvent.TrackUnpublished,
    ParticipantEvent.LocalTrackPublished,
    ParticipantEvent.LocalTrackUnpublished,
    ParticipantEvent.MediaDevicesError,
    ParticipantEvent.TrackSubscriptionStatusChanged
    // ParticipantEvent.ConnectionQualityChanged,
  ).pipe(
    A((n) => {
      const { isMicrophoneEnabled: r, isCameraEnabled: i2, isScreenShareEnabled: o } = n, s2 = n.getTrackPublication(Track.Source.Microphone), a = n.getTrackPublication(Track.Source.Camera);
      return {
        isCameraEnabled: i2,
        isMicrophoneEnabled: r,
        isScreenShareEnabled: o,
        cameraTrack: a,
        microphoneTrack: s2,
        participant: n
      };
    })
  );
}
function _o(e3) {
  return e3 ? xe(
    e3,
    ParticipantEvent.ParticipantMetadataChanged,
    ParticipantEvent.ParticipantNameChanged
  ).pipe(
    A(({ name: n, identity: r, metadata: i2 }) => ({
      name: n,
      identity: r,
      metadata: i2
    })),
    D({
      name: e3.name,
      identity: e3.identity,
      metadata: e3.metadata
    })
  ) : void 0;
}
function Lo(e3) {
  return Ze(
    e3,
    ParticipantEvent.ConnectionQualityChanged
  ).pipe(
    A(([n]) => n),
    D(e3.connectionQuality)
  );
}
function Ze(e3, t) {
  return new k((r) => {
    const i2 = (...s2) => {
      r.next(s2);
    };
    return e3.on(t, i2), () => {
      e3.off(t, i2);
    };
  });
}
function Io(e3) {
  var t, n, r, i2;
  return xe(
    e3.participant,
    ParticipantEvent.TrackMuted,
    ParticipantEvent.TrackUnmuted,
    ParticipantEvent.TrackSubscribed,
    ParticipantEvent.TrackUnsubscribed,
    ParticipantEvent.LocalTrackPublished,
    ParticipantEvent.LocalTrackUnpublished
  ).pipe(
    A((o) => {
      var s2, a;
      const c = (s2 = e3.publication) != null ? s2 : o.getTrackPublication(e3.source);
      return (a = c == null ? void 0 : c.isMuted) != null ? a : true;
    }),
    D(
      (i2 = (r = (t = e3.publication) == null ? void 0 : t.isMuted) != null ? r : (n = e3.participant.getTrackPublication(e3.source)) == null ? void 0 : n.isMuted) != null ? i2 : true
    )
  );
}
function Ps(e3) {
  return Ze(e3, ParticipantEvent.IsSpeakingChanged).pipe(
    A(([t]) => t)
  );
}
function Os(e3, t = {}) {
  var n;
  let r;
  const i2 = new k((c) => (r = c, () => a.unsubscribe())).pipe(D(Array.from(e3.remoteParticipants.values()))), o = (n = t.additionalRoomEvents) != null ? n : An, s2 = Array.from(
    /* @__PURE__ */ new Set([
      RoomEvent.ParticipantConnected,
      RoomEvent.ParticipantDisconnected,
      RoomEvent.ConnectionStateChanged,
      ...o
    ])
  ), a = pe(e3, ...s2).subscribe(
    (c) => r == null ? void 0 : r.next(Array.from(c.remoteParticipants.values()))
  );
  return e3.remoteParticipants.size > 0 && (r == null || r.next(Array.from(e3.remoteParticipants.values()))), i2;
}
function As(e3, t, n = {}) {
  var r;
  const i2 = (r = n.additionalEvents) != null ? r : kn;
  return pe(
    e3,
    RoomEvent.ParticipantConnected,
    RoomEvent.ParticipantDisconnected,
    RoomEvent.ConnectionStateChanged
  ).pipe(
    Pn((s2) => {
      const a = s2.getParticipantByIdentity(t);
      return a ? xe(a, ...i2) : new k((c) => c.next(void 0));
    }),
    D(e3.getParticipantByIdentity(t))
  );
}
function ks(e3) {
  return Ze(
    e3,
    ParticipantEvent.ParticipantPermissionsChanged
  ).pipe(
    A(() => e3.permissions),
    D(e3.permissions)
  );
}
function _s(e3, { kind: t, identity: n }, r = {}) {
  var i2;
  const o = (i2 = r.additionalEvents) != null ? i2 : kn, s2 = (c) => {
    let u = true;
    return t && (u = u && c.kind === t), n && (u = u && c.identity === n), u;
  };
  return pe(
    e3,
    RoomEvent.ParticipantConnected,
    RoomEvent.ParticipantDisconnected,
    RoomEvent.ConnectionStateChanged
  ).pipe(
    Pn((c) => {
      const u = Array.from(c.remoteParticipants.values()).find(
        (l) => s2(l)
      );
      return u ? xe(u, ...o) : new k((l) => l.next(void 0));
    }),
    D(Array.from(e3.remoteParticipants.values()).find((c) => s2(c)))
  );
}
function Ls(e3) {
  return typeof e3 > "u" ? new k() : Ze(e3, ParticipantEvent.AttributesChanged).pipe(
    A(([t]) => ({
      changed: t,
      attributes: e3.attributes
    })),
    D({ changed: e3.attributes, attributes: e3.attributes })
  );
}
function Is(e3, t, n, r, i2) {
  const { localParticipant: o } = t, s2 = (f, v) => {
    let d = false;
    switch (f) {
      case Track.Source.Camera:
        d = v.isCameraEnabled;
        break;
      case Track.Source.Microphone:
        d = v.isMicrophoneEnabled;
        break;
      case Track.Source.ScreenShare:
        d = v.isScreenShareEnabled;
        break;
    }
    return d;
  }, a = Dn(o).pipe(
    A((f) => s2(e3, f.participant)),
    D(s2(e3, o))
  ), c = new te(), u = (f, v) => H(this, null, function* () {
    try {
      switch (v ?? (v = n), c.next(true), e3) {
        case Track.Source.Camera:
          return yield o.setCameraEnabled(
            f ?? !o.isCameraEnabled,
            v,
            r
          ), o.isCameraEnabled;
        case Track.Source.Microphone:
          return yield o.setMicrophoneEnabled(
            f ?? !o.isMicrophoneEnabled,
            v,
            r
          ), o.isMicrophoneEnabled;
        case Track.Source.ScreenShare:
          return yield o.setScreenShareEnabled(
            f ?? !o.isScreenShareEnabled,
            v,
            r
          ), o.isScreenShareEnabled;
        default:
          throw new TypeError("Tried to toggle unsupported source");
      }
    } catch (d) {
      if (i2 && d instanceof Error) {
        i2 == null || i2(d);
        return;
      } else
        throw d;
    } finally {
      c.next(false);
    }
  });
  return {
    className: U("button"),
    toggle: u,
    enabledObserver: a,
    pendingObserver: c.asObservable()
  };
}
function Ms() {
  let e3 = false;
  const t = new te(), n = new te(), r = (o) => H(this, null, function* () {
    n.next(true), e3 = o ?? !e3, t.next(e3), n.next(false);
  });
  return {
    className: U("button"),
    toggle: r,
    enabledObserver: t.asObservable(),
    pendingObserver: n.asObservable()
  };
}
function Rs(e3, t, n) {
  const r = new pn(void 0), i2 = ko(t, e3), o = (a, ...c) => H(this, [a, ...c], function* (u, l = {}) {
    var f, v, d;
    if (t) {
      const m = getBrowser();
      if (e3 === "audiooutput" && ((m == null ? void 0 : m.name) === "Safari" || (m == null ? void 0 : m.os) === "iOS")) {
        L.warn("Switching audio output device is not supported on Safari and iOS.");
        return;
      }
      L.debug(`Switching active device of kind "${e3}" with id ${u}.`), yield t.switchActiveDevice(e3, u, l.exact);
      const p = (f = t.getActiveDevice(e3)) != null ? f : u;
      p !== u && u !== "default" && L.info(
        `We tried to select the device with id (${u}), but the browser decided to select the device with id (${p}) instead.`
      );
      let g;
      e3 === "audioinput" ? g = (v = t.localParticipant.getTrackPublication(Track.Source.Microphone)) == null ? void 0 : v.track : e3 === "videoinput" && (g = (d = t.localParticipant.getTrackPublication(Track.Source.Camera)) == null ? void 0 : d.track);
      const h = u === "default" && !g || u === "default" && (g == null ? void 0 : g.mediaStreamTrack.label.startsWith("Default"));
      r.next(h ? u : p);
    }
  });
  return {
    className: U("media-device-select"),
    activeDeviceObservable: i2,
    setActiveMediaDevice: o
  };
}
function Ds(e3) {
  const t = (r) => {
    e3.disconnect(r);
  };
  return { className: U("disconnect-button"), disconnect: t };
}
function $s(e3) {
  const t = U("connection-quality"), n = Lo(e3);
  return { className: t, connectionQualityObserver: n };
}
function Ns(e3) {
  let t = "track-muted-indicator-camera";
  switch (e3.source) {
    case Track.Source.Camera:
      t = "track-muted-indicator-camera";
      break;
    case Track.Source.Microphone:
      t = "track-muted-indicator-microphone";
      break;
  }
  const n = U(t), r = Io(e3);
  return { className: n, mediaMutedObserver: r };
}
function Fs(e3) {
  return { className: "lk-participant-name", infoObserver: _o(e3) };
}
function Us() {
  return {
    className: U("participant-tile")
  };
}
var Mo = {
  CHAT: "lk.chat",
  TRANSCRIPTION: "lk.transcription"
};
var Ro = {
  CHAT: "lk-chat-topic"
};
function $n(e3, t) {
  return H(this, arguments, function* (n, r, i2 = {}) {
    const { reliable: o, destinationIdentities: s2, topic: a } = i2;
    yield n.publishData(r, {
      destinationIdentities: s2,
      topic: a,
      reliable: o
    });
  });
}
function Do(e3, t, n) {
  const r = Array.isArray(t) ? t : [t], i2 = Po(e3).pipe(
    Xe(
      ([, , , c]) => t === void 0 || c !== void 0 && r.includes(c)
    ),
    A(([c, u, , l]) => {
      const f = {
        payload: c,
        topic: l,
        from: u
      };
      return n == null || n(f), f;
    })
  );
  let o;
  const s2 = new k((c) => {
    o = c;
  });
  return { messageObservable: i2, isSendingObservable: s2, send: (c, ...u) => H(this, [c, ...u], function* (l, f = {}) {
    o.next(true);
    try {
      yield $n(e3.localParticipant, l, q({ topic: r[0] }, f));
    } finally {
      o.next(false);
    }
  }) };
}
var Ie = /* @__PURE__ */ new WeakMap();
function $o(e3) {
  return e3.ignoreLegacy == true;
}
var No = (e3) => JSON.parse(new TextDecoder().decode(e3));
var Fo = (e3) => new TextEncoder().encode(JSON.stringify(e3));
function Ws(e3, t) {
  var n, r, i2, o, s2, a;
  const c = () => {
    var b, S, C;
    return ((b = e3.serverInfo) == null ? void 0 : b.edition) === 1 || !!((S = e3.serverInfo) != null && S.version) && compareVersions((C = e3.serverInfo) == null ? void 0 : C.version, "1.8.2") > 0;
  }, u = new te(), l = (n = t == null ? void 0 : t.channelTopic) != null ? n : Mo.CHAT, f = (r = t == null ? void 0 : t.channelTopic) != null ? r : Ro.CHAT;
  let v = false;
  Ie.has(e3) || (v = true);
  const d = (i2 = Ie.get(e3)) != null ? i2 : /* @__PURE__ */ new Map(), m = (o = d.get(l)) != null ? o : new te();
  d.set(l, m), Ie.set(e3, d);
  const p = (s2 = t == null ? void 0 : t.messageDecoder) != null ? s2 : No;
  if (v) {
    e3.registerTextStreamHandler(l, (S, C) => H(this, null, function* () {
      const { id: $2, timestamp: M2 } = S.info;
      Je(S).pipe(
        lt((T2, _2) => T2 + _2),
        A((T2) => ({
          id: $2,
          timestamp: M2,
          message: T2,
          from: e3.getParticipantByIdentity(C.identity),
          type: "chatMessage"
          // editTimestamp: type === 'update' ? timestamp : undefined,
        }))
      ).subscribe({
        next: (T2) => m.next(T2)
      });
    }));
    const { messageObservable: b } = Do(e3, [f]);
    b.pipe(
      A((S) => {
        const C = p(S.payload);
        return $o(C) ? void 0 : ce(q({}, C), {
          type: "chatMessage",
          from: S.from
        });
      }),
      Xe((S) => !!S),
      Wt(u)
    ).subscribe(m);
  }
  const g = m.pipe(
    lt((b, S) => {
      if ("id" in S && b.find((C) => {
        var $2, M2;
        return (($2 = C.from) == null ? void 0 : $2.identity) === ((M2 = S.from) == null ? void 0 : M2.identity) && C.id === S.id;
      })) {
        const C = b.findIndex(($2) => $2.id === S.id);
        if (C > -1) {
          const $2 = b[C];
          b[C] = ce(q({}, S), {
            timestamp: $2.timestamp,
            editTimestamp: S.timestamp
          });
        }
        return [...b];
      }
      return [...b, S];
    }, []),
    Wt(u)
  ), h = new pn(false), x2 = (a = t == null ? void 0 : t.messageEncoder) != null ? a : Fo, E = (b, S) => H(this, null, function* () {
    var C;
    S || (S = {}), (C = S.topic) != null || (S.topic = l), h.next(true);
    try {
      const M2 = {
        id: (yield e3.localParticipant.sendText(b, S)).id,
        timestamp: Date.now(),
        message: b
      }, V2 = ce(q({}, M2), {
        attachedFiles: S.attachments
      }), T2 = ce(q({}, V2), {
        type: "chatMessage",
        from: e3.localParticipant,
        attributes: S.attributes
      });
      m.next(T2);
      const _2 = x2(ce(q({}, M2), {
        ignoreLegacy: c()
      }));
      try {
        yield $n(e3.localParticipant, _2, {
          reliable: true,
          topic: f
        });
      } catch (ee3) {
        L.info("could not send message in legacy chat format", ee3);
      }
      return T2;
    } finally {
      h.next(false);
    }
  });
  function O2() {
    u.next(), u.complete(), m.complete(), Ie.delete(e3), e3.unregisterTextStreamHandler(l);
  }
  return e3.once(RoomEvent.Disconnected, O2), {
    messageObservable: g,
    isSendingObservable: h,
    send: E
  };
}
function js() {
  const e3 = (n) => H(this, null, function* () {
    L.info("Start Audio for room: ", n), yield n.startAudio();
  });
  return { className: U("start-audio-button"), roomAudioPlaybackAllowedObservable: Oo, handleStartAudioPlayback: e3 };
}
function Bs() {
  const e3 = (n) => H(this, null, function* () {
    L.info("Start Video for room: ", n), yield n.startVideo();
  });
  return { className: U("start-audio-button"), roomVideoPlaybackAllowedObservable: Ao, handleStartVideoPlayback: e3 };
}
function Vs() {
  return { className: [U("button"), U("chat-toggle")].join(" ") };
}
function Hs() {
  return { className: [U("button"), U("focus-toggle-button")].join(" ") };
}
function zs() {
  return { className: "lk-clear-pin-button lk-button" };
}
function Ys() {
  return { className: "lk-room-container" };
}
function Yt(e3, t, n = true) {
  const i2 = [e3.localParticipant, ...Array.from(e3.remoteParticipants.values())], o = [];
  return i2.forEach((s2) => {
    t.forEach((a) => {
      const c = Array.from(
        s2.trackPublications.values()
      ).filter(
        (u) => u.source === a && // either return all or only the ones that are subscribed
        (!n || u.track)
      ).map((u) => ({
        participant: s2,
        publication: u,
        source: u.source
      }));
      o.push(...c);
    });
  }), { trackReferences: o, participants: i2 };
}
function qt(e3, t, n = false) {
  const { sources: r, kind: i2, name: o } = t;
  return Array.from(e3.trackPublications.values()).filter(
    (a) => (!r || r.includes(a.source)) && (!i2 || a.kind === i2) && (!o || a.trackName === o) && // either return all or only the ones that are subscribed
    (!n || a.track)
  ).map((a) => ({
    participant: e3,
    publication: a,
    source: a.source
  }));
}
function qs(e3, t, n) {
  var r, i2;
  const o = (r = n.additionalRoomEvents) != null ? r : An, s2 = (i2 = n.onlySubscribed) != null ? i2 : true, a = Array.from(
    (/* @__PURE__ */ new Set([
      RoomEvent.ParticipantConnected,
      RoomEvent.ParticipantDisconnected,
      RoomEvent.ConnectionStateChanged,
      RoomEvent.LocalTrackPublished,
      RoomEvent.LocalTrackUnpublished,
      RoomEvent.TrackPublished,
      RoomEvent.TrackUnpublished,
      RoomEvent.TrackSubscriptionStatusChanged,
      ...o
    ])).values()
  );
  return pe(e3, ...a).pipe(
    A((u) => {
      const l = Yt(u, t, s2);
      return L.debug(`TrackReference[] was updated. (length ${l.trackReferences.length})`, l), l;
    }),
    D(Yt(e3, t, s2))
  );
}
function Ks(e3, t) {
  return xe(e3, ...co).pipe(
    A((r) => {
      const i2 = qt(r, t);
      return L.debug(`TrackReference[] was updated. (length ${i2.length})`, i2), i2;
    }),
    D(qt(e3, t))
  );
}
function Nn(e3, t) {
  return new k((r) => {
    const i2 = (...s2) => {
      r.next(s2);
    };
    return e3.on(t, i2), () => {
      e3.off(t, i2);
    };
  });
}
function Gs(e3) {
  return Nn(e3, TrackEvent.TranscriptionReceived);
}
function Qs(e3) {
  return Nn(e3, TrackEvent.TimeSyncUpdate).pipe(
    A(([t]) => t)
  );
}
function Js(e3, t = 1e3) {
  if (e3 === null) return Ft(false);
  const n = ut(e3, "mousemove", { passive: true }).pipe(A(() => true)), r = n.pipe(
    Li({
      each: t,
      with: () => je(Ft(false), r.pipe(Gi(n)))
    }),
    Yi()
  );
  return r;
}
function Uo(e3, t) {
  if (typeof localStorage > "u") {
    L.error("Local storage is not available.");
    return;
  }
  try {
    if (t) {
      const n = Object.fromEntries(
        Object.entries(t).filter(([, r]) => r !== "")
      );
      localStorage.setItem(e3, JSON.stringify(n));
    }
  } catch (n) {
    L.error(`Error setting item to local storage: ${n}`);
  }
}
function Wo(e3) {
  if (typeof localStorage > "u") {
    L.error("Local storage is not available.");
    return;
  }
  try {
    const t = localStorage.getItem(e3);
    if (!t) {
      L.warn(`Item with key ${e3} does not exist in local storage.`);
      return;
    }
    return JSON.parse(t);
  } catch (t) {
    L.error(`Error getting item from local storage: ${t}`);
    return;
  }
}
function jo(e3) {
  return {
    load: () => Wo(e3),
    save: (t) => Uo(e3, t)
  };
}
var Bo = `${On}-user-choices`;
var Ee = {
  videoEnabled: true,
  audioEnabled: true,
  videoDeviceId: "default",
  audioDeviceId: "default",
  username: ""
};
var { load: Vo, save: Ho } = jo(Bo);
function Xs(e3, t = false) {
  t !== true && Ho(e3);
}
function Zs(e3, t = false) {
  var n, r, i2, o, s2;
  const a = {
    videoEnabled: (n = e3 == null ? void 0 : e3.videoEnabled) != null ? n : Ee.videoEnabled,
    audioEnabled: (r = e3 == null ? void 0 : e3.audioEnabled) != null ? r : Ee.audioEnabled,
    videoDeviceId: (i2 = e3 == null ? void 0 : e3.videoDeviceId) != null ? i2 : Ee.videoDeviceId,
    audioDeviceId: (o = e3 == null ? void 0 : e3.audioDeviceId) != null ? o : Ee.audioDeviceId,
    username: (s2 = e3 == null ? void 0 : e3.username) != null ? s2 : Ee.username
  };
  if (t)
    return a;
  {
    const c = Vo();
    return q(q({}, a), c ?? {});
  }
}
var it = null;
var ot = null;
var zo = 0;
function Kt() {
  return it || (it = /* @__PURE__ */ new Map()), it;
}
function Yo() {
  return ot || (ot = /* @__PURE__ */ new WeakMap()), ot;
}
function qo(e3, t) {
  const n = Yo();
  let r = n.get(e3);
  return r || (r = `room_${zo++}`, n.set(e3, r)), `${r}:${t}`;
}
function ea(e3, t) {
  const n = qo(e3, t), r = Kt(), i2 = r.get(n);
  if (i2)
    return i2;
  const o = new te();
  let s2 = [];
  const a = "lk.segment_id", c = o.pipe(
    Qi({
      subscribe: () => {
        e3.registerTextStreamHandler(t, (u, l) => H(this, null, function* () {
          var f;
          const v = Je(u).pipe(
            lt((m, p) => m + p, "")
          ), d = !!((f = u.info.attributes) != null && f[a]);
          v.subscribe((m) => {
            const p = s2.findIndex(
              (g) => {
                var h, x2;
                return g.streamInfo.id === u.info.id || d && ((h = g.streamInfo.attributes) == null ? void 0 : h[a]) === ((x2 = u.info.attributes) == null ? void 0 : x2[a]);
              }
            );
            p !== -1 ? (s2[p] = ce(q({}, s2[p]), {
              text: m
            }), o.next([...s2])) : (s2.push({
              text: m,
              participantInfo: l,
              streamInfo: u.info
            }), o.next([...s2]));
          });
        }));
      },
      finalize: () => {
        e3.unregisterTextStreamHandler(t);
      }
    }),
    Ki()
  );
  return r.set(n, c), e3.on(RoomEvent.Disconnected, () => {
    Kt().delete(n), s2 = [], o.next([]);
  }), c;
}
function Fn(e3, t) {
  if (t.msg === "show_chat")
    return { ...e3, showChat: true, unreadMessages: 0 };
  if (t.msg === "hide_chat")
    return { ...e3, showChat: false };
  if (t.msg === "toggle_chat") {
    const n = { ...e3, showChat: !e3.showChat };
    return n.showChat === true && (n.unreadMessages = 0), n;
  } else return t.msg === "unread_msg" ? { ...e3, unreadMessages: t.count } : t.msg === "toggle_settings" ? { ...e3, showSettings: !e3.showSettings } : { ...e3 };
}
function Un(e3, t) {
  return t.msg === "set_pin" ? [t.trackReference] : t.msg === "clear_pin" ? [] : { ...e3 };
}
var Wn = I.createContext(void 0);
function ta() {
  const e3 = I.useContext(Wn);
  if (!e3)
    throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");
  return e3;
}
function na(e3) {
  const t = Ko();
  if (e3 ?? (e3 = t), !e3)
    throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");
  return e3;
}
function ra() {
  const [e3, t] = I.useReducer(Un, _n), [n, r] = I.useReducer(Fn, Ln);
  return {
    pin: { dispatch: t, state: e3 },
    widget: { dispatch: r, state: n }
  };
}
function ia(e3) {
  const [t, n] = I.useReducer(Un, _n), [r, i2] = I.useReducer(Fn, Ln);
  return e3 ?? {
    pin: { dispatch: n, state: t },
    widget: { dispatch: i2, state: r }
  };
}
function Ko() {
  return I.useContext(Wn);
}
var jn = I.createContext(
  void 0
);
function oa() {
  const e3 = I.useContext(jn);
  if (!e3)
    throw Error("tried to access track context outside of track context provider");
  return e3;
}
function Bn() {
  return I.useContext(jn);
}
function sa(e3) {
  const t = Bn(), n = e3 ?? t;
  if (!n)
    throw new Error(
      "No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly"
    );
  return n;
}
var Vn = I.createContext(void 0);
function aa() {
  const e3 = I.useContext(Vn);
  if (!e3)
    throw Error("tried to access participant context outside of participant context provider");
  return e3;
}
function Go() {
  return I.useContext(Vn);
}
function ca(e3) {
  const t = Go(), n = Bn(), r = e3 ?? t ?? (n == null ? void 0 : n.participant);
  if (!r)
    throw new Error(
      "No participant provided, make sure you are inside a participant context or pass the participant explicitly"
    );
  return r;
}
var Hn = I.createContext(void 0);
function ua() {
  const e3 = I.useContext(Hn);
  if (!e3)
    throw Error("tried to access room context outside of livekit room component");
  return e3;
}
function Qo() {
  return I.useContext(Hn);
}
function la(e3) {
  const t = Qo(), n = e3 ?? t;
  if (!n)
    throw new Error(
      "No room provided, make sure you are inside a Room context or pass the room explicitly"
    );
  return n;
}
var zn = I.createContext(void 0);
function fa() {
  const e3 = I.useContext(zn);
  if (!e3)
    throw Error("tried to access session context outside of SessionProvider component");
  return e3;
}
function Jo() {
  return I.useContext(zn);
}
function da(e3) {
  const t = Jo(), n = e3 ?? t;
  if (!n)
    throw new Error(
      "No session provided, make sure you are inside a Session context or pass the session explicitly"
    );
  return n;
}
var Xo = I.createContext(void 0);
function pa(e3) {
  const t = I.useContext(Xo);
  if (e3 === true) {
    if (t)
      return t;
    throw Error("tried to access feature context, but none is present");
  }
  return t;
}

// node_modules/@livekit/components-react/dist/room-Bb6uLxS5.mjs
var i = __toESM(require_react(), 1);
function L2(n) {
  var e3, o, t = "";
  if (typeof n == "string" || typeof n == "number") t += n;
  else if (typeof n == "object") if (Array.isArray(n)) {
    var r = n.length;
    for (e3 = 0; e3 < r; e3++) n[e3] && (o = L2(n[e3])) && (t && (t += " "), t += o);
  } else for (o in n) n[o] && (t && (t += " "), t += o);
  return t;
}
function A2() {
  for (var n, e3, o = 0, t = "", r = arguments.length; o < r; o++) (n = arguments[o]) && (e3 = L2(n)) && (t && (t += " "), t += e3);
  return t;
}
function I2(...n) {
  return (...e3) => {
    for (const o of n)
      if (typeof o == "function")
        try {
          o(...e3);
        } catch (t) {
          console.error(t);
        }
  };
}
function M(...n) {
  const e3 = { ...n[0] };
  for (let o = 1; o < n.length; o++) {
    const t = n[o];
    for (const r in t) {
      const d = e3[r], a = t[r];
      typeof d == "function" && typeof a == "function" && // This is a lot faster than a regex.
      r[0] === "o" && r[1] === "n" && r.charCodeAt(2) >= /* 'A' */
      65 && r.charCodeAt(2) <= /* 'Z' */
      90 ? e3[r] = I2(d, a) : (r === "className" || r === "UNSAFE_className") && typeof d == "string" && typeof a == "string" ? e3[r] = A2(d, a) : e3[r] = a !== void 0 ? a : d;
    }
  }
  return e3;
}
function J2(n) {
  return n !== void 0;
}
function G2(...n) {
  return M(...n.filter(J2));
}
function H2(n, e3, o) {
  return i.Children.map(n, (t) => i.isValidElement(t) && i.Children.only(n) ? (t.props.className && (e3 ?? (e3 = {}), e3.className = A2(t.props.className, e3.className), e3.style = { ...t.props.style, ...e3.style }), i.cloneElement(t, { ...e3, key: o })) : t);
}
function Q(n) {
  var e3, o;
  if (typeof window < "u" && typeof process < "u" && // eslint-disable-next-line turbo/no-undeclared-env-vars
  (((e3 = process == null ? void 0 : process.env) == null ? void 0 : e3.NODE_ENV) === "dev" || // eslint-disable-next-line turbo/no-undeclared-env-vars
  ((o = process == null ? void 0 : process.env) == null ? void 0 : o.NODE_ENV) === "development")) {
    const t = document.querySelector(".lk-room-container");
    t && !getComputedStyle(t).getPropertyValue("--lk-has-imported-styles") && L.warn(
      "It looks like you're not using the `@livekit/components-styles package`. To render the UI with the default styling, please import it in your layout or page."
    );
  }
}
function T(n, e3) {
  return n === "processor" && e3 && typeof e3 == "object" && "name" in e3 ? e3.name : n === "e2ee" && e3 ? "e2ee-enabled" : e3;
}
var q2 = {
  connect: true,
  audio: false,
  video: false
};
function $(n) {
  const {
    token: e3,
    serverUrl: o,
    options: t,
    room: r,
    connectOptions: d,
    connect: a,
    audio: p,
    video: y,
    screen: g,
    onConnected: v,
    onDisconnected: h,
    onError: c,
    onMediaDeviceFailure: b,
    onEncryptionError: E,
    simulateParticipants: w,
    ...N2
  } = { ...q2, ...n };
  t && r && L.warn(
    "when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead."
  );
  const [s2, O2] = i.useState(), C = i.useRef(a);
  i.useEffect(() => {
    O2(r ?? new Room(t));
  }, [r, JSON.stringify(t, T)]);
  const F2 = i.useMemo(() => {
    const { className: m } = Ys();
    return M(N2, { className: m });
  }, [N2]);
  return i.useEffect(() => {
    if (!s2) return;
    const m = () => {
      const f = s2.localParticipant;
      L.debug("trying to publish local tracks"), Promise.all([
        f.setMicrophoneEnabled(!!p, typeof p != "boolean" ? p : void 0),
        f.setCameraEnabled(!!y, typeof y != "boolean" ? y : void 0),
        f.setScreenShareEnabled(!!g, typeof g != "boolean" ? g : void 0)
      ]).catch((R) => {
        L.warn(R), c == null || c(R);
      });
    }, P2 = (f, R) => {
      const K3 = MediaDeviceFailure.getFailure(f);
      b == null || b(K3, R);
    }, S = (f) => {
      E == null || E(f);
    }, k2 = (f) => {
      h == null || h(f);
    }, D3 = () => {
      v == null || v();
    };
    return s2.on(RoomEvent.SignalConnected, m).on(RoomEvent.MediaDevicesError, P2).on(RoomEvent.EncryptionError, S).on(RoomEvent.Disconnected, k2).on(RoomEvent.Connected, D3), () => {
      s2.off(RoomEvent.SignalConnected, m).off(RoomEvent.MediaDevicesError, P2).off(RoomEvent.EncryptionError, S).off(RoomEvent.Disconnected, k2).off(RoomEvent.Connected, D3);
    };
  }, [
    s2,
    p,
    y,
    g,
    c,
    E,
    b,
    v,
    h
  ]), i.useEffect(() => {
    if (s2) {
      if (w) {
        s2.simulateParticipants({
          participants: {
            count: w
          },
          publish: {
            audio: true,
            useRealTracks: true
          }
        });
        return;
      }
      if (a) {
        if (C.current = true, L.debug("connecting"), !e3) {
          L.debug("no token yet");
          return;
        }
        if (!o) {
          L.warn("no livekit url provided"), c == null || c(Error("no livekit url provided"));
          return;
        }
        s2.connect(o, e3, d).catch((m) => {
          L.warn(m), C.current === true && (c == null || c(m));
        });
      } else
        L.debug("disconnecting because connect is false"), C.current = false, s2.disconnect();
    }
  }, [
    a,
    e3,
    JSON.stringify(d),
    s2,
    c,
    o,
    w
  ]), i.useEffect(() => {
    if (s2)
      return () => {
        L.info("disconnecting on onmount"), s2.disconnect();
      };
  }, [s2]), { room: s2, htmlProps: F2 };
}
var W2 = i.forwardRef(function(e3, o) {
  const { room: t, htmlProps: r } = $(e3);
  return i.createElement("div", { ref: o, ...r }, t && i.createElement(Hn.Provider, { value: t }, i.createElement(Xo.Provider, { value: e3.featureFlags }, e3.children)));
});

// node_modules/@livekit/components-react/dist/hooks-yU-srrIO.mjs
var xt2 = (e3) => {
  const n = s.useRef(e3);
  return s.useEffect(() => {
    n.current = e3;
  }), n;
};
function Ut2(e3, n) {
  const t = Vt2(), r = xt2(n);
  return s.useLayoutEffect(() => {
    let o = false;
    const c = e3.current;
    if (!c) return;
    function a(i2, u) {
      o || r.current(i2, u);
    }
    return t == null || t.subscribe(c, a), () => {
      o = true, t == null || t.unsubscribe(c, a);
    };
  }, [e3.current, t, r]), t == null ? void 0 : t.observer;
}
function Ht2() {
  let e3 = false, n = [];
  const t = /* @__PURE__ */ new Map();
  if (typeof window > "u")
    return;
  const r = new ResizeObserver((o, c) => {
    n = n.concat(o), e3 || window.requestAnimationFrame(() => {
      const a = /* @__PURE__ */ new Set();
      for (let i2 = 0; i2 < n.length; i2++) {
        if (a.has(n[i2].target)) continue;
        a.add(n[i2].target);
        const u = t.get(n[i2].target);
        u == null || u.forEach((p) => p(n[i2], c));
      }
      n = [], e3 = false;
    }), e3 = true;
  });
  return {
    observer: r,
    subscribe(o, c) {
      r.observe(o);
      const a = t.get(o) ?? [];
      a.push(c), t.set(o, a);
    },
    unsubscribe(o, c) {
      const a = t.get(o) ?? [];
      if (a.length === 1) {
        r.unobserve(o), t.delete(o);
        return;
      }
      const i2 = a.indexOf(c);
      i2 !== -1 && a.splice(i2, 1), t.set(o, a);
    }
  };
}
var ce2;
var Vt2 = () => ce2 || (ce2 = Ht2());
var qt2 = (e3) => {
  const [n, t] = s.useState({ width: 0, height: 0 });
  s.useLayoutEffect(() => {
    if (e3.current) {
      const { width: o, height: c } = e3.current.getBoundingClientRect();
      t({ width: o, height: c });
    }
  }, [e3.current]);
  const r = s.useCallback(
    (o) => t(o.contentRect),
    []
  );
  return Ut2(e3, r), n;
};
function D2(e3, n, t = true) {
  const [r, o] = s.useState(n);
  return s.useEffect(() => {
    if (t && o(n), typeof window > "u" || !e3) return;
    const c = e3.subscribe(o);
    return () => c.unsubscribe();
  }, [e3, t]), r;
}
function kn2(e3) {
  const n = (c) => typeof window < "u" ? window.matchMedia(c).matches : false, [t, r] = s.useState(n(e3));
  function o() {
    r(n(e3));
  }
  return s.useEffect(() => {
    const c = window.matchMedia(e3);
    return o(), c.addListener ? c.addListener(o) : c.addEventListener("change", o), () => {
      c.removeListener ? c.removeListener(o) : c.removeEventListener("change", o);
    };
  }, [e3]), t;
}
function wn2(e3) {
  const n = la(e3), t = s.useCallback(async () => {
    await n.startAudio();
  }, [n]), r = s.useMemo(
    () => Oo(n),
    [n]
  ), { canPlayAudio: o } = D2(r, {
    canPlayAudio: n.canPlaybackAudio
  });
  return { canPlayAudio: o, startAudio: t };
}
function Pn2(e3) {
  const { state: n, dispatch: t } = ta().pin;
  return { buttonProps: s.useMemo(() => {
    const { className: o } = zs();
    return M(e3, {
      className: o,
      disabled: !(n != null && n.length),
      onClick: () => {
        t && t({ msg: "clear_pin" });
      }
    });
  }, [e3, t, n]) };
}
function Ln2(e3 = {}) {
  const n = ca(e3.participant), { className: t, connectionQualityObserver: r } = s.useMemo(
    () => $s(n),
    [n]
  ), o = D2(r, n.connectionQuality);
  return { className: t, quality: o };
}
function te2(e3) {
  const n = la(e3), t = s.useMemo(() => ws(n), [n]);
  return D2(t, n.state);
}
function An2(e3, n) {
  const t = typeof e3 == "function" ? e3 : n, r = typeof e3 == "string" ? e3 : void 0, o = ua(), { send: c, messageObservable: a, isSendingObservable: i2 } = s.useMemo(
    () => Do(o, r, t),
    [o, r, t]
  ), u = D2(a, void 0), p = D2(i2, false);
  return {
    message: u,
    send: c,
    isSending: p
  };
}
function Rn2(e3) {
  const n = ua(), t = te2(n);
  return { buttonProps: s.useMemo(() => {
    const { className: o, disconnect: c } = Ds(n);
    return M(e3, {
      className: o,
      onClick: () => c(e3.stopTracks ?? true),
      disabled: t === ConnectionState.Disconnected
    });
  }, [n, e3, t]) };
}
function Bt2(e3) {
  if (e3.publication instanceof LocalTrackPublication) {
    const n = e3.publication.track;
    if (n) {
      const { facingMode: t } = facingModeFromLocalTrack(n);
      return t;
    }
  }
  return "undefined";
}
function Dn2({ trackRef: e3, props: n }) {
  const t = sa(e3), r = Ko(), { className: o } = s.useMemo(() => Hs(), []), c = s.useMemo(() => ns(t, r == null ? void 0 : r.pin.state), [t, r == null ? void 0 : r.pin.state]);
  return { mergedProps: s.useMemo(
    () => M(n, {
      className: o,
      onClick: (i2) => {
        var u, p, h, d, l;
        (u = n.onClick) == null || u.call(n, i2), c ? (h = r == null ? void 0 : (p = r.pin).dispatch) == null || h.call(p, {
          msg: "clear_pin"
        }) : (l = r == null ? void 0 : (d = r.pin).dispatch) == null || l.call(d, {
          msg: "set_pin",
          trackReference: t
        });
      }
    }),
    [n, o, t, c, r == null ? void 0 : r.pin]
  ), inFocus: c };
}
function On2(e3, n, t = {}) {
  const r = t.gridLayouts ?? fs, { width: o, height: c } = qt2(e3), a = lo(r, n, o, c);
  return s.useEffect(() => {
    e3.current && a && (e3.current.style.setProperty("--lk-col-count", a == null ? void 0 : a.columns.toString()), e3.current.style.setProperty("--lk-row-count", a == null ? void 0 : a.rows.toString()));
  }, [e3, a]), {
    layout: a,
    containerWidth: o,
    containerHeight: c
  };
}
function Se(e3, n = {}) {
  var i2, u;
  const t = typeof e3 == "string" ? n.participant : e3.participant, r = ca(t), o = typeof e3 == "string" ? { participant: r, source: e3 } : e3, [c, a] = s.useState(
    !!((i2 = o.publication) != null && i2.isMuted || (u = r.getTrackPublication(o.source)) != null && u.isMuted)
  );
  return s.useEffect(() => {
    const p = Io(o).subscribe(a);
    return () => p.unsubscribe();
  }, [N(o)]), c;
}
function jt2(e3) {
  const n = ca(e3), t = s.useMemo(() => Ps(n), [n]);
  return D2(t, n.isSpeaking);
}
function Oe2(e3 = {}) {
  const n = la(e3.room), [t, r] = s.useState(n.localParticipant), [o, c] = s.useState(
    t.isMicrophoneEnabled
  ), [a, i2] = s.useState(t.isCameraEnabled), [u, p] = s.useState(
    t.isScreenShareEnabled
  ), [h, d] = s.useState(
    t.lastMicrophoneError
  ), [l, v] = s.useState(t.lastCameraError), [C, k2] = s.useState(
    void 0
  ), [A3, w] = s.useState(void 0), O2 = (R) => {
    i2(R.isCameraEnabled), c(R.isMicrophoneEnabled), p(R.isScreenShareEnabled), w(R.cameraTrack), k2(R.microphoneTrack), d(R.participant.lastMicrophoneError), v(R.participant.lastCameraError), r(R.participant);
  };
  return s.useEffect(() => {
    const R = Dn(n.localParticipant).subscribe(O2);
    return () => R.unsubscribe();
  }, [n]), {
    isMicrophoneEnabled: o,
    isScreenShareEnabled: u,
    isCameraEnabled: a,
    microphoneTrack: C,
    cameraTrack: A3,
    lastMicrophoneError: h,
    lastCameraError: l,
    localParticipant: t
  };
}
function In2() {
  const e3 = ua(), n = s.useMemo(
    () => ks(e3.localParticipant),
    [e3]
  );
  return D2(n, e3.localParticipant.permissions);
}
function Nn2({
  kind: e3,
  room: n,
  track: t,
  requestPermissions: r,
  onError: o
}) {
  const c = Qo(), a = s.useMemo(() => n ?? c ?? new Room(), [n, c]), i2 = s.useMemo(
    () => Ts(e3, o, r),
    [e3, r, o]
  ), u = D2(i2, []), [p, h] = s.useState(
    (a == null ? void 0 : a.getActiveDevice(e3)) ?? "default"
  ), { className: d, activeDeviceObservable: l, setActiveMediaDevice: v } = s.useMemo(
    () => Rs(e3, a),
    [e3, a, t]
  );
  return s.useEffect(() => {
    const C = l.subscribe((k2) => {
      k2 && (L.info("setCurrentDeviceId", k2), h(k2));
    });
    return () => {
      C == null || C.unsubscribe();
    };
  }, [l]), { devices: u, className: d, activeDeviceId: p, setActiveMediaDevice: v };
}
function _n2({
  kind: e3,
  onError: n
}) {
  const t = s.useMemo(
    () => Ts(e3, n),
    [e3, n]
  );
  return D2(t, []);
}
function zt2(e3, n, t = {}) {
  const r = s.useRef([]), o = s.useRef(-1), c = n !== o.current, a = typeof t.customSortFunction == "function" ? t.customSortFunction(e3) : ms(e3);
  let i2 = [...a];
  if (c === false)
    try {
      i2 = bs(r.current, a, n);
    } catch (u) {
      L.error("Error while running updatePages(): ", u);
    }
  return c ? r.current = a : r.current = i2, o.current = n, i2;
}
function Fn2(e3, n) {
  const [t, r] = s.useState(1), o = Math.max(Math.ceil(n.length / e3), 1);
  t > o && r(o);
  const c = t * e3, a = c - e3, i2 = (d) => {
    r((l) => d === "next" ? l === o ? l : l + 1 : l === 1 ? l : l - 1);
  }, u = (d) => {
    d > o ? r(o) : d < 1 ? r(1) : r(d);
  }, h = zt2(n, e3).slice(a, c);
  return {
    totalPageCount: o,
    nextPage: () => i2("next"),
    prevPage: () => i2("previous"),
    setPage: u,
    firstItemIndex: a,
    lastItemIndex: c,
    tracks: h,
    currentPage: t
  };
}
function xn2(e3 = {}) {
  let n = Go();
  e3.participant && (n = e3.participant);
  const t = s.useMemo(() => _o(n), [n]), { identity: r, name: o, metadata: c } = D2(t, {
    name: n == null ? void 0 : n.name,
    identity: n == null ? void 0 : n.identity,
    metadata: n == null ? void 0 : n.metadata
  });
  return { identity: r, name: o, metadata: c };
}
function Un2(e3 = {}) {
  const n = ca(e3.participant), t = s.useMemo(() => ks(n), [n]);
  return D2(t, n.permissions);
}
function Hn2({
  trackRef: e3,
  onParticipantClick: n,
  disableSpeakingIndicator: t,
  htmlProps: r
}) {
  const o = sa(e3), c = s.useMemo(() => {
    const { className: l } = Us();
    return M(r, {
      className: l,
      onClick: (v) => {
        var C;
        if ((C = r.onClick) == null || C.call(r, v), typeof n == "function") {
          const k2 = o.publication ?? o.participant.getTrackPublication(o.source);
          n({ participant: o.participant, track: k2 });
        }
      }
    });
  }, [
    r,
    n,
    o.publication,
    o.source,
    o.participant
  ]), a = o.participant.getTrackPublication(Track.Source.Microphone), i2 = s.useMemo(() => ({
    participant: o.participant,
    source: Track.Source.Microphone,
    publication: a
  }), [a, o.participant]), u = Se(o), p = Se(i2), h = jt2(o.participant), d = Bt2(o);
  return {
    elementProps: {
      "data-lk-audio-muted": p,
      "data-lk-video-muted": u,
      "data-lk-speaking": t === true ? false : h,
      "data-lk-local-participant": o.participant.isLocal,
      "data-lk-source": o.source,
      "data-lk-facing-mode": d,
      ...c
    }
  };
}
function pe2(e3 = {}) {
  const n = la(e3.room), [t, r] = s.useState([]);
  return s.useEffect(() => {
    const o = Os(n, {
      additionalRoomEvents: e3.updateOnlyOn
    }).subscribe(r);
    return () => o.unsubscribe();
  }, [n, JSON.stringify(e3.updateOnlyOn)]), t;
}
function Wt2(e3 = {}) {
  const n = pe2(e3), { localParticipant: t } = Oe2(e3);
  return s.useMemo(
    () => [t, ...n],
    [t, n]
  );
}
function Vn2(e3) {
  return e3 = na(e3), s.useMemo(() => (e3 == null ? void 0 : e3.pin.state) !== void 0 && e3.pin.state.length >= 1 ? e3.pin.state : [], [e3.pin.state]);
}
function qn(e3, n = {}) {
  const t = ua(), [r] = s.useState(n.updateOnlyOn), o = s.useMemo(() => typeof e3 == "string" ? As(t, e3, {
    additionalEvents: r
  }) : _s(t, e3, {
    additionalEvents: r
  }), [t, JSON.stringify(e3), r]), [c, a] = s.useState({
    p: void 0
  });
  return s.useEffect(() => {
    const i2 = o.subscribe((u) => a({ p: u }));
    return () => i2.unsubscribe();
  }, [o]), c.p;
}
function Bn2(e3 = {}) {
  const n = la(e3.room), t = s.useMemo(() => xs(n), [n]), { name: r, metadata: o } = D2(t, {
    name: n.name,
    metadata: n.metadata
  });
  return { name: r, metadata: o };
}
function Gt(e3) {
  const n = la(e3 == null ? void 0 : e3.room), t = s.useMemo(() => Ss(n), [n]);
  return D2(t, n.activeSpeakers);
}
function jn2(e3) {
  const [n, t] = s.useState(
    gs(e3)
  ), r = Gt();
  return s.useEffect(() => {
    t(gs(e3));
  }, [r, e3]), n;
}
function zn2({ room: e3, props: n }) {
  const t = la(e3), { className: r, roomAudioPlaybackAllowedObservable: o, handleStartAudioPlayback: c } = s.useMemo(
    () => js(),
    []
  ), a = s.useMemo(
    () => o(t),
    [t, o]
  ), { canPlayAudio: i2 } = D2(a, {
    canPlayAudio: t.canPlaybackAudio
  });
  return { mergedProps: s.useMemo(
    () => M(n, {
      className: r,
      onClick: () => {
        c(t);
      },
      style: { display: i2 ? "none" : "block" }
    }),
    [n, r, i2, c, t]
  ), canPlayAudio: i2 };
}
function Wn2({ room: e3, props: n }) {
  const t = la(e3), { className: r, roomVideoPlaybackAllowedObservable: o, handleStartVideoPlayback: c } = s.useMemo(
    () => Bs(),
    []
  ), a = s.useMemo(
    () => o(t),
    [t, o]
  ), { canPlayVideo: i2 } = D2(a, {
    canPlayVideo: t.canPlaybackVideo
  });
  return { mergedProps: s.useMemo(
    () => M(n, {
      className: r,
      onClick: () => {
        c(t);
      },
      style: { display: i2 ? "none" : "block" }
    }),
    [n, r, i2, c, t]
  ), canPlayVideo: i2 };
}
function Gn(e3, n = {}) {
  const t = s.useRef(null), r = s.useRef(null), o = n.minSwipeDistance ?? 50, c = (u) => {
    r.current = null, t.current = u.targetTouches[0].clientX;
  }, a = (u) => {
    r.current = u.targetTouches[0].clientX;
  }, i2 = s.useCallback(() => {
    if (!t.current || !r.current)
      return;
    const u = t.current - r.current, p = u > o, h = u < -o;
    p && n.onLeftSwipe && n.onLeftSwipe(), h && n.onRightSwipe && n.onRightSwipe();
  }, [o, n]);
  s.useEffect(() => {
    const u = e3.current;
    return u && (u.addEventListener("touchstart", c, { passive: true }), u.addEventListener("touchmove", a, { passive: true }), u.addEventListener("touchend", i2, { passive: true })), () => {
      u && (u.removeEventListener("touchstart", c), u.removeEventListener("touchmove", a), u.removeEventListener("touchend", i2));
    };
  }, [e3, i2]);
}
function Jn2({ props: e3 }) {
  const { dispatch: n, state: t } = ta().widget, { className: r } = s.useMemo(() => Vs(), []);
  return { mergedProps: s.useMemo(() => M(e3, {
    className: r,
    onClick: () => {
      n && n({ msg: "toggle_chat" });
    },
    "aria-pressed": t != null && t.showChat ? "true" : "false",
    "data-lk-unread-msgs": t ? t.unreadMessages < 10 ? t.unreadMessages.toFixed(0) : "9+" : "0"
  }), [e3, r, n, t]) };
}
function $n2(e3, n, t = {}) {
  const [r, o] = s.useState(void 0);
  return s.useEffect(() => {
    var a;
    if (e3 === void 0)
      throw Error("token endpoint needs to be defined");
    if (((a = t.userInfo) == null ? void 0 : a.identity) === void 0)
      return;
    (async () => {
      L.debug("fetching token");
      const i2 = new URLSearchParams({ ...t.userInfo, roomName: n }), u = await fetch(`${e3}?${i2.toString()}`);
      if (!u.ok) {
        L.error(
          `Could not fetch token. Server responded with status ${u.status}: ${u.statusText}`
        );
        return;
      }
      const { accessToken: p } = await u.json();
      o(p);
    })();
  }, [e3, n, JSON.stringify(t)]), r;
}
function Qn(e3) {
  var c, a;
  const n = sa(e3), { className: t, mediaMutedObserver: r } = s.useMemo(
    () => Ns(n),
    [N(n)]
  );
  return { isMuted: D2(
    r,
    !!((c = n.publication) != null && c.isMuted || (a = n.participant.getTrackPublication(n.source)) != null && a.isMuted)
  ), className: t };
}
function Kn({
  source: e3,
  onChange: n,
  initialState: t,
  captureOptions: r,
  publishOptions: o,
  onDeviceError: c,
  room: a,
  ...i2
}) {
  var m;
  const u = Qo(), p = s.useMemo(() => a ?? u, [a, u]), h = (m = p == null ? void 0 : p.localParticipant) == null ? void 0 : m.getTrackPublication(e3), d = s.useRef(false), { toggle: l, className: v, pendingObserver: C, enabledObserver: k2 } = s.useMemo(
    () => p ? Is(e3, p, r, o, c) : Ms(),
    [p, e3, JSON.stringify(r), o]
  ), A3 = D2(C, false), w = D2(k2, t ?? !!(h != null && h.isEnabled));
  s.useEffect(() => {
    n == null || n(w, d.current), d.current = false;
  }, [w, n]), s.useEffect(() => {
    t !== void 0 && (L.debug("forcing initial toggle state", e3, t), l(t));
  }, []);
  const O2 = s.useMemo(() => M(i2, { className: v }), [i2, v]), R = s.useCallback(
    (f) => {
      var b;
      d.current = true, l().catch(() => d.current = false), (b = i2.onClick) == null || b.call(i2, f);
    },
    [i2, l]
  );
  return {
    toggle: l,
    enabled: w,
    pending: A3,
    track: h,
    buttonProps: {
      ...O2,
      "aria-pressed": w,
      "data-lk-source": e3,
      "data-lk-enabled": w,
      disabled: A3,
      onClick: R
    }
  };
}
function Yn(e3 = [
  Track.Source.Camera,
  Track.Source.Microphone,
  Track.Source.ScreenShare,
  Track.Source.ScreenShareAudio,
  Track.Source.Unknown
], n = {}) {
  const t = la(n.room), [r, o] = s.useState([]), [c, a] = s.useState([]), i2 = s.useMemo(() => e3.map((p) => ho(p) ? p.source : p), [JSON.stringify(e3)]);
  return s.useEffect(() => {
    const p = qs(t, i2, {
      additionalRoomEvents: n.updateOnlyOn,
      onlySubscribed: n.onlySubscribed
    }).subscribe(({ trackReferences: h, participants: d }) => {
      L.debug("setting track bundles", h, d), o(h), a(d);
    });
    return () => p.unsubscribe();
  }, [
    t,
    JSON.stringify(n.onlySubscribed),
    JSON.stringify(n.updateOnlyOn),
    JSON.stringify(e3)
  ]), s.useMemo(() => {
    if (vs(e3)) {
      const p = $t2(e3, c), h = Array.from(r);
      return c.forEach((d) => {
        p.has(d.identity) && (p.get(d.identity) ?? []).forEach((v) => {
          if (r.find(
            ({ participant: k2, publication: A3 }) => d.identity === k2.identity && A3.source === v
          ))
            return;
          L.debug(
            `Add ${v} placeholder for participant ${d.identity}.`
          );
          const C = {
            participant: d,
            source: v
          };
          h.push(C);
        });
      }), h;
    } else
      return r;
  }, [r, c, e3]);
}
function Jt2(e3, n) {
  const t = new Set(e3);
  for (const r of n)
    t.delete(r);
  return t;
}
function $t2(e3, n) {
  const t = /* @__PURE__ */ new Map();
  if (vs(e3)) {
    const r = e3.filter((o) => o.withPlaceholder).map((o) => o.source);
    n.forEach((o) => {
      const c = o.getTrackPublications().map((i2) => {
        var u;
        return (u = i2.track) == null ? void 0 : u.source;
      }).filter((i2) => i2 !== void 0), a = Array.from(
        Jt2(new Set(r), new Set(c))
      );
      a.length > 0 && t.set(o.identity, a);
    });
  }
  return t;
}
function Qt2(e3) {
  const [n, t] = s.useState(zt(e3)), { trackObserver: r } = s.useMemo(() => ys(e3), [e3.participant.sid ?? e3.participant.identity, e3.source]);
  return s.useEffect(() => {
    const o = r.subscribe((c) => {
      t(c);
    });
    return () => o == null ? void 0 : o.unsubscribe();
  }, [r]), {
    participant: e3.participant,
    source: e3.source ?? Track.Source.Unknown,
    publication: n
  };
}
function Xn2(e3, n) {
  const t = ca(n);
  return Qt2({ name: e3, participant: t });
}
function Kt2(e3) {
  const n = la(e3 == null ? void 0 : e3.room), t = te2(n), r = s.useMemo(
    () => t === ConnectionState.Disconnected,
    [t]
  ), o = s.useMemo(
    () => Ws(n, e3),
    [n, e3, r]
  ), c = D2(o.isSendingObservable, false), a = D2(o.messageObservable, []);
  return { send: o.send, chatMessages: a, isSending: c };
}
function Zn2(e3 = {}) {
  const [n, t] = s.useState(
    Zs(e3.defaults, e3.preventLoad ?? false)
  ), r = s.useCallback((u) => {
    t((p) => ({ ...p, audioEnabled: u }));
  }, []), o = s.useCallback((u) => {
    t((p) => ({ ...p, videoEnabled: u }));
  }, []), c = s.useCallback((u) => {
    t((p) => ({ ...p, audioDeviceId: u }));
  }, []), a = s.useCallback((u) => {
    t((p) => ({ ...p, videoDeviceId: u }));
  }, []), i2 = s.useCallback((u) => {
    t((p) => ({ ...p, username: u }));
  }, []);
  return s.useEffect(() => {
    Xs(n, e3.preventSave ?? false);
  }, [n, e3.preventSave]), {
    userChoices: n,
    saveAudioInputEnabled: r,
    saveVideoInputEnabled: o,
    saveAudioInputDeviceId: c,
    saveVideoInputDeviceId: a,
    saveUsername: i2
  };
}
function es2(e3, n = {}) {
  const t = ca(e3), r = la(n.room), o = s.useMemo(() => Es(r, t), [r, t]);
  return D2(
    o,
    t.isLocal ? t.isE2EEEnabled : !!(t != null && t.isEncrypted)
  );
}
function ts2(e3, n = { fftSize: 32, smoothingTimeConstant: 0 }) {
  const t = B(e3) ? e3.publication.track : e3, [r, o] = s.useState(0);
  return s.useEffect(() => {
    if (!t || !t.mediaStream)
      return;
    const { cleanup: c, analyser: a } = createAudioAnalyser(t, n), i2 = a.frequencyBinCount, u = new Uint8Array(i2), h = setInterval(() => {
      a.getByteFrequencyData(u);
      let d = 0;
      for (let l = 0; l < u.length; l++) {
        const v = u[l];
        d += v * v;
      }
      o(Math.sqrt(d / u.length) / 255);
    }, 1e3 / 30);
    return () => {
      c(), clearInterval(h);
    };
  }, [t, t == null ? void 0 : t.mediaStream, JSON.stringify(n)]), r;
}
var Yt2 = (e3) => {
  const n = (t) => {
    let c = 1 - Math.max(-100, Math.min(-10, t)) * -1 / 100;
    return c = Math.sqrt(c), c;
  };
  return e3.map((t) => t === -1 / 0 ? 0 : n(t));
};
var Xt2 = {
  bands: 5,
  loPass: 100,
  hiPass: 600,
  updateInterval: 32,
  analyserOptions: { fftSize: 2048 }
};
function ns2(e3, n = {}) {
  var a;
  const t = e3 instanceof Track ? e3 : (a = e3 == null ? void 0 : e3.publication) == null ? void 0 : a.track, r = { ...Xt2, ...n }, [o, c] = s.useState(
    new Array(r.bands).fill(0)
  );
  return s.useEffect(() => {
    if (!t || !(t != null && t.mediaStream)) {
      c((v) => v.slice().fill(0));
      return;
    }
    const { analyser: i2, cleanup: u } = createAudioAnalyser(t, r.analyserOptions), p = i2.frequencyBinCount, h = new Float32Array(p), l = setInterval(() => {
      i2.getFloatFrequencyData(h);
      let v = new Float32Array(h.length);
      for (let w = 0; w < h.length; w++)
        v[w] = h[w];
      v = v.slice(n.loPass, n.hiPass);
      const C = Yt2(v), k2 = Math.ceil(C.length / r.bands), A3 = [];
      for (let w = 0; w < r.bands; w++) {
        const O2 = C.slice(w * k2, (w + 1) * k2).reduce((R, m) => R += m, 0);
        A3.push(O2 / k2);
      }
      c(A3);
    }, r.updateInterval);
    return () => {
      u(), clearInterval(l);
    };
  }, [t, t == null ? void 0 : t.mediaStream, JSON.stringify(n)]), o;
}
var Zt2 = {
  barCount: 120,
  volMultiplier: 5,
  updateInterval: 20
};
function ss2(e3, n = {}) {
  var h;
  const t = e3 instanceof Track ? e3 : (h = e3 == null ? void 0 : e3.publication) == null ? void 0 : h.track, r = { ...Zt2, ...n }, o = s.useRef(new Float32Array()), c = s.useRef(performance.now()), a = s.useRef(0), [i2, u] = s.useState([]), p = s.useCallback((d) => {
    u(
      Array.from(
        tn2(d, r.barCount).map((l) => Math.sqrt(l) * r.volMultiplier)
        // wave.slice(0, opts.barCount).map((v) => sigmoid(v * opts.volMultiplier, 0.08, 0.2)),
      )
    );
  }, []);
  return s.useEffect(() => {
    if (!t || !(t != null && t.mediaStream))
      return;
    const { analyser: d, cleanup: l } = createAudioAnalyser(t, {
      fftSize: ye2(r.barCount)
    }), v = ye2(r.barCount), C = new Float32Array(v), k2 = () => {
      if (A3 = requestAnimationFrame(k2), d.getFloatTimeDomainData(C), o.current.map((w, O2) => w + C[O2]), a.current += 1, performance.now() - c.current >= r.updateInterval) {
        const w = C.map((O2) => O2 / a.current);
        p(w), c.current = performance.now(), a.current = 0;
      }
    };
    let A3 = requestAnimationFrame(k2);
    return () => {
      l(), cancelAnimationFrame(A3);
    };
  }, [t, t == null ? void 0 : t.mediaStream, JSON.stringify(n), p]), {
    bars: i2
  };
}
function ye2(e3) {
  return e3 < 32 ? 32 : en2(e3);
}
function en2(e3) {
  let n = 2;
  for (; e3 >>= 1; )
    n <<= 1;
  return n;
}
function tn2(e3, n) {
  const t = Math.floor(e3.length / n), r = new Float32Array(n);
  for (let o = 0; o < n; o++) {
    const c = t * o;
    let a = 0;
    for (let i2 = 0; i2 < t; i2++)
      a = a + Math.abs(e3[c + i2]);
    r[o] = a / t;
  }
  return r;
}
function re(e3, n = {}) {
  let t, r;
  typeof n == "string" ? t = n : (t = n == null ? void 0 : n.participantIdentity, r = n == null ? void 0 : n.room);
  const o = Go(), c = Wt2({ room: r, updateOnlyOn: [] }), a = s.useMemo(() => t ? c.find((p) => p.identity === t) : o, [t, c, o]), i2 = s.useMemo(() => {
    if (a)
      return Ks(a, { sources: e3 });
  }, [a, JSON.stringify(e3)]);
  return D2(i2, []);
}
function nn2(e3) {
  var t, r, o;
  const n = s.useMemo(
    () => {
      var c;
      return (c = e3 == null ? void 0 : e3.publication) != null && c.track ? Qs(e3 == null ? void 0 : e3.publication.track) : void 0;
    },
    [(t = e3 == null ? void 0 : e3.publication) == null ? void 0 : t.track]
  );
  return D2(n, {
    timestamp: Date.now(),
    rtpTimestamp: (o = (r = e3 == null ? void 0 : e3.publication) == null ? void 0 : r.track) == null ? void 0 : o.rtpTimestamp
  });
}
var sn2 = {
  bufferSize: 100
  // maxAge: 2_000,
};
function rn2(e3, n) {
  const t = { ...sn2, ...n }, [r, o] = s.useState([]), c = nn2(e3), a = (i2) => {
    var u;
    (u = t.onTranscription) == null || u.call(t, i2), o(
      (p) => hs(
        p,
        // when first receiving a segment, add the current media timestamp to it
        i2.map((h) => ps(h, c)),
        t.bufferSize
      )
    );
  };
  return s.useEffect(() => {
    if (!(e3 != null && e3.publication))
      return;
    const i2 = Gs(e3.publication).subscribe((u) => {
      a(...u);
    });
    return () => {
      i2.unsubscribe();
    };
  }, [e3 && N(e3), a]), { segments: r };
}
function on2(e3 = {}) {
  const n = Go(), t = e3.participant ?? n, r = s.useMemo(
    // weird typescript constraint
    () => t ? Ls(t) : Ls(t),
    [t]
  );
  return D2(r, {
    attributes: t == null ? void 0 : t.attributes
  });
}
function rs2(e3, n = {}) {
  const t = ca(n.participant), [r, o] = s.useState(t.attributes[e3]);
  return s.useEffect(() => {
    if (!t)
      return;
    const c = Ls(t).subscribe((a) => {
      a.changed[e3] !== void 0 && o(a.attributes[e3]);
    });
    return () => {
      c.unsubscribe();
    };
  }, [t, e3]), r;
}
var Ce2 = po.AgentState;
function os2() {
  const e3 = pe2(), n = e3.find(
    (d) => d.kind === ParticipantInfo_Kind.AGENT && !(po.PublishOnBehalf in d.attributes)
  ), t = e3.find(
    (d) => d.kind === ParticipantInfo_Kind.AGENT && d.attributes[po.PublishOnBehalf] === (n == null ? void 0 : n.identity)
  ), r = re(
    [Track.Source.Microphone, Track.Source.Camera],
    n == null ? void 0 : n.identity
  ), o = re(
    [Track.Source.Microphone, Track.Source.Camera],
    t == null ? void 0 : t.identity
  ), c = r.find((d) => d.source === Track.Source.Microphone) ?? o.find((d) => d.source === Track.Source.Microphone), a = r.find((d) => d.source === Track.Source.Camera) ?? o.find((d) => d.source === Track.Source.Camera), { segments: i2 } = rn2(c), u = te2(), { attributes: p } = on2({ participant: n }), h = s.useMemo(() => u === ConnectionState.Disconnected ? "disconnected" : u === ConnectionState.Connecting || !n || !(p != null && p[Ce2]) ? "connecting" : p[Ce2], [p, n, u]);
  return {
    agent: n,
    state: h,
    audioTrack: c,
    videoTrack: a,
    agentTranscriptions: i2,
    agentAttributes: p
  };
}
function as2(e3) {
  const n = la(e3), t = te2(n), r = s.useMemo(() => Cs(n), [n, t]);
  return D2(r, n.isRecording);
}
function an2(e3, n) {
  const t = la(n == null ? void 0 : n.room), o = te2(t) === ConnectionState.Disconnected, c = s.useMemo(() => ea(t, e3), [t, e3]);
  return { textStreams: D2(o ? void 0 : c, []) };
}
function cn2(e3) {
  const { participantIdentities: n, trackSids: t } = e3 ?? {}, { textStreams: r } = an2(Mo.TRANSCRIPTION, { room: e3 == null ? void 0 : e3.room });
  return s.useMemo(
    () => r.filter(
      (c) => n ? n.includes(c.participantInfo.identity) : true
    ).filter(
      (c) => {
        var a;
        return t ? t.includes(
          ((a = c.streamInfo.attributes) == null ? void 0 : a[po.TranscribedTrackId]) ?? ""
        ) : true;
      }
    ),
    [r, n, t]
  );
}
var Me2 = 2;
var Te = 400;
var Ee2 = 3;
var ke2 = 1e3;
function cs2(e3) {
  const n = (0, import_react.useRef)([]), t = (0, import_react.useMemo)(() => new _(), []), r = (0, import_react.useCallback)(async () => t.lock().then(async (h) => {
    for (; ; ) {
      const d = n.current.pop();
      if (!d) {
        h();
        break;
      }
      switch (d.type) {
        case "connect":
          await d.room.connect(...d.args).then(d.resolve).catch(d.reject);
          break;
        case "disconnect":
          await d.room.disconnect(...d.args).then(d.resolve).catch(d.reject);
          break;
      }
    }
  }), []), o = (0, import_react.useRef)([]), c = (0, import_react.useCallback)((h) => {
    let d = 0;
    o.current = o.current.filter((l) => {
      const v = h.getTime() - l.getTime() < ke2;
      return v && (d += 1), v;
    }), d > Ee2 && L.warn(
      `useSequentialRoomConnectDisconnect: room changed reference rapidly (over ${Ee2}x in ${ke2}ms). This is not recommended.`
    );
  }, []);
  (0, import_react.useEffect)(() => {
    n.current = [];
    const h = /* @__PURE__ */ new Date();
    o.current.push(h), c(h);
  }, [e3, c]);
  const a = (0, import_react.useRef)([]), i2 = (0, import_react.useCallback)((h) => {
    let d = 0;
    a.current = a.current.filter((l) => {
      const v = h.getTime() - l.getTime() < Te;
      return v && (d += 1), v;
    }), d > Me2 && L.warn(
      `useSequentialRoomConnectDisconnect: room connect / disconnect occurring in rapid sequence (over ${Me2}x in ${Te}ms). This is not recommended and may be the sign of a bug like a useEffect dependency changing every render.`
    );
  }, []), u = (0, import_react.useCallback)(
    async (...h) => new Promise((d, l) => {
      if (!e3)
        throw new Error("Called connect(), but room was unset");
      const v = /* @__PURE__ */ new Date();
      i2(v), n.current.push({ type: "connect", room: e3, args: h, resolve: d, reject: l }), a.current.push(v), r();
    }),
    [e3, i2, r]
  ), p = (0, import_react.useCallback)(
    async (...h) => new Promise((d, l) => {
      if (!e3)
        throw new Error("Called discconnect(), but room was unset");
      const v = /* @__PURE__ */ new Date();
      i2(v), n.current.push({ type: "disconnect", room: e3, args: h, resolve: d, reject: l }), a.current.push(v), r();
    }),
    [e3, i2, r]
  );
  return {
    connect: e3 ? u : null,
    disconnect: e3 ? p : null
  };
}
var ne2 = { exports: {} };
var we2;
function un2() {
  if (we2) return ne2.exports;
  we2 = 1;
  var e3 = typeof Reflect == "object" ? Reflect : null, n = e3 && typeof e3.apply == "function" ? e3.apply : function(f, b, g) {
    return Function.prototype.apply.call(f, b, g);
  }, t;
  e3 && typeof e3.ownKeys == "function" ? t = e3.ownKeys : Object.getOwnPropertySymbols ? t = function(f) {
    return Object.getOwnPropertyNames(f).concat(Object.getOwnPropertySymbols(f));
  } : t = function(f) {
    return Object.getOwnPropertyNames(f);
  };
  function r(m) {
    console && console.warn && console.warn(m);
  }
  var o = Number.isNaN || function(f) {
    return f !== f;
  };
  function c() {
    c.init.call(this);
  }
  ne2.exports = c, ne2.exports.once = w, c.EventEmitter = c, c.prototype._events = void 0, c.prototype._eventsCount = 0, c.prototype._maxListeners = void 0;
  var a = 10;
  function i2(m) {
    if (typeof m != "function")
      throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof m);
  }
  Object.defineProperty(c, "defaultMaxListeners", {
    enumerable: true,
    get: function() {
      return a;
    },
    set: function(m) {
      if (typeof m != "number" || m < 0 || o(m))
        throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + m + ".");
      a = m;
    }
  }), c.init = function() {
    (this._events === void 0 || this._events === Object.getPrototypeOf(this)._events) && (this._events = /* @__PURE__ */ Object.create(null), this._eventsCount = 0), this._maxListeners = this._maxListeners || void 0;
  }, c.prototype.setMaxListeners = function(f) {
    if (typeof f != "number" || f < 0 || o(f))
      throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + f + ".");
    return this._maxListeners = f, this;
  };
  function u(m) {
    return m._maxListeners === void 0 ? c.defaultMaxListeners : m._maxListeners;
  }
  c.prototype.getMaxListeners = function() {
    return u(this);
  }, c.prototype.emit = function(f) {
    for (var b = [], g = 1; g < arguments.length; g++) b.push(arguments[g]);
    var y = f === "error", T2 = this._events;
    if (T2 !== void 0)
      y = y && T2.error === void 0;
    else if (!y)
      return false;
    if (y) {
      var M2;
      if (b.length > 0 && (M2 = b[0]), M2 instanceof Error)
        throw M2;
      var P2 = new Error("Unhandled error." + (M2 ? " (" + M2.message + ")" : ""));
      throw P2.context = M2, P2;
    }
    var F2 = T2[f];
    if (F2 === void 0)
      return false;
    if (typeof F2 == "function")
      n(F2, this, b);
    else
      for (var q3 = F2.length, J3 = C(F2, q3), g = 0; g < q3; ++g)
        n(J3[g], this, b);
    return true;
  };
  function p(m, f, b, g) {
    var y, T2, M2;
    if (i2(b), T2 = m._events, T2 === void 0 ? (T2 = m._events = /* @__PURE__ */ Object.create(null), m._eventsCount = 0) : (T2.newListener !== void 0 && (m.emit(
      "newListener",
      f,
      b.listener ? b.listener : b
    ), T2 = m._events), M2 = T2[f]), M2 === void 0)
      M2 = T2[f] = b, ++m._eventsCount;
    else if (typeof M2 == "function" ? M2 = T2[f] = g ? [b, M2] : [M2, b] : g ? M2.unshift(b) : M2.push(b), y = u(m), y > 0 && M2.length > y && !M2.warned) {
      M2.warned = true;
      var P2 = new Error("Possible EventEmitter memory leak detected. " + M2.length + " " + String(f) + " listeners added. Use emitter.setMaxListeners() to increase limit");
      P2.name = "MaxListenersExceededWarning", P2.emitter = m, P2.type = f, P2.count = M2.length, r(P2);
    }
    return m;
  }
  c.prototype.addListener = function(f, b) {
    return p(this, f, b, false);
  }, c.prototype.on = c.prototype.addListener, c.prototype.prependListener = function(f, b) {
    return p(this, f, b, true);
  };
  function h() {
    if (!this.fired)
      return this.target.removeListener(this.type, this.wrapFn), this.fired = true, arguments.length === 0 ? this.listener.call(this.target) : this.listener.apply(this.target, arguments);
  }
  function d(m, f, b) {
    var g = { fired: false, wrapFn: void 0, target: m, type: f, listener: b }, y = h.bind(g);
    return y.listener = b, g.wrapFn = y, y;
  }
  c.prototype.once = function(f, b) {
    return i2(b), this.on(f, d(this, f, b)), this;
  }, c.prototype.prependOnceListener = function(f, b) {
    return i2(b), this.prependListener(f, d(this, f, b)), this;
  }, c.prototype.removeListener = function(f, b) {
    var g, y, T2, M2, P2;
    if (i2(b), y = this._events, y === void 0)
      return this;
    if (g = y[f], g === void 0)
      return this;
    if (g === b || g.listener === b)
      --this._eventsCount === 0 ? this._events = /* @__PURE__ */ Object.create(null) : (delete y[f], y.removeListener && this.emit("removeListener", f, g.listener || b));
    else if (typeof g != "function") {
      for (T2 = -1, M2 = g.length - 1; M2 >= 0; M2--)
        if (g[M2] === b || g[M2].listener === b) {
          P2 = g[M2].listener, T2 = M2;
          break;
        }
      if (T2 < 0)
        return this;
      T2 === 0 ? g.shift() : k2(g, T2), g.length === 1 && (y[f] = g[0]), y.removeListener !== void 0 && this.emit("removeListener", f, P2 || b);
    }
    return this;
  }, c.prototype.off = c.prototype.removeListener, c.prototype.removeAllListeners = function(f) {
    var b, g, y;
    if (g = this._events, g === void 0)
      return this;
    if (g.removeListener === void 0)
      return arguments.length === 0 ? (this._events = /* @__PURE__ */ Object.create(null), this._eventsCount = 0) : g[f] !== void 0 && (--this._eventsCount === 0 ? this._events = /* @__PURE__ */ Object.create(null) : delete g[f]), this;
    if (arguments.length === 0) {
      var T2 = Object.keys(g), M2;
      for (y = 0; y < T2.length; ++y)
        M2 = T2[y], M2 !== "removeListener" && this.removeAllListeners(M2);
      return this.removeAllListeners("removeListener"), this._events = /* @__PURE__ */ Object.create(null), this._eventsCount = 0, this;
    }
    if (b = g[f], typeof b == "function")
      this.removeListener(f, b);
    else if (b !== void 0)
      for (y = b.length - 1; y >= 0; y--)
        this.removeListener(f, b[y]);
    return this;
  };
  function l(m, f, b) {
    var g = m._events;
    if (g === void 0)
      return [];
    var y = g[f];
    return y === void 0 ? [] : typeof y == "function" ? b ? [y.listener || y] : [y] : b ? A3(y) : C(y, y.length);
  }
  c.prototype.listeners = function(f) {
    return l(this, f, true);
  }, c.prototype.rawListeners = function(f) {
    return l(this, f, false);
  }, c.listenerCount = function(m, f) {
    return typeof m.listenerCount == "function" ? m.listenerCount(f) : v.call(m, f);
  }, c.prototype.listenerCount = v;
  function v(m) {
    var f = this._events;
    if (f !== void 0) {
      var b = f[m];
      if (typeof b == "function")
        return 1;
      if (b !== void 0)
        return b.length;
    }
    return 0;
  }
  c.prototype.eventNames = function() {
    return this._eventsCount > 0 ? t(this._events) : [];
  };
  function C(m, f) {
    for (var b = new Array(f), g = 0; g < f; ++g)
      b[g] = m[g];
    return b;
  }
  function k2(m, f) {
    for (; f + 1 < m.length; f++)
      m[f] = m[f + 1];
    m.pop();
  }
  function A3(m) {
    for (var f = new Array(m.length), b = 0; b < f.length; ++b)
      f[b] = m[b].listener || m[b];
    return f;
  }
  function w(m, f) {
    return new Promise(function(b, g) {
      function y(M2) {
        m.removeListener(f, T2), g(M2);
      }
      function T2() {
        typeof m.removeListener == "function" && m.removeListener("error", y), b([].slice.call(arguments));
      }
      R(m, f, T2, { once: true }), f !== "error" && O2(m, y, { once: true });
    });
  }
  function O2(m, f, b) {
    typeof m.on == "function" && R(m, "error", f, b);
  }
  function R(m, f, b, g) {
    if (typeof m.on == "function")
      g.once ? m.once(f, b) : m.on(f, b);
    else if (typeof m.addEventListener == "function")
      m.addEventListener(f, function y(T2) {
        g.once && m.removeEventListener(f, y), b(T2);
      });
    else
      throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type ' + typeof m);
  }
  return ne2.exports;
}
var he2 = un2();
var ln2 = 2e4;
var dn2 = ((e3) => (e3.CameraChanged = "cameraChanged", e3.MicrophoneChanged = "microphoneChanged", e3.StateChanged = "stateChanged", e3))(dn2 || {});
var x = (e3) => ({
  isConnected: e3 === "listening" || e3 === "thinking" || e3 === "speaking",
  canListen: e3 === "pre-connect-buffering" || e3 === "listening" || e3 === "thinking" || e3 === "speaking",
  isFinished: e3 === "disconnected" || e3 === "failed",
  isPending: e3 === "connecting" || e3 === "initializing" || e3 === "idle"
});
var fn2 = () => {
  const [e3, n] = s.useState(
    null
  ), [t, r] = s.useState(
    null
  ), o = s.useRef("connecting"), c = s.useRef(false), a = (i2) => setTimeout(() => {
    if (!c.current) {
      n("Agent did not join the room.");
      return;
    }
    const { isConnected: u } = x(o.current);
    if (!u) {
      n("Agent joined the room but did not complete initializing.");
      return;
    }
  }, i2 ?? ln2);
  return {
    agentTimeoutFailureReason: e3,
    startAgentTimeout: s.useCallback(
      (i2) => {
        t && clearTimeout(t), n(null), r(a(i2)), o.current = "connecting", c.current = false;
      },
      [t]
    ),
    clearAgentTimeout: s.useCallback(() => {
      t && clearTimeout(t), n(null), r(null), o.current = "connecting", c.current = false;
    }, [t]),
    clearAgentTimeoutFailureReason: s.useCallback(() => {
      n(null);
    }, []),
    updateAgentTimeoutState: s.useCallback((i2) => {
      o.current = i2;
    }, []),
    updateAgentTimeoutParticipantExists: s.useCallback((i2) => {
      c.current = i2;
    }, [])
  };
};
function mn2(e3, n) {
  const t = s.useRef(n);
  s.useEffect(() => {
    t.current = n;
  }, [n]);
  const r = s.useCallback(
    async (a) => {
      const { isConnected: i2 } = x(t.current);
      if (!i2)
        return new Promise((u, p) => {
          const h = (v) => {
            const { isConnected: C } = x(v);
            C && (l(), u());
          }, d = () => {
            l(), p(new Error("useAgent(/* ... */).waitUntilConnected - signal aborted"));
          }, l = () => {
            e3.off("stateChanged", h), a == null || a.removeEventListener("abort", d);
          };
          e3.on("stateChanged", h), a == null || a.addEventListener("abort", d);
        });
    },
    [e3]
  ), o = s.useCallback(
    async (a) => {
      const { canListen: i2 } = x(t.current);
      if (!i2)
        return new Promise((u, p) => {
          const h = (v) => {
            const { canListen: C } = x(v);
            C && (l(), u());
          }, d = () => {
            l(), p(new Error("useAgent(/* ... */).waitUntilCouldBeListening - signal aborted"));
          }, l = () => {
            e3.off("stateChanged", h), a == null || a.removeEventListener("abort", d);
          };
          e3.on("stateChanged", h), a == null || a.addEventListener("abort", d);
        });
    },
    [e3]
  ), c = s.useCallback(
    async (a) => {
      const { isFinished: i2 } = x(t.current);
      if (!i2)
        return new Promise((u, p) => {
          const h = (v) => {
            const { isFinished: C } = x(v);
            C && (l(), u());
          }, d = () => {
            l(), p(new Error("useAgent(/* ... */).waitUntilFinished - signal aborted"));
          }, l = () => {
            e3.off("stateChanged", h), a == null || a.removeEventListener("abort", d);
          };
          e3.on("stateChanged", h), a == null || a.addEventListener("abort", d);
        });
    },
    [e3]
  );
  return { waitUntilConnected: r, waitUntilCouldBeListening: o, waitUntilFinished: c };
}
function Ie2(e3) {
  const n = Jo();
  if (e3 = e3 ?? n, !e3)
    throw new Error(
      "No session provided, make sure you are inside a Session context or pass the session explicitly"
    );
  const {
    room: t,
    internal: {
      agentConnectTimeoutMilliseconds: r,
      agentTimeoutFailureReason: o,
      startAgentTimeout: c,
      clearAgentTimeout: a,
      clearAgentTimeoutFailureReason: i2,
      updateAgentTimeoutState: u,
      updateAgentTimeoutParticipantExists: p
    }
  } = e3, h = s.useMemo(() => new he2.EventEmitter(), []), d = pe2({ room: t }), l = s.useMemo(() => d.find(
    (S) => S.kind === ParticipantInfo_Kind.AGENT && !(po.PublishOnBehalf in S.attributes)
  ) ?? null, [d]), v = s.useMemo(() => l ? d.find(
    (S) => S.kind === ParticipantInfo_Kind.AGENT && S.attributes[po.PublishOnBehalf] === l.identity
  ) ?? null : null, [l, d]), [C, k2] = s.useState({});
  s.useEffect(() => {
    if (!l)
      return;
    const S = (_2) => {
      k2(_2);
    };
    return l.on(ParticipantEvent.AttributesChanged, S), () => {
      l.off(ParticipantEvent.AttributesChanged, S);
    };
  }, [l, h]);
  const A3 = re([Track.Source.Camera, Track.Source.Microphone], {
    room: t,
    participantIdentity: l == null ? void 0 : l.identity
  }), w = re([Track.Source.Camera, Track.Source.Microphone], {
    room: t,
    participantIdentity: v == null ? void 0 : v.identity
  }), O2 = s.useMemo(
    () => A3.find((S) => S.source === Track.Source.Camera) ?? w.find((S) => S.source === Track.Source.Camera),
    [A3, w]
  );
  s.useEffect(() => {
    h.emit("cameraChanged", O2);
  }, [h, O2]);
  const R = s.useMemo(
    () => A3.find((S) => S.source === Track.Source.Microphone) ?? w.find((S) => S.source === Track.Source.Microphone),
    [A3, w]
  );
  s.useEffect(() => {
    h.emit("microphoneChanged", R);
  }, [h, R]);
  const [m, f] = s.useState(t.state);
  s.useEffect(() => {
    const S = (_2) => {
      f(_2);
    };
    return t.on(RoomEvent.ConnectionStateChanged, S), () => {
      t.off(RoomEvent.ConnectionStateChanged, S);
    };
  }, [t]), s.useEffect(() => {
    l && i2();
  }, [l]);
  const [b, g] = s.useState(null);
  s.useEffect(() => {
    if (!l)
      return;
    const S = (_2) => {
      _2.identity === (l == null ? void 0 : l.identity) && g("Agent left the room unexpectedly.");
    };
    return t.on(RoomEvent.ParticipantDisconnected, S), () => {
      t.off(RoomEvent.ParticipantDisconnected, S);
    };
  }, [l, t]), s.useEffect(() => {
    m === ConnectionState.Disconnected && g(null);
  }, [m]);
  const [y, T2] = s.useState(
    () => t.localParticipant.getTrackPublication(Track.Source.Microphone) ?? null
  );
  s.useEffect(() => {
    const S = () => {
      T2(t.localParticipant.getTrackPublication(Track.Source.Microphone) ?? null);
    }, _2 = () => {
      T2(null);
    };
    return t.localParticipant.on(
      ParticipantEvent.LocalTrackPublished,
      S
    ), t.localParticipant.on(
      ParticipantEvent.LocalTrackUnpublished,
      _2
    ), () => {
      t.localParticipant.off(
        ParticipantEvent.LocalTrackPublished,
        S
      ), t.localParticipant.off(
        ParticipantEvent.LocalTrackUnpublished,
        _2
      );
    };
  }, [t.localParticipant]);
  const M2 = s.useMemo(() => {
    const S = [];
    return o && S.push(o), b && S.push(b), S;
  }, [o, b]), P2 = s.useMemo(() => {
    if (M2.length > 0)
      return "failed";
    let S = "disconnected";
    return m !== ConnectionState.Disconnected && (S = "connecting"), y && (S = "pre-connect-buffering"), l && C[po.AgentState] && (S = C[po.AgentState]), S;
  }, [
    M2,
    m,
    y,
    l,
    C
  ]);
  s.useEffect(() => {
    h.emit("stateChanged", P2), u(P2);
  }, [h, P2]), s.useEffect(() => {
    p(l !== null);
  }, [l]);
  const F2 = e3.connectionState === "disconnected";
  s.useEffect(() => {
    if (!F2)
      return c(r), () => {
        a();
      };
  }, [F2, r]);
  const q3 = s.useMemo(() => {
    const S = {
      attributes: C,
      internal: {
        agentParticipant: l,
        workerParticipant: v,
        emitter: h
      }
    };
    switch (P2) {
      case "disconnected":
        return {
          ...S,
          state: P2,
          ...x(P2),
          failureReasons: null,
          // Clear inner values if no longer connected
          cameraTrack: void 0,
          microphoneTrack: void 0
        };
      case "connecting":
        return {
          ...S,
          state: P2,
          ...x(P2),
          failureReasons: null,
          // Clear inner values if no longer connected
          cameraTrack: void 0,
          microphoneTrack: void 0
        };
      case "initializing":
      case "idle":
        return {
          ...S,
          state: P2,
          ...x(P2),
          failureReasons: null,
          cameraTrack: O2,
          microphoneTrack: R
        };
      case "pre-connect-buffering":
        return {
          ...S,
          state: P2,
          ...x(P2),
          failureReasons: null,
          cameraTrack: O2,
          microphoneTrack: R
        };
      case "listening":
      case "thinking":
      case "speaking":
        return {
          ...S,
          state: P2,
          ...x(P2),
          failureReasons: null,
          cameraTrack: O2,
          microphoneTrack: R
        };
      case "failed":
        return {
          ...S,
          state: "failed",
          ...x("failed"),
          failureReasons: M2,
          // Clear inner values if no longer connected
          cameraTrack: void 0,
          microphoneTrack: void 0
        };
    }
  }, [C, h, l, P2, O2, R]), { waitUntilConnected: J3, waitUntilCouldBeListening: K3, waitUntilFinished: L3 } = mn2(h, P2), N2 = s.useCallback(
    (S) => new Promise((_2, Y2) => {
      const B3 = (z3) => {
        z3 && ($2(), _2(z3));
      }, j3 = () => {
        $2(), Y2(new Error("useAgent(/* ... */).waitUntilCamera - signal aborted"));
      }, $2 = () => {
        h.off("cameraChanged", B3), S == null || S.removeEventListener("abort", j3);
      };
      h.on("cameraChanged", B3), S == null || S.addEventListener("abort", j3);
    }),
    [h]
  ), Z2 = s.useCallback(
    (S) => new Promise((_2, Y2) => {
      const B3 = (z3) => {
        z3 && ($2(), _2(z3));
      }, j3 = () => {
        $2(), Y2(new Error("useAgent(/* ... */).waitUntilMicrophone - signal aborted"));
      }, $2 = () => {
        h.off("microphoneChanged", B3), S == null || S.removeEventListener("abort", j3);
      };
      h.on("microphoneChanged", B3), S == null || S.addEventListener("abort", j3);
    }),
    [h]
  );
  return s.useMemo(() => ({
    ...q3,
    waitUntilConnected: J3,
    waitUntilCouldBeListening: K3,
    waitUntilFinished: L3,
    waitUntilCamera: N2,
    waitUntilMicrophone: Z2
  }), [
    q3,
    J3,
    K3,
    L3,
    N2,
    Z2
  ]);
}
var pn2 = ((e3) => (e3.ConnectionStateChanged = "connectionStateChanged", e3.MediaDevicesError = "mediaDevicesError", e3.EncryptionError = "encryptionError", e3))(pn2 || {});
function hn2(e3, n) {
  const t = /* @__PURE__ */ new Set([...Object.keys(e3), ...Object.keys(n)]);
  for (const r of t)
    switch (r) {
      case "roomName":
      case "participantName":
      case "participantIdentity":
      case "participantMetadata":
      case "participantAttributes":
      case "agentName":
      case "agentMetadata":
        if (e3[r] !== n[r])
          return false;
        break;
      default:
        const o = r;
        throw new Error(`Options key ${o} not being checked for equality!`);
    }
  return true;
}
function bn2(e3, n) {
  const t = s.useRef(n);
  return s.useEffect(() => {
    t.current = n;
  }, [n]), s.useCallback(
    async (o, c) => {
      if (t.current !== o)
        return new Promise((a, i2) => {
          const u = (d) => {
            d === o && (h(), a());
          }, p = () => {
            h(), i2(
              new Error(
                `useSession(/* ... */).waitUntilConnectionState(${o}, /* signal */) - signal aborted`
              )
            );
          }, h = () => {
            e3.off("connectionStateChanged", u), c == null || c.removeEventListener("abort", p);
          };
          e3.on("connectionStateChanged", u), c == null || c.addEventListener("abort", p);
        });
    },
    [e3]
  );
}
function gn2(e3, n) {
  const t = e3 instanceof TokenSourceConfigurable, r = s.useRef(
    t ? n : null
  );
  return s.useEffect(() => {
    if (!t) {
      r.current = null;
      return;
    }
    r.current !== null && hn2(r.current, n) || (r.current = n);
  }, [t, n]), s.useCallback(async () => {
    if (t) {
      if (!r.current)
        throw new Error(
          "AgentSession - memoized token fetch options are not set, but the passed tokenSource was an instance of TokenSourceConfigurable. If you are seeing this please make a new GitHub issue!"
        );
      return e3.fetch(r.current);
    } else
      return e3.fetch();
  }, [t, e3]);
}
function is2(e3, n = {}) {
  const { room: t, agentConnectTimeoutMilliseconds: r, ...o } = n, c = Qo(), a = s.useMemo(
    () => c ?? t ?? new Room(),
    [c, t]
  ), i2 = s.useMemo(
    () => new he2.EventEmitter(),
    []
  ), u = s.useCallback(
    (L3) => ({
      isConnected: L3 === ConnectionState.Connected || L3 === ConnectionState.Reconnecting || L3 === ConnectionState.SignalReconnecting
    }),
    []
  ), [p, h] = s.useState(a.state);
  s.useEffect(() => {
    const L3 = (N2) => {
      h(N2);
    };
    return a.on(RoomEvent.ConnectionStateChanged, L3), () => {
      a.off(RoomEvent.ConnectionStateChanged, L3);
    };
  }, [a]), s.useEffect(() => {
    const L3 = async (N2) => {
      i2.emit("mediaDevicesError", N2);
    };
    return a.on(RoomEvent.MediaDevicesError, L3), () => {
      a.off(RoomEvent.MediaDevicesError, L3);
    };
  }, [a, i2]), s.useEffect(() => {
    const L3 = async (N2) => {
      i2.emit("encryptionError", N2);
    };
    return a.on(RoomEvent.EncryptionError, L3), () => {
      a.off(RoomEvent.EncryptionError, L3);
    };
  }, [a, i2]);
  const { localParticipant: d } = Oe2({ room: a }), l = d.getTrackPublication(Track.Source.Camera), v = s.useMemo(() => !l || l.isMuted ? null : {
    source: Track.Source.Camera,
    participant: d,
    publication: l
  }, [d, l, l == null ? void 0 : l.isMuted]), C = d.getTrackPublication(Track.Source.Microphone), k2 = s.useMemo(() => !C || C.isMuted ? null : {
    source: Track.Source.Microphone,
    participant: d,
    publication: C
  }, [d, C, C == null ? void 0 : C.isMuted]), {
    agentTimeoutFailureReason: A3,
    startAgentTimeout: w,
    clearAgentTimeout: O2,
    clearAgentTimeoutFailureReason: R,
    updateAgentTimeoutState: m,
    updateAgentTimeoutParticipantExists: f
  } = fn2(), b = s.useMemo(
    () => ({
      emitter: i2,
      tokenSource: e3,
      agentConnectTimeoutMilliseconds: r,
      agentTimeoutFailureReason: A3,
      startAgentTimeout: w,
      clearAgentTimeout: O2,
      clearAgentTimeoutFailureReason: R,
      updateAgentTimeoutState: m,
      updateAgentTimeoutParticipantExists: f
    }),
    [
      i2,
      r,
      e3,
      A3,
      w,
      O2,
      R,
      m,
      f
    ]
  ), g = s.useMemo(() => {
    const L3 = {
      room: a,
      internal: b
    };
    switch (p) {
      case ConnectionState.Connecting:
        return {
          ...L3,
          connectionState: ConnectionState.Connecting,
          ...u(ConnectionState.Connecting),
          local: {
            cameraTrack: null,
            microphoneTrack: null
          }
        };
      case ConnectionState.Connected:
      case ConnectionState.Reconnecting:
      case ConnectionState.SignalReconnecting:
        return {
          ...L3,
          connectionState: p,
          ...u(p),
          local: {
            cameraTrack: v,
            microphoneTrack: k2
          }
        };
      case ConnectionState.Disconnected:
        return {
          ...L3,
          connectionState: ConnectionState.Disconnected,
          ...u(ConnectionState.Disconnected),
          local: {
            cameraTrack: null,
            microphoneTrack: null
          }
        };
    }
  }, [
    b,
    a,
    p,
    v,
    k2,
    u
  ]);
  s.useEffect(() => {
    i2.emit("connectionStateChanged", g.connectionState);
  }, [i2, g.connectionState]);
  const y = bn2(
    i2,
    g.connectionState
  ), T2 = s.useCallback(
    async (L3) => y(
      ConnectionState.Connected,
      L3
    ),
    [y]
  ), M2 = s.useCallback(
    async (L3) => y(ConnectionState.Disconnected, L3),
    [y]
  ), P2 = Ie2(
    s.useMemo(
      () => ({
        connectionState: g.connectionState,
        room: a,
        internal: b
      }),
      [g, a, b]
    )
  ), F2 = gn2(e3, o), q3 = s.useCallback(
    async (L3 = {}) => {
      var B3, j3;
      const {
        signal: N2,
        tracks: Z2 = { microphone: { enabled: true, publishOptions: { preConnectBuffer: true } } },
        roomConnectOptions: S
      } = L3;
      await M2(N2);
      const _2 = () => {
        a.disconnect();
      };
      N2 == null || N2.addEventListener("abort", _2);
      let Y2 = false;
      await Promise.all([
        F2().then(({ serverUrl: $2, participantToken: z3 }) => {
          var be3, ge2;
          return Y2 = (((ge2 = (be3 = decodeTokenPayload(z3).roomConfig) == null ? void 0 : be3.agents) == null ? void 0 : ge2.length) ?? 0) > 0, a.connect($2, z3, S);
        }),
        // Start microphone (with preconnect buffer) by default
        (B3 = Z2.microphone) != null && B3.enabled ? a.localParticipant.setMicrophoneEnabled(
          true,
          void 0,
          ((j3 = Z2.microphone) == null ? void 0 : j3.publishOptions) ?? {}
        ) : Promise.resolve()
      ]), await T2(N2), Y2 && await P2.waitUntilConnected(N2), N2 == null || N2.removeEventListener("abort", _2);
    },
    [a, M2, F2, T2, P2.waitUntilConnected]
  ), J3 = s.useCallback(async () => {
    await a.disconnect();
  }, [a]), K3 = s.useCallback(async () => {
    const L3 = await F2();
    await a.prepareConnection(L3.serverUrl, L3.participantToken);
  }, [F2, a]);
  return s.useEffect(
    () => {
      K3().catch((L3) => {
        console.warn("WARNING: Room.prepareConnection failed:", L3);
      });
    },
    [
      /* note: no prepareConnection here, this effect should only ever run once! */
    ]
  ), s.useMemo(
    () => ({
      ...g,
      waitUntilConnected: T2,
      waitUntilDisconnected: M2,
      prepareConnection: K3,
      start: q3,
      end: J3
    }),
    [g, T2, M2, K3, q3, J3]
  );
}
function us2(e3, n, t, r) {
  const o = s.useMemo(() => () => {
  }, []), c = s.useCallback(t ?? o, r ?? []), a = r ? c : t, i2 = s.useMemo(() => e3 ? "internal" in e3 ? e3.internal.emitter : e3 : null, [e3]);
  s.useEffect(() => {
    if (!(!i2 || !a))
      return i2.on(n, a), () => {
        i2.off(n, a);
      };
  }, [i2, n, a]);
}
var vn2 = ((e3) => (e3.MessageReceived = "messageReceived", e3))(vn2 || {});
function ls2(e3) {
  const { room: n } = da(e3), t = s.useMemo(
    () => new he2.EventEmitter(),
    []
  ), r = Ie2(e3), o = cn2({ room: n }), c = s.useMemo(() => ({ room: n }), [n]), a = Kt2(c), i2 = s.useMemo(() => o.map((l) => {
    var v, C, k2;
    switch (l.participantInfo.identity) {
      case n.localParticipant.identity:
        return {
          type: "userTranscript",
          message: l.text,
          id: l.streamInfo.id,
          timestamp: l.streamInfo.timestamp,
          from: n.localParticipant
        };
      case ((v = r.internal.agentParticipant) == null ? void 0 : v.identity):
      case ((C = r.internal.workerParticipant) == null ? void 0 : C.identity):
        return {
          type: "agentTranscript",
          message: l.text,
          id: l.streamInfo.id,
          timestamp: l.streamInfo.timestamp,
          from: ((k2 = r.internal.agentParticipant) == null ? void 0 : k2.identity) === l.participantInfo.identity ? r.internal.agentParticipant : r.internal.workerParticipant
        };
      default:
        return {
          type: "agentTranscript",
          message: l.text,
          id: l.streamInfo.id,
          timestamp: l.streamInfo.timestamp,
          from: Array.from(n.remoteParticipants.values()).find(
            (A3) => A3.identity === l.participantInfo.identity
          )
        };
    }
  }), [o, n]), u = s.useMemo(() => [...i2, ...a.chatMessages], [i2, a.chatMessages]), p = s.useRef(/* @__PURE__ */ new Map()), h = s.useMemo(() => {
    const l = /* @__PURE__ */ new Date();
    for (const v of u)
      p.current.has(v.id) || p.current.set(v.id, l);
    return u.sort((v, C) => {
      const k2 = p.current.get(v.id), A3 = p.current.get(C.id);
      return typeof k2 > "u" || typeof A3 > "u" ? 0 : k2.getTime() - A3.getTime();
    });
  }, [u]), d = s.useRef(/* @__PURE__ */ new Set());
  return s.useEffect(() => {
    for (const l of h)
      d.current.has(l.id) || (d.current.add(l.id), t.emit("messageReceived", l));
  }, [h]), s.useMemo(
    () => ({
      messages: h,
      send: a.send,
      isSending: a.isSending,
      internal: { emitter: t }
    }),
    [h, a.send, a.isSending]
  );
}

// node_modules/@livekit/components-react/dist/prefabs.mjs
var e2 = __toESM(require_react(), 1);

// node_modules/@livekit/components-react/dist/components-DuRBtGp8.mjs
var e = __toESM(require_react(), 1);
var import_react2 = __toESM(require_react(), 1);
var ca2 = e.forwardRef(
  function(n, a) {
    const { buttonProps: c } = Pn2(n);
    return e.createElement("button", { ref: a, ...c }, n.children);
  }
);
var la2 = e.forwardRef(
  function({ room: n, ...a }, c) {
    const r = te2(n);
    return e.createElement("div", { ref: c, ...a }, r);
  }
);
var sa2 = e.forwardRef(
  function(n, a) {
    const { mergedProps: c } = Jn2({ props: n });
    return e.createElement("button", { ref: a, ...c }, n.children);
  }
);
var ia2 = e.forwardRef(
  function(n, a) {
    const { buttonProps: c } = Rn2(n);
    return e.createElement("button", { ref: a, ...c }, n.children);
  }
);
var pt2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "currentColor", ...t }, e.createElement("path", { d: "M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z" }), e.createElement("path", { d: "m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z" }));
var wt2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "currentColor", ...t }, e.createElement("path", { d: "M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z" }));
var oa2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, viewBox: "0 0 24 24", ...t }, e.createElement(
  "path",
  {
    fill: "#FFF",
    d: "M4.99 3.99a1 1 0 0 0-.697 1.717L10.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414L12 13.414l6.293 6.293a1 1 0 1 0 1.414-1.414L13.414 12l6.293-6.293a1 1 0 0 0-.727-1.717 1 1 0 0 0-.687.303L12 10.586 5.707 4.293a1 1 0 0 0-.717-.303z"
  }
));
var ua2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 18, fill: "none", ...t }, e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",
    clipRule: "evenodd"
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",
    clipRule: "evenodd"
  }
));
var ie2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "none", ...t }, e.createElement(
  "path",
  {
    fill: "currentcolor",
    fillRule: "evenodd",
    d: "M5.293 2.293a1 1 0 0 1 1.414 0l4.823 4.823a1.25 1.25 0 0 1 0 1.768l-4.823 4.823a1 1 0 0 1-1.414-1.414L9.586 8 5.293 3.707a1 1 0 0 1 0-1.414z",
    clipRule: "evenodd"
  }
));
var kt2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "none", ...t }, e.createElement("g", { stroke: "currentColor", strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 1.5 }, e.createElement("path", { d: "M10 1.75h4.25m0 0V6m0-4.25L9 7M6 14.25H1.75m0 0V10m0 4.25L7 9" })));
var da2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "none", ...t }, e.createElement(
  "path",
  {
    fill: "currentcolor",
    fillRule: "evenodd",
    d: "M8.961.894C8.875-.298 7.125-.298 7.04.894c-.066.912-1.246 1.228-1.76.472-.67-.99-2.186-.115-1.664.96.399.824-.465 1.688-1.288 1.289-1.076-.522-1.95.994-.961 1.665.756.513.44 1.693-.472 1.759-1.192.086-1.192 1.836 0 1.922.912.066 1.228 1.246.472 1.76-.99.67-.115 2.186.96 1.664.824-.399 1.688.465 1.289 1.288-.522 1.076.994 1.95 1.665.961.513-.756 1.693-.44 1.759.472.086 1.192 1.836 1.192 1.922 0 .066-.912 1.246-1.228 1.76-.472.67.99 2.186.115 1.664-.96-.399-.824.465-1.688 1.288-1.289 1.076.522 1.95-.994.961-1.665-.756-.513-.44-1.693.472-1.759 1.192-.086 1.192-1.836 0-1.922-.912-.066-1.228-1.246-.472-1.76.99-.67.115-2.186-.96-1.664-.824.399-1.688-.465-1.289-1.288.522-1.076-.994-1.95-1.665-.961-.513.756-1.693.44-1.759-.472ZM8 13A5 5 0 1 0 8 3a5 5 0 0 0 0 10Z",
    clipRule: "evenodd"
  }
));
var ma = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "none", ...t }, e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",
    clipRule: "evenodd"
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",
    clipRule: "evenodd"
  }
));
var Rt2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "none", ...t }, e.createElement(
  "path",
  {
    fill: "currentcolor",
    fillRule: "evenodd",
    d: "M4 6.104V4a4 4 0 1 1 8 0v2.104c1.154.326 2 1.387 2 2.646v4.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-4.5c0-1.259.846-2.32 2-2.646ZM5.5 4a2.5 2.5 0 0 1 5 0v2h-5V4Z",
    clipRule: "evenodd"
  }
));
var Mt2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "currentColor", ...t }, e.createElement("path", { d: "M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z" }), e.createElement("path", { d: "M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z" }));
var yt2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "currentColor", ...t }, e.createElement(
  "path",
  {
    fillRule: "evenodd",
    d: "M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",
    clipRule: "evenodd"
  }
), e.createElement("path", { d: "M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z" }));
var bt2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "currentcolor", ...t }, e.createElement("path", { d: "M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" }), e.createElement("path", { d: "M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" }));
var St = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "currentcolor", ...t }, e.createElement("path", { d: "M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" }), e.createElement("path", { d: "M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" }), e.createElement("g", { opacity: 0.25 }, e.createElement("path", { d: "M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" }), e.createElement("path", { d: "M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" })));
var Ct2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "currentcolor", ...t }, e.createElement("path", { d: "M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" }), e.createElement("path", { d: "M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" }), e.createElement("g", { opacity: 0.25 }, e.createElement("path", { d: "M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" }), e.createElement("path", { d: "M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" }), e.createElement("path", { d: "M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z" })));
var It2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "currentColor", ...t }, e.createElement("g", { opacity: 0.25 }, e.createElement("path", { d: "M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z" }), e.createElement("path", { d: "M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z" })));
var Re2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 20, height: 16, fill: "none", ...t }, e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",
    clipRule: "evenodd"
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",
    clipRule: "evenodd"
  }
));
var xt3 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 20, height: 16, fill: "none", ...t }, e.createElement("g", { fill: "currentColor" }, e.createElement("path", { d: "M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z" }), e.createElement(
  "path",
  {
    fillRule: "evenodd",
    d: "M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",
    clipRule: "evenodd"
  }
)));
var oe2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "none", ...t }, e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M8 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 8 0Z",
    clipRule: "evenodd"
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M8 12a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 8 12Z",
    clipRule: "evenodd",
    opacity: 0.7
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M12 1.072a.75.75 0 0 1 .274 1.024l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 12 1.072Z",
    clipRule: "evenodd"
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M6 11.464a.75.75 0 0 1 .274 1.025l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 6 11.464Z",
    clipRule: "evenodd",
    opacity: 0.6
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M14.928 4a.75.75 0 0 1-.274 1.025l-2.165 1.25a.75.75 0 1 1-.75-1.3l2.165-1.25A.75.75 0 0 1 14.928 4Z",
    clipRule: "evenodd"
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M4.536 10a.75.75 0 0 1-.275 1.024l-2.165 1.25a.75.75 0 0 1-.75-1.298l2.165-1.25A.75.75 0 0 1 4.536 10Z",
    clipRule: "evenodd",
    opacity: 0.5
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M16 8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 16 8Z",
    clipRule: "evenodd"
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M4 8a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 8Z",
    clipRule: "evenodd",
    opacity: 0.4
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M14.928 12a.75.75 0 0 1-1.024.274l-2.165-1.25a.75.75 0 0 1 .75-1.299l2.165 1.25A.75.75 0 0 1 14.928 12Z",
    clipRule: "evenodd",
    opacity: 0.9
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M4.536 6a.75.75 0 0 1-1.025.275l-2.165-1.25a.75.75 0 1 1 .75-1.3l2.165 1.25A.75.75 0 0 1 4.536 6Z",
    clipRule: "evenodd",
    opacity: 0.3
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M12 14.928a.75.75 0 0 1-1.024-.274l-1.25-2.165a.75.75 0 0 1 1.298-.75l1.25 2.165A.75.75 0 0 1 12 14.928Z",
    clipRule: "evenodd",
    opacity: 0.8
  }
), e.createElement(
  "path",
  {
    fill: "currentColor",
    fillRule: "evenodd",
    d: "M6 4.536a.75.75 0 0 1-1.024-.275l-1.25-2.165a.75.75 0 1 1 1.299-.75l1.25 2.165A.75.75 0 0 1 6 4.536Z",
    clipRule: "evenodd",
    opacity: 0.2
  }
));
var Pt2 = (t) => e.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: 16, height: 16, fill: "none", ...t }, e.createElement("g", { stroke: "currentColor", strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 1.5 }, e.createElement("path", { d: "M13.25 7H9m0 0V2.75M9 7l5.25-5.25M2.75 9H7m0 0v4.25M7 9l-5.25 5.25" })));
var Tt = e.forwardRef(
  function({ trackRef: n, ...a }, c) {
    const r = Bn(), { mergedProps: s2, inFocus: o } = Dn2({
      trackRef: n ?? r,
      props: a
    });
    return e.createElement(Wn.Consumer, null, (l) => l !== void 0 && e.createElement("button", { ref: c, ...s2 }, a.children ? a.children : o ? e.createElement(Pt2, null) : e.createElement(kt2, null)));
  }
);
var fa2 = e.forwardRef(
  function({
    kind: n,
    initialSelection: a,
    onActiveDeviceChange: c,
    onDeviceListChange: r,
    onDeviceSelectError: s2,
    exactMatch: o,
    track: l,
    requestPermissions: i2,
    onError: d,
    ...u
  }, v) {
    const f = Qo(), p = e.useRef("default"), E = e.useCallback(
      (w) => {
        f && f.emit(RoomEvent.MediaDevicesError, w), d == null || d(w);
      },
      [f, d]
    ), { devices: h, activeDeviceId: m, setActiveMediaDevice: y, className: C } = Nn2({
      kind: n,
      room: f,
      track: l,
      requestPermissions: i2,
      onError: E
    });
    e.useEffect(() => {
      a !== void 0 && y(a);
    }, [y]), e.useEffect(() => {
      typeof r == "function" && r(h);
    }, [r, h]), e.useEffect(() => {
      m !== p.current && (c == null || c(m)), p.current = m;
    }, [m]);
    const A3 = async (w) => {
      try {
        await y(w, { exact: o ?? true });
      } catch (M2) {
        if (M2 instanceof Error)
          s2 == null || s2(M2);
        else
          throw M2;
      }
    }, N2 = e.useMemo(
      () => G2(u, { className: C }, { className: "lk-list" }),
      [C, u]
    ), g = !!h.find((w) => w.label.toLowerCase().startsWith("default"));
    function R(w, M2, P2) {
      return w === M2 || !g && P2 === 0 && M2 === "default";
    }
    return e.createElement("ul", { ref: v, ...N2 }, h.map((w, M2) => e.createElement(
      "li",
      {
        key: w.deviceId,
        id: w.deviceId,
        "data-lk-active": R(w.deviceId, m, M2),
        "aria-selected": R(w.deviceId, m, M2),
        role: "option"
      },
      e.createElement("button", { className: "lk-button", onClick: () => A3(w.deviceId) }, w.label)
    )));
  }
);
var ha = e.forwardRef(
  function({ label: n = "Allow Audio", ...a }, c) {
    const r = la(a.room), { mergedProps: s2 } = zn2({ room: r, props: a });
    return e.createElement("button", { ref: c, ...s2 }, n);
  }
);
var ga = e.forwardRef(
  function({ label: n, ...a }, c) {
    const r = ua(), { mergedProps: s2, canPlayAudio: o } = zn2({ room: r, props: a }), { mergedProps: l, canPlayVideo: i2 } = Wn2({ room: r, props: s2 }), { style: d, ...u } = l;
    return d.display = o && i2 ? "none" : "block", e.createElement("button", { ref: c, style: d, ...u }, n ?? `Start ${o ? "Video" : "Audio"}`);
  }
);
function Me3(t, n) {
  switch (t) {
    case Track.Source.Microphone:
      return n ? e.createElement(yt2, null) : e.createElement(Mt2, null);
    case Track.Source.Camera:
      return n ? e.createElement(wt2, null) : e.createElement(pt2, null);
    case Track.Source.ScreenShare:
      return n ? e.createElement(xt3, null) : e.createElement(Re2, null);
    default:
      return;
  }
}
function At2(t) {
  switch (t) {
    case ConnectionQuality.Excellent:
      return e.createElement(bt2, null);
    case ConnectionQuality.Good:
      return e.createElement(St, null);
    case ConnectionQuality.Poor:
      return e.createElement(Ct2, null);
    default:
      return e.createElement(It2, null);
  }
}
var va = e.forwardRef(function({ showIcon: n, ...a }, c) {
  const { buttonProps: r, enabled: s2 } = Kn(a), [o, l] = e.useState(false);
  return e.useEffect(() => {
    l(true);
  }, []), o && e.createElement("button", { ref: c, ...r }, (n ?? true) && Me3(a.source, s2), a.children);
});
var ye3 = e.forwardRef(function(n, a) {
  const { className: c, quality: r } = Ln2(n), s2 = e.useMemo(() => ({ ...G2(n, { className: c }), "data-lk-quality": r }), [r, n, c]);
  return e.createElement("div", { ref: a, ...s2 }, n.children ?? At2(r));
});
var K2 = e.forwardRef(
  function({ participant: n, ...a }, c) {
    const r = ca(n), { className: s2, infoObserver: o } = e.useMemo(() => Fs(r), [r]), { identity: l, name: i2 } = D2(o, {
      name: r.name,
      identity: r.identity,
      metadata: r.metadata
    }), d = e.useMemo(() => G2(a, { className: s2, "data-lk-participant-name": i2 }), [a, s2, i2]);
    return e.createElement("span", { ref: c, ...d }, i2 !== "" ? i2 : l, a.children);
  }
);
var be2 = e.forwardRef(
  function({ trackRef: n, show: a = "always", ...c }, r) {
    const { className: s2, isMuted: o } = Qn(n), l = a === "always" || a === "muted" && o || a === "unmuted" && !o, i2 = e.useMemo(
      () => G2(c, {
        className: s2
      }),
      [s2, c]
    );
    return l ? e.createElement("div", { ref: r, ...i2, "data-lk-muted": o }, c.children ?? Me3(n.source, !o)) : null;
  }
);
var Nt2 = (t) => e.createElement(
  "svg",
  {
    width: 320,
    height: 320,
    viewBox: "0 0 320 320",
    preserveAspectRatio: "xMidYMid meet",
    fill: "none",
    xmlns: "http://www.w3.org/2000/svg",
    ...t
  },
  e.createElement(
    "path",
    {
      d: "M160 180C204.182 180 240 144.183 240 100C240 55.8172 204.182 20 160 20C115.817 20 79.9997 55.8172 79.9997 100C79.9997 144.183 115.817 180 160 180Z",
      fill: "white",
      fillOpacity: 0.25
    }
  ),
  e.createElement(
    "path",
    {
      d: "M97.6542 194.614C103.267 191.818 109.841 192.481 115.519 195.141C129.025 201.466 144.1 205 159.999 205C175.899 205 190.973 201.466 204.48 195.141C210.158 192.481 216.732 191.818 222.345 194.614C262.703 214.719 291.985 253.736 298.591 300.062C300.15 310.997 291.045 320 280 320H39.9997C28.954 320 19.8495 310.997 21.4087 300.062C28.014 253.736 57.2966 214.72 97.6542 194.614Z",
      fill: "white",
      fillOpacity: 0.25
    }
  )
);
function Se2(t, n = {}) {
  const [a, c] = e.useState(zt(t)), [r, s2] = e.useState(a == null ? void 0 : a.isMuted), [o, l] = e.useState(a == null ? void 0 : a.isSubscribed), [i2, d] = e.useState(a == null ? void 0 : a.track), [u, v] = e.useState("landscape"), f = e.useRef(), { className: p, trackObserver: E } = e.useMemo(() => ys(t), [
    t.participant.sid ?? t.participant.identity,
    t.source,
    B(t) && t.publication.trackSid
  ]);
  return e.useEffect(() => {
    const h = E.subscribe((m) => {
      L.debug("update track", m), c(m), s2(m == null ? void 0 : m.isMuted), l(m == null ? void 0 : m.isSubscribed), d(m == null ? void 0 : m.track);
    });
    return () => h == null ? void 0 : h.unsubscribe();
  }, [E]), e.useEffect(() => {
    var h, m;
    return i2 && (f.current && i2.detach(f.current), (h = n.element) != null && h.current && !(t.participant.isLocal && (i2 == null ? void 0 : i2.kind) === "audio") && i2.attach(n.element.current)), f.current = (m = n.element) == null ? void 0 : m.current, () => {
      f.current && (i2 == null || i2.detach(f.current));
    };
  }, [i2, n.element]), e.useEffect(() => {
    var h, m;
    if (typeof ((h = a == null ? void 0 : a.dimensions) == null ? void 0 : h.width) == "number" && typeof ((m = a == null ? void 0 : a.dimensions) == null ? void 0 : m.height) == "number") {
      const y = a.dimensions.width > a.dimensions.height ? "landscape" : "portrait";
      v(y);
    }
  }, [a]), {
    publication: a,
    isMuted: r,
    isSubscribed: o,
    track: i2,
    elementProps: G2(n.props, {
      className: p,
      "data-lk-local-participant": t.participant.isLocal,
      "data-lk-source": a == null ? void 0 : a.source,
      ...(a == null ? void 0 : a.kind) === "video" && { "data-lk-orientation": u }
    })
  };
}
var Y;
var ue2;
function Lt2() {
  if (ue2) return Y;
  ue2 = 1;
  var t = "Expected a function", n = NaN, a = "[object Symbol]", c = /^\s+|\s+$/g, r = /^[-+]0x[0-9a-f]+$/i, s2 = /^0b[01]+$/i, o = /^0o[0-7]+$/i, l = parseInt, i2 = typeof es == "object" && es && es.Object === Object && es, d = typeof self == "object" && self && self.Object === Object && self, u = i2 || d || Function("return this")(), v = Object.prototype, f = v.toString, p = Math.max, E = Math.min, h = function() {
    return u.Date.now();
  };
  function m(g, R, w) {
    var M2, P2, O2, L3, b, T2, F2 = 0, re2 = false, Z2 = false, D3 = true;
    if (typeof g != "function")
      throw new TypeError(t);
    R = N2(R) || 0, y(w) && (re2 = !!w.leading, Z2 = "maxWait" in w, O2 = Z2 ? p(N2(w.maxWait) || 0, R) : O2, D3 = "trailing" in w ? !!w.trailing : D3);
    function U2(k2) {
      var x2 = M2, H3 = P2;
      return M2 = P2 = void 0, F2 = k2, L3 = g.apply(H3, x2), L3;
    }
    function xe2(k2) {
      return F2 = k2, b = setTimeout(W3, R), re2 ? U2(k2) : L3;
    }
    function Pe2(k2) {
      var x2 = k2 - T2, H3 = k2 - F2, se2 = R - x2;
      return Z2 ? E(se2, O2 - H3) : se2;
    }
    function ce3(k2) {
      var x2 = k2 - T2, H3 = k2 - F2;
      return T2 === void 0 || x2 >= R || x2 < 0 || Z2 && H3 >= O2;
    }
    function W3() {
      var k2 = h();
      if (ce3(k2))
        return le2(k2);
      b = setTimeout(W3, Pe2(k2));
    }
    function le2(k2) {
      return b = void 0, D3 && M2 ? U2(k2) : (M2 = P2 = void 0, L3);
    }
    function Te2() {
      b !== void 0 && clearTimeout(b), F2 = 0, M2 = T2 = P2 = b = void 0;
    }
    function Ae2() {
      return b === void 0 ? L3 : le2(h());
    }
    function G3() {
      var k2 = h(), x2 = ce3(k2);
      if (M2 = arguments, P2 = this, T2 = k2, x2) {
        if (b === void 0)
          return xe2(T2);
        if (Z2)
          return b = setTimeout(W3, R), U2(T2);
      }
      return b === void 0 && (b = setTimeout(W3, R)), L3;
    }
    return G3.cancel = Te2, G3.flush = Ae2, G3;
  }
  function y(g) {
    var R = typeof g;
    return !!g && (R == "object" || R == "function");
  }
  function C(g) {
    return !!g && typeof g == "object";
  }
  function A3(g) {
    return typeof g == "symbol" || C(g) && f.call(g) == a;
  }
  function N2(g) {
    if (typeof g == "number")
      return g;
    if (A3(g))
      return n;
    if (y(g)) {
      var R = typeof g.valueOf == "function" ? g.valueOf() : g;
      g = y(R) ? R + "" : R;
    }
    if (typeof g != "string")
      return g === 0 ? g : +g;
    g = g.replace(c, "");
    var w = s2.test(g);
    return w || o.test(g) ? l(g.slice(2), w ? 2 : 8) : r.test(g) ? n : +g;
  }
  return Y = m, Y;
}
var zt3 = Lt2();
var de2 = Hr(zt3);
function Vt3(t) {
  const n = (0, import_react2.useRef)(t);
  n.current = t, (0, import_react2.useEffect)(
    () => () => {
      n.current();
    },
    []
  );
}
function Ft2(t, n = 500, a) {
  const c = (0, import_react2.useRef)();
  Vt3(() => {
    c.current && c.current.cancel();
  });
  const r = (0, import_react2.useMemo)(() => {
    const s2 = de2(t, n, a), o = (...l) => s2(...l);
    return o.cancel = () => {
      s2.cancel();
    }, o.isPending = () => !!c.current, o.flush = () => s2.flush(), o;
  }, [t, n, a]);
  return (0, import_react2.useEffect)(() => {
    c.current = de2(t, n, a);
  }, [t, n, a]), r;
}
function Zt3(t, n, a) {
  const c = ((d, u) => d === u), r = t instanceof Function ? t() : t, [s2, o] = (0, import_react2.useState)(r), l = (0, import_react2.useRef)(r), i2 = Ft2(
    o,
    n,
    a
  );
  return c(l.current, r) || (i2(r), l.current = r), [s2, i2];
}
function Ht3({
  threshold: t = 0,
  root: n = null,
  rootMargin: a = "0%",
  freezeOnceVisible: c = false,
  initialIsIntersecting: r = false,
  onChange: s2
} = {}) {
  var o;
  const [l, i2] = (0, import_react2.useState)(null), [d, u] = (0, import_react2.useState)(() => ({
    isIntersecting: r,
    entry: void 0
  })), v = (0, import_react2.useRef)();
  v.current = s2;
  const f = ((o = d.entry) == null ? void 0 : o.isIntersecting) && c;
  (0, import_react2.useEffect)(() => {
    if (!l || !("IntersectionObserver" in window) || f)
      return;
    const h = new IntersectionObserver(
      (m) => {
        const y = Array.isArray(h.thresholds) ? h.thresholds : [h.thresholds];
        m.forEach((C) => {
          const A3 = C.isIntersecting && y.some((N2) => C.intersectionRatio >= N2);
          u({ isIntersecting: A3, entry: C }), v.current && v.current(A3, C);
        });
      },
      { threshold: t, root: n, rootMargin: a }
    );
    return h.observe(l), () => {
      h.disconnect();
    };
  }, [
    l,
    // eslint-disable-next-line react-hooks/exhaustive-deps
    JSON.stringify(t),
    n,
    a,
    f,
    c
  ]);
  const p = (0, import_react2.useRef)(null);
  (0, import_react2.useEffect)(() => {
    var h;
    !l && ((h = d.entry) != null && h.target) && !c && !f && p.current !== d.entry.target && (p.current = d.entry.target, u({ isIntersecting: r, entry: void 0 }));
  }, [l, d.entry, c, f, r]);
  const E = [
    i2,
    !!d.isIntersecting,
    d.entry
  ];
  return E.ref = E[0], E.isIntersecting = E[1], E.entry = E[2], E;
}
var Bt3 = e.forwardRef(
  function({
    onTrackClick: n,
    onClick: a,
    onSubscriptionStatusChanged: c,
    trackRef: r,
    manageSubscription: s2,
    ...o
  }, l) {
    const i2 = sa(r), d = e.useRef(null);
    e.useImperativeHandle(l, () => d.current);
    const u = Ht3({ root: d.current }), [v] = Zt3(u, 3e3);
    e.useEffect(() => {
      s2 && i2.publication instanceof RemoteTrackPublication && (v == null ? void 0 : v.isIntersecting) === false && (u == null ? void 0 : u.isIntersecting) === false && i2.publication.setSubscribed(false);
    }, [v, i2, s2]), e.useEffect(() => {
      s2 && i2.publication instanceof RemoteTrackPublication && (u == null ? void 0 : u.isIntersecting) === true && i2.publication.setSubscribed(true);
    }, [u, i2, s2]);
    const {
      elementProps: f,
      publication: p,
      isSubscribed: E
    } = Se2(i2, {
      element: d,
      props: o
    });
    e.useEffect(() => {
      c == null || c(!!E);
    }, [E, c]);
    const h = (m) => {
      a == null || a(m), n == null || n({ participant: i2 == null ? void 0 : i2.participant, track: p });
    };
    return e.createElement("video", { ref: d, ...f, muted: true, onClick: h });
  }
);
var ne3 = e.forwardRef(
  function({ trackRef: n, onSubscriptionStatusChanged: a, volume: c, ...r }, s2) {
    const o = sa(n), l = e.useRef(null);
    e.useImperativeHandle(s2, () => l.current);
    const {
      elementProps: i2,
      isSubscribed: d,
      track: u,
      publication: v
    } = Se2(o, {
      element: l,
      props: r
    });
    return e.useEffect(() => {
      a == null || a(!!d);
    }, [d, a]), e.useEffect(() => {
      u === void 0 || c === void 0 || (u instanceof RemoteAudioTrack ? u.setVolume(c) : L.warn("Volume can only be set on remote audio tracks."));
    }, [c, u]), e.useEffect(() => {
      v === void 0 || r.muted === void 0 || (v instanceof RemoteTrackPublication ? v.setEnabled(!r.muted) : L.warn("Can only call setEnabled on remote track publications."));
    }, [r.muted, v, u]), e.createElement("audio", { ref: l, ...i2 });
  }
);
function jt3(t) {
  const n = !!Go();
  return t.participant && !n ? e.createElement(Vn.Provider, { value: t.participant }, t.children) : e.createElement(e.Fragment, null, t.children);
}
function _t2(t) {
  const n = !!Bn();
  return t.trackRef && !n ? e.createElement(jn.Provider, { value: t.trackRef }, t.children) : e.createElement(e.Fragment, null, t.children);
}
var Ot2 = e.forwardRef(
  function({
    trackRef: n,
    children: a,
    onParticipantClick: c,
    disableSpeakingIndicator: r,
    ...s2
  }, o) {
    var p, E;
    const l = sa(n), { elementProps: i2 } = Hn2({
      htmlProps: s2,
      disableSpeakingIndicator: r,
      onParticipantClick: c,
      trackRef: l
    }), d = es2(l.participant), u = Ko(), v = (p = pa()) == null ? void 0 : p.autoSubscription, f = e.useCallback(
      (h) => {
        l.source && !h && u && u.pin.dispatch && ns(l, u.pin.state) && u.pin.dispatch({ msg: "clear_pin" });
      },
      [l, u]
    );
    return e.createElement("div", { ref: o, style: { position: "relative" }, ...i2 }, e.createElement(_t2, { trackRef: l }, e.createElement(jt3, { participant: l.participant }, a ?? e.createElement(e.Fragment, null, B(l) && (((E = l.publication) == null ? void 0 : E.kind) === "video" || l.source === Track.Source.Camera || l.source === Track.Source.ScreenShare) ? e.createElement(
      Bt3,
      {
        trackRef: l,
        onSubscriptionStatusChanged: f,
        manageSubscription: v
      }
    ) : B(l) && e.createElement(
      ne3,
      {
        trackRef: l,
        onSubscriptionStatusChanged: f
      }
    ), e.createElement("div", { className: "lk-participant-placeholder" }, e.createElement(Nt2, null)), e.createElement("div", { className: "lk-participant-metadata" }, e.createElement("div", { className: "lk-participant-metadata-item" }, l.source === Track.Source.Camera ? e.createElement(e.Fragment, null, d && e.createElement(Rt2, { style: { marginRight: "0.25rem" } }), e.createElement(
      be2,
      {
        trackRef: {
          participant: l.participant,
          source: Track.Source.Microphone
        },
        show: "muted"
      }
    ), e.createElement(K2, null)) : e.createElement(e.Fragment, null, e.createElement(Re2, { style: { marginRight: "0.25rem" } }), e.createElement(K2, null, "'s screen"))), e.createElement(ye3, { className: "lk-participant-metadata-item" }))), e.createElement(Tt, { trackRef: l }))));
  }
);
function Ea(t) {
  const n = G2(t, { className: "lk-focus-layout" });
  return e.createElement("div", { ...n }, t.children);
}
function pa2({ trackRef: t, ...n }) {
  return e.createElement(Ot2, { trackRef: t, ...n });
}
function Ce3({ tracks: t, ...n }) {
  return e.createElement(e.Fragment, null, t.map((a) => e.createElement(
    jn.Provider,
    {
      value: a,
      key: N(a)
    },
    H2(n.children)
  )));
}
function Wt3({
  totalPageCount: t,
  nextPage: n,
  prevPage: a,
  currentPage: c,
  pagesContainer: r
}) {
  const [s2, o] = e.useState(false);
  return e.useEffect(() => {
    let l;
    return r && (l = Js(r.current, 2e3).subscribe(
      o
    )), () => {
      l && l.unsubscribe();
    };
  }, [r]), e.createElement("div", { className: "lk-pagination-control", "data-lk-user-interaction": s2 }, e.createElement("button", { className: "lk-button", onClick: a }, e.createElement(ie2, null)), e.createElement("span", { className: "lk-pagination-count" }, `${c} of ${t}`), e.createElement("button", { className: "lk-button", onClick: n }, e.createElement(ie2, null)));
}
var qt3 = e.forwardRef(
  function({ totalPageCount: n, currentPage: a }, c) {
    const r = new Array(n).fill("").map((s2, o) => o + 1 === a ? e.createElement("span", { "data-lk-active": true, key: o }) : e.createElement("span", { key: o }));
    return e.createElement("div", { ref: c, className: "lk-pagination-indicator" }, r);
  }
);
function wa({ tracks: t, ...n }) {
  const a = e.createRef(), c = e.useMemo(
    () => G2(n, { className: "lk-grid-layout" }),
    [n]
  ), { layout: r } = On2(a, t.length), s2 = Fn2(r.maxTiles, t);
  return Gn(a, {
    onLeftSwipe: s2.nextPage,
    onRightSwipe: s2.prevPage
  }), e.createElement("div", { ref: a, "data-lk-pagination": s2.totalPageCount > 1, ...c }, e.createElement(Ce3, { tracks: s2.tracks }, n.children), t.length > r.maxTiles && e.createElement(e.Fragment, null, e.createElement(
    qt3,
    {
      totalPageCount: s2.totalPageCount,
      currentPage: s2.currentPage
    }
  ), e.createElement(Wt3, { pagesContainer: a, ...s2 })));
}
var $t3 = 130;
var Dt2 = 140;
var me2 = 1;
var Ie3 = 16 / 10;
var Ut3 = (1 - Ie3) * -1;
function ka({ tracks: t, orientation: n, ...a }) {
  const c = e.useRef(null), [r, s2] = e.useState(0), { width: o, height: l } = qt2(c), i2 = n || (l >= o ? "vertical" : "horizontal"), d = i2 === "vertical" ? Math.max(o * Ut3, $t3) : Math.max(l * Ie3, Dt2), u = rs(), v = Math.max(i2 === "vertical" ? (l - u) / d : (o - u) / d, me2);
  let f = Math.round(v);
  Math.abs(v - r) < 0.5 ? f = Math.round(r) : r !== v && s2(v);
  const p = zt2(t, f);
  return e.useLayoutEffect(() => {
    c.current && (c.current.dataset.lkOrientation = i2, c.current.style.setProperty("--lk-max-visible-tiles", f.toString()));
  }, [f, i2]), e.createElement("aside", { key: i2, className: "lk-carousel", ref: c, ...a }, e.createElement(Ce3, { tracks: p }, a.children));
}
function Ra({
  value: t,
  onPinChange: n,
  onWidgetChange: a,
  children: c
}) {
  const r = ia(t);
  return e.useEffect(() => {
    L.debug("PinState Updated", { state: r.pin.state }), n && r.pin.state && n(r.pin.state);
  }, [r.pin.state, n]), e.useEffect(() => {
    L.debug("Widget Updated", { widgetState: r.widget.state }), a && r.widget.state && a(r.widget.state);
  }, [a, r.widget.state]), e.createElement(Wn.Provider, { value: r }, c);
}
var Ma = e.forwardRef(
  function({ trackRef: n, ...a }, c) {
    const u = sa(n), v = ns2(u, { bands: 7, loPass: 300 });
    return e.createElement(
      "svg",
      {
        ref: c,
        width: "100%",
        height: "100%",
        viewBox: "0 0 200 90",
        ...a,
        className: "lk-audio-visualizer"
      },
      e.createElement("rect", { x: "0", y: "0", width: "100%", height: "100%" }),
      e.createElement(
        "g",
        {
          style: {
            transform: `translate(${130 / 2}px, 0)`
          }
        },
        v.map((f, p) => e.createElement(
          "rect",
          {
            key: p,
            x: p * 10,
            y: 90 / 2 - f * 50 / 2,
            width: 6,
            height: f * 50
          }
        ))
      )
    );
  }
);
function ya({ participants: t, ...n }) {
  return e.createElement(e.Fragment, null, t.map((a) => e.createElement(Vn.Provider, { value: a, key: a.identity }, H2(n.children))));
}
function ba({ room: t, volume: n, muted: a }) {
  const c = Yn(
    [Track.Source.Microphone, Track.Source.ScreenShareAudio, Track.Source.Unknown],
    {
      updateOnlyOn: [],
      onlySubscribed: true,
      room: t
    }
  ).filter((r) => !r.participant.isLocal && r.publication.kind === Track.Kind.Audio);
  return e.createElement("div", { style: { display: "none" } }, c.map((r) => e.createElement(
    ne3,
    {
      key: N(r),
      trackRef: r,
      volume: n,
      muted: a
    }
  )));
}
var Sa = e.forwardRef(function({ childrenPosition: n = "before", children: a, ...c }, r) {
  const { name: s2 } = Bn2();
  return e.createElement("span", { ref: r, ...c }, n === "before" && a, s2, n === "after" && a);
});
function Gt2(t) {
  const n = e.useMemo(() => G2(t, { className: "lk-toast" }), [t]);
  return e.createElement("div", { ...n }, t.children);
}
var Qt3 = (t) => {
  const n = [];
  for (let a = 0; a < t; a++)
    n.push([a, t - 1 - a]);
  return n;
};
var fe2 = (t) => [[Math.floor(t / 2)], [-1]];
var Xt3 = (t, n, a) => {
  const [c, r] = (0, import_react2.useState)(0), [s2, o] = (0, import_react2.useState)([[]]);
  (0, import_react2.useEffect)(() => {
    if (t === "thinking")
      o(fe2(n));
    else if (t === "connecting" || t === "initializing") {
      const i2 = [...Qt3(n)];
      o(i2);
    } else o(t === "listening" ? fe2(n) : t === void 0 || t === "speaking" ? [new Array(n).fill(0).map((i2, d) => d)] : [[]]);
    r(0);
  }, [t, n]);
  const l = (0, import_react2.useRef)(null);
  return (0, import_react2.useEffect)(() => {
    let i2 = performance.now();
    const d = (u) => {
      u - i2 >= a && (r((f) => f + 1), i2 = u), l.current = requestAnimationFrame(d);
    };
    return l.current = requestAnimationFrame(d), () => {
      l.current !== null && cancelAnimationFrame(l.current);
    };
  }, [a, n, t, s2.length]), s2[c % s2.length];
};
var Yt3 = /* @__PURE__ */ new Map([
  ["connecting", 2e3],
  ["initializing", 2e3],
  ["listening", 500],
  ["thinking", 150]
]);
var Jt3 = (t, n) => {
  if (t === void 0)
    return 1e3;
  let a = Yt3.get(t);
  if (a)
    switch (t) {
      case "connecting":
        a /= n;
        break;
    }
  return a;
};
var Kt3 = e.forwardRef(
  function({ state: n, options: a, barCount: c = 15, trackRef: r, track: s2, children: o, ...l }, i2) {
    const d = G2(l, { className: "lk-audio-bar-visualizer" });
    let u = Bn();
    (r || s2) && (u = r || s2);
    const v = ns2(u, {
      bands: c,
      loPass: 100,
      hiPass: 200
    }), f = (a == null ? void 0 : a.minHeight) ?? 20, p = (a == null ? void 0 : a.maxHeight) ?? 100, E = Xt3(
      n,
      c,
      Jt3(n, c) ?? 100
    );
    return e.createElement("div", { ref: i2, ...d, "data-lk-va-state": n }, v.map(
      (h, m) => o ? H2(o, {
        "data-lk-highlighted": E.includes(m),
        "data-lk-bar-index": m,
        className: "lk-audio-bar",
        style: { height: `${Math.min(p, Math.max(f, h * 100 + 5))}%` }
      }) : e.createElement(
        "span",
        {
          key: m,
          "data-lk-highlighted": E.includes(m),
          "data-lk-bar-index": m,
          className: `lk-audio-bar ${E.includes(m) && "lk-highlighted"}`,
          style: {
            // TODO transform animations would be more performant, however the border-radius gets distorted when using scale transforms. a 9-slice approach (or 3 in this case) could work
            // transform: `scale(1, ${Math.min(maxHeight, Math.max(minHeight, volume))}`,
            height: `${Math.min(p, Math.max(f, h * 100 + 5))}%`
          }
        }
      )
    ));
  }
);
var Ca = e.forwardRef(
  function({
    children: n,
    disableSpeakingIndicator: a,
    onParticipantClick: c,
    trackRef: r,
    ...s2
  }, o) {
    const l = sa(r), { elementProps: i2 } = Hn2({
      trackRef: l,
      htmlProps: s2,
      disableSpeakingIndicator: a,
      onParticipantClick: c
    });
    return e.createElement("div", { ref: o, style: { position: "relative", minHeight: "160px" }, ...i2 }, e.createElement(jn.Provider, { value: l }, n ?? e.createElement(e.Fragment, null, B(l) && e.createElement(ne3, { trackRef: l }), e.createElement(Kt3, { barCount: 7, options: { minHeight: 8 } }), e.createElement("div", { className: "lk-participant-metadata" }, e.createElement("div", { className: "lk-participant-metadata-item" }, e.createElement(be2, { trackRef: l }), e.createElement(K2, null)), e.createElement(ye3, { className: "lk-participant-metadata-item" })))));
  }
);
function Ia(t) {
  const [n, a] = e.useState(void 0), c = te2(t.room);
  return e.useEffect(() => {
    switch (c) {
      case ConnectionState.Reconnecting:
        a(
          e.createElement(e.Fragment, null, e.createElement(oe2, { className: "lk-spinner" }), " Reconnecting")
        );
        break;
      case ConnectionState.Connecting:
        a(
          e.createElement(e.Fragment, null, e.createElement(oe2, { className: "lk-spinner" }), " Connecting")
        );
        break;
      case ConnectionState.Disconnected:
        a(e.createElement(e.Fragment, null, "Disconnected"));
        break;
      default:
        a(void 0);
        break;
    }
  }, [c]), n ? e.createElement(Gt2, { className: "lk-toast-connection-state" }, n) : e.createElement(e.Fragment, null);
}
var xa = e.forwardRef(
  function({ entry: n, hideName: a = false, hideTimestamp: c = false, messageFormatter: r, ...s2 }, o) {
    var f, p, E, h;
    const l = e.useMemo(() => r ? r(n.message) : n.message, [n.message, r]), i2 = !!n.editTimestamp, d = new Date(n.timestamp), u = typeof navigator < "u" ? navigator.language : "en-US", v = ((f = n.from) == null ? void 0 : f.name) ?? ((p = n.from) == null ? void 0 : p.identity);
    return e.createElement(
      "li",
      {
        ref: o,
        className: "lk-chat-entry",
        title: d.toLocaleTimeString(u, { timeStyle: "full" }),
        "data-lk-message-origin": (E = n.from) != null && E.isLocal ? "local" : "remote",
        ...s2
      },
      (!c || !a || i2) && e.createElement("span", { className: "lk-meta-data" }, !a && e.createElement("strong", { className: "lk-participant-name" }, v), (!c || i2) && e.createElement("span", { className: "lk-timestamp" }, i2 && "edited ", d.toLocaleTimeString(u, { timeStyle: "short" }))),
      e.createElement("span", { className: "lk-message-body" }, l),
      e.createElement("span", { className: "lk-message-attachements" }, (h = n.attachedFiles) == null ? void 0 : h.map(
        (m) => m.type.startsWith("image/") && e.createElement(
          "img",
          {
            style: { maxWidth: "300px", maxHeight: "300px" },
            key: m.name,
            src: URL.createObjectURL(m),
            alt: m.name
          }
        )
      ))
    );
  }
);
function Pa(t) {
  return cs(t, as()).map((n, a) => {
    if (typeof n == "string")
      return n;
    {
      const c = n.content.toString(), r = n.type === "url" ? /^http(s?):\/\//.test(c) ? c : `https://${c}` : `mailto:${c}`;
      return e.createElement("a", { className: "lk-chat-link", key: a, href: r, target: "_blank", rel: "noreferrer" }, c);
    }
  });
}
function Ta(t) {
  return e.createElement(zn.Provider, { value: t.session }, e.createElement(Hn.Provider, { value: t.session.room }, t.children));
}

// node_modules/@livekit/components-react/dist/prefabs.mjs
function ee2({
  messageFormatter: r,
  messageDecoder: d,
  messageEncoder: u,
  channelTopic: n,
  ...S
}) {
  const g = e2.useRef(null), m = e2.useRef(null), l = e2.useMemo(() => ({ messageDecoder: d, messageEncoder: u, channelTopic: n }), [d, u, n]), { chatMessages: c, send: I3, isSending: t } = Kt2(l), h = Ko(), i2 = e2.useRef(0);
  async function v(s2) {
    s2.preventDefault(), m.current && m.current.value.trim() !== "" && (await I3(m.current.value), m.current.value = "", m.current.focus());
  }
  return e2.useEffect(() => {
    var s2;
    g && ((s2 = g.current) == null || s2.scrollTo({ top: g.current.scrollHeight }));
  }, [g, c]), e2.useEffect(() => {
    var o, E, a, w, b;
    if (!h || c.length === 0)
      return;
    if ((o = h.widget.state) != null && o.showChat && c.length > 0 && i2.current !== ((E = c[c.length - 1]) == null ? void 0 : E.timestamp)) {
      i2.current = (a = c[c.length - 1]) == null ? void 0 : a.timestamp;
      return;
    }
    const s2 = c.filter(
      (A3) => !i2.current || A3.timestamp > i2.current
    ).length, { widget: f } = h;
    s2 > 0 && ((w = f.state) == null ? void 0 : w.unreadMessages) !== s2 && ((b = f.dispatch) == null || b.call(f, { msg: "unread_msg", count: s2 }));
  }, [c, h == null ? void 0 : h.widget]), e2.createElement("div", { ...S, className: "lk-chat" }, e2.createElement("div", { className: "lk-chat-header" }, "Messages", h && e2.createElement(sa2, { className: "lk-close-button" }, e2.createElement(oa2, null))), e2.createElement("ul", { className: "lk-list lk-chat-messages", ref: g }, S.children ? c.map(
    (s2, f) => H2(S.children, {
      entry: s2,
      key: s2.id ?? f,
      messageFormatter: r
    })
  ) : c.map((s2, f, o) => {
    const E = f >= 1 && o[f - 1].from === s2.from, a = f >= 1 && s2.timestamp - o[f - 1].timestamp < 6e4;
    return e2.createElement(
      xa,
      {
        key: s2.id ?? f,
        hideName: E,
        hideTimestamp: E === false ? false : a,
        entry: s2,
        messageFormatter: r
      }
    );
  })), e2.createElement("form", { className: "lk-chat-form", onSubmit: v }, e2.createElement(
    "input",
    {
      className: "lk-form-control lk-chat-form-input",
      disabled: t,
      ref: m,
      type: "text",
      placeholder: "Enter a message...",
      onInput: (s2) => s2.stopPropagation(),
      onKeyDown: (s2) => s2.stopPropagation(),
      onKeyUp: (s2) => s2.stopPropagation()
    }
  ), e2.createElement("button", { type: "submit", className: "lk-button lk-chat-form-button", disabled: t }, "Send")));
}
function O({
  kind: r,
  initialSelection: d,
  onActiveDeviceChange: u,
  tracks: n,
  requestPermissions: S = false,
  ...g
}) {
  const [m, l] = e2.useState(false), [c, I3] = e2.useState([]), [t, h] = e2.useState(true), [i2, v] = e2.useState(S), s2 = (a, w) => {
    L.debug("handle device change"), l(false), u == null || u(a, w);
  }, f = e2.useRef(null), o = e2.useRef(null);
  e2.useLayoutEffect(() => {
    m && v(true);
  }, [m]), e2.useLayoutEffect(() => {
    let a;
    return f.current && o.current && (c || t) && (a = os(f.current, o.current, (w, b) => {
      o.current && Object.assign(o.current.style, { left: `${w}px`, top: `${b}px` });
    })), h(false), () => {
      a == null || a();
    };
  }, [f, o, c, t]);
  const E = e2.useCallback(
    (a) => {
      o.current && a.target !== f.current && m && ss(o.current, a) && l(false);
    },
    [m, o, f]
  );
  return e2.useEffect(() => (document.addEventListener("click", E), () => {
    document.removeEventListener("click", E);
  }), [E]), e2.createElement(e2.Fragment, null, e2.createElement(
    "button",
    {
      className: "lk-button lk-button-menu",
      "aria-pressed": m,
      ...g,
      onClick: () => l(!m),
      ref: f
    },
    g.children
  ), !g.disabled && e2.createElement(
    "div",
    {
      className: "lk-device-menu",
      ref: o,
      style: { visibility: m ? "visible" : "hidden" }
    },
    r ? e2.createElement(
      fa2,
      {
        initialSelection: d,
        onActiveDeviceChange: (a) => s2(r, a),
        onDeviceListChange: I3,
        kind: r,
        track: n == null ? void 0 : n[r],
        requestPermissions: i2
      }
    ) : e2.createElement(e2.Fragment, null, e2.createElement("div", { className: "lk-device-menu-heading" }, "Audio inputs"), e2.createElement(
      fa2,
      {
        kind: "audioinput",
        onActiveDeviceChange: (a) => s2("audioinput", a),
        onDeviceListChange: I3,
        track: n == null ? void 0 : n.audioinput,
        requestPermissions: i2
      }
    ), e2.createElement("div", { className: "lk-device-menu-heading" }, "Video inputs"), e2.createElement(
      fa2,
      {
        kind: "videoinput",
        onActiveDeviceChange: (a) => s2("videoinput", a),
        onDeviceListChange: I3,
        track: n == null ? void 0 : n.videoinput,
        requestPermissions: i2
      }
    ))
  ));
}
function j2() {
  e2.useEffect(() => {
    Q();
  }, []);
}
function Ke2(r, d) {
  const [u, n] = e2.useState(), S = e2.useMemo(() => new _(), []);
  return e2.useEffect(() => {
    let g = false, m = [];
    return S.lock().then(async (l) => {
      try {
        (r.audio || r.video) && (m = await createLocalTracks(r), g ? m.forEach((c) => c.stop()) : n(m));
      } catch (c) {
        d && c instanceof Error ? d(c) : L.error(c);
      } finally {
        l();
      }
    }), () => {
      g = true, m.forEach((l) => {
        l.stop();
      });
    };
  }, [JSON.stringify(r, T), d, S]), u;
}
function et2(r, d, u) {
  const [n, S] = e2.useState(null), [g, m] = e2.useState(false), l = _n2({ kind: u }), [c, I3] = e2.useState(
    void 0
  ), [t, h] = e2.useState(), [i2, v] = e2.useState(d);
  e2.useEffect(() => {
    v(d);
  }, [d]);
  const s2 = async (E, a) => {
    try {
      const w = a === "videoinput" ? await createLocalVideoTrack({
        deviceId: E,
        resolution: VideoPresets.h720.resolution
      }) : await createLocalAudioTrack({ deviceId: E }), b = await w.getDeviceId(false);
      b && E !== b && (o.current = b, v(b)), h(w);
    } catch (w) {
      w instanceof Error && S(w);
    }
  }, f = async (E, a) => {
    await E.setDeviceId(a), o.current = a;
  }, o = e2.useRef(i2);
  return e2.useEffect(() => {
    r && !t && !n && !g && (L.debug("creating track", u), m(true), s2(i2, u).finally(() => {
      m(false);
    }));
  }, [r, t, n, g]), e2.useEffect(() => {
    t && (r ? c != null && c.deviceId && o.current !== (c == null ? void 0 : c.deviceId) ? (L.debug(`switching ${u} device from`, o.current, c.deviceId), f(t, c.deviceId)) : (L.debug(`unmuting local ${u} track`), t.unmute()) : (L.debug(`muting ${u} track`), t.mute().then(() => L.debug(t.mediaStreamTrack))));
  }, [t, c, r, u]), e2.useEffect(() => () => {
    t && (L.debug(`stopping local ${u} track`), t.stop(), t.mute());
  }, []), e2.useEffect(() => {
    I3(l == null ? void 0 : l.find((E) => E.deviceId === i2));
  }, [i2, l]), {
    selectedDevice: c,
    localTrack: t,
    deviceError: n
  };
}
function tt2({
  defaults: r = {},
  onValidate: d,
  onSubmit: u,
  onError: n,
  debug: S,
  joinLabel: g = "Join Room",
  micLabel: m = "Microphone",
  camLabel: l = "Camera",
  userLabel: c = "Username",
  persistUserChoices: I3 = true,
  videoProcessor: t,
  ...h
}) {
  const {
    userChoices: i2,
    saveAudioInputDeviceId: v,
    saveAudioInputEnabled: s2,
    saveVideoInputDeviceId: f,
    saveVideoInputEnabled: o,
    saveUsername: E
  } = Zn2({
    defaults: r,
    preventSave: !I3,
    preventLoad: !I3
  }), [a, w] = e2.useState(i2), [b, A3] = e2.useState(a.audioEnabled), [y, L3] = e2.useState(a.videoEnabled), [T2, $2] = e2.useState(a.audioDeviceId), [p, M2] = e2.useState(a.videoDeviceId), [V2, ae2] = e2.useState(a.username);
  e2.useEffect(() => {
    s2(b);
  }, [b, s2]), e2.useEffect(() => {
    o(y);
  }, [y, o]), e2.useEffect(() => {
    v(T2);
  }, [T2, v]), e2.useEffect(() => {
    f(p);
  }, [p, f]), e2.useEffect(() => {
    E(V2);
  }, [V2, E]);
  const D3 = Ke2(
    {
      audio: b ? { deviceId: i2.audioDeviceId } : false,
      video: y ? { deviceId: i2.videoDeviceId, processor: t } : false
    },
    n
  ), U2 = e2.useRef(null), P2 = e2.useMemo(
    () => D3 == null ? void 0 : D3.filter((C) => C.kind === Track.Kind.Video)[0],
    [D3]
  ), ne4 = e2.useMemo(() => {
    if (P2) {
      const { facingMode: C } = facingModeFromLocalTrack(P2);
      return C;
    } else
      return "undefined";
  }, [P2]), q3 = e2.useMemo(
    () => D3 == null ? void 0 : D3.filter((C) => C.kind === Track.Kind.Audio)[0],
    [D3]
  );
  e2.useEffect(() => (U2.current && P2 && (P2.unmute(), P2.attach(U2.current)), () => {
    P2 == null || P2.detach();
  }), [P2]);
  const [ce3, se2] = e2.useState(), _2 = e2.useCallback(
    (C) => typeof d == "function" ? d(C) : C.username !== "",
    [d]
  );
  e2.useEffect(() => {
    const C = {
      username: V2,
      videoEnabled: y,
      videoDeviceId: p,
      audioEnabled: b,
      audioDeviceId: T2
    };
    w(C), se2(_2(C));
  }, [V2, y, _2, b, T2, p]);
  function re2(C) {
    C.preventDefault(), _2(a) ? typeof u == "function" && u(a) : L.warn("Validation failed with: ", a);
  }
  return j2(), e2.createElement("div", { className: "lk-prejoin", ...h }, e2.createElement("div", { className: "lk-video-container" }, P2 && e2.createElement("video", { ref: U2, width: "1280", height: "720", "data-lk-facing-mode": ne4 }), (!P2 || !y) && e2.createElement("div", { className: "lk-camera-off-note" }, e2.createElement(Nt2, null))), e2.createElement("div", { className: "lk-button-group-container" }, e2.createElement("div", { className: "lk-button-group audio" }, e2.createElement(
    va,
    {
      initialState: b,
      source: Track.Source.Microphone,
      onChange: (C) => A3(C)
    },
    m
  ), e2.createElement("div", { className: "lk-button-group-menu" }, e2.createElement(
    O,
    {
      initialSelection: T2,
      kind: "audioinput",
      disabled: !q3,
      tracks: { audioinput: q3 },
      onActiveDeviceChange: (C, F2) => $2(F2)
    }
  ))), e2.createElement("div", { className: "lk-button-group video" }, e2.createElement(
    va,
    {
      initialState: y,
      source: Track.Source.Camera,
      onChange: (C) => L3(C)
    },
    l
  ), e2.createElement("div", { className: "lk-button-group-menu" }, e2.createElement(
    O,
    {
      initialSelection: p,
      kind: "videoinput",
      disabled: !P2,
      tracks: { videoinput: P2 },
      onActiveDeviceChange: (C, F2) => M2(F2)
    }
  )))), e2.createElement("form", { className: "lk-username-container" }, e2.createElement(
    "input",
    {
      className: "lk-form-control",
      id: "username",
      name: "username",
      type: "text",
      defaultValue: V2,
      placeholder: c,
      onChange: (C) => ae2(C.target.value),
      autoComplete: "off"
    }
  ), e2.createElement(
    "button",
    {
      className: "lk-button lk-join-button",
      type: "submit",
      onClick: re2,
      disabled: !ce3
    },
    g
  )), S && e2.createElement(e2.Fragment, null, e2.createElement("strong", null, "User Choices:"), e2.createElement("ul", { className: "lk-list", style: { overflow: "hidden", maxWidth: "15rem" } }, e2.createElement("li", null, "Username: ", `${a.username}`), e2.createElement("li", null, "Video Enabled: ", `${a.videoEnabled}`), e2.createElement("li", null, "Audio Enabled: ", `${a.audioEnabled}`), e2.createElement("li", null, "Video Device: ", `${a.videoDeviceId}`), e2.createElement("li", null, "Audio Device: ", `${a.audioDeviceId}`))));
}
function Ge2({ props: r }) {
  const { dispatch: d, state: u } = ta().widget, n = "lk-button lk-settings-toggle";
  return { mergedProps: e2.useMemo(() => M(r, {
    className: n,
    onClick: () => {
      d && d({ msg: "toggle_settings" });
    },
    "aria-pressed": u != null && u.showSettings ? "true" : "false"
  }), [r, n, d, u]) };
}
var Je2 = e2.forwardRef(
  function(d, u) {
    const { mergedProps: n } = Ge2({ props: d });
    return e2.createElement("button", { ref: u, ...n }, d.children);
  }
);
var ze2 = (r) => {
  switch (r) {
    case Track.Source.Camera:
      return 1;
    case Track.Source.Microphone:
      return 2;
    case Track.Source.ScreenShare:
      return 3;
    default:
      return 0;
  }
};
function te3({
  variation: r,
  controls: d,
  saveUserChoices: u = true,
  onDeviceError: n,
  ...S
}) {
  var $2;
  const [g, m] = e2.useState(false), l = Ko();
  e2.useEffect(() => {
    var p, M2;
    ((p = l == null ? void 0 : l.widget.state) == null ? void 0 : p.showChat) !== void 0 && m((M2 = l == null ? void 0 : l.widget.state) == null ? void 0 : M2.showChat);
  }, [($2 = l == null ? void 0 : l.widget.state) == null ? void 0 : $2.showChat]);
  const I3 = kn2(`(max-width: ${g ? 1e3 : 760}px)`) ? "minimal" : "verbose";
  r ?? (r = I3);
  const t = { leave: true, ...d }, h = In2();
  if (!h)
    t.camera = false, t.chat = false, t.microphone = false, t.screenShare = false;
  else {
    const p = (M2) => h.canPublish && (h.canPublishSources.length === 0 || h.canPublishSources.includes(ze2(M2)));
    t.camera ?? (t.camera = p(Track.Source.Camera)), t.microphone ?? (t.microphone = p(Track.Source.Microphone)), t.screenShare ?? (t.screenShare = p(Track.Source.ScreenShare)), t.chat ?? (t.chat = h.canPublishData && (d == null ? void 0 : d.chat));
  }
  const i2 = e2.useMemo(
    () => r === "minimal" || r === "verbose",
    [r]
  ), v = e2.useMemo(
    () => r === "textOnly" || r === "verbose",
    [r]
  ), s2 = ds(), [f, o] = e2.useState(false), E = e2.useCallback(
    (p) => {
      o(p);
    },
    [o]
  ), a = G2({ className: "lk-control-bar" }, S), {
    saveAudioInputEnabled: w,
    saveVideoInputEnabled: b,
    saveAudioInputDeviceId: A3,
    saveVideoInputDeviceId: y
  } = Zn2({ preventSave: !u }), L3 = e2.useCallback(
    (p, M2) => M2 ? w(p) : null,
    [w]
  ), T2 = e2.useCallback(
    (p, M2) => M2 ? b(p) : null,
    [b]
  );
  return e2.createElement("div", { ...a }, t.microphone && e2.createElement("div", { className: "lk-button-group" }, e2.createElement(
    va,
    {
      source: Track.Source.Microphone,
      showIcon: i2,
      onChange: L3,
      onDeviceError: (p) => n == null ? void 0 : n({ source: Track.Source.Microphone, error: p })
    },
    v && "Microphone"
  ), e2.createElement("div", { className: "lk-button-group-menu" }, e2.createElement(
    O,
    {
      kind: "audioinput",
      onActiveDeviceChange: (p, M2) => A3(M2 ?? "default")
    }
  ))), t.camera && e2.createElement("div", { className: "lk-button-group" }, e2.createElement(
    va,
    {
      source: Track.Source.Camera,
      showIcon: i2,
      onChange: T2,
      onDeviceError: (p) => n == null ? void 0 : n({ source: Track.Source.Camera, error: p })
    },
    v && "Camera"
  ), e2.createElement("div", { className: "lk-button-group-menu" }, e2.createElement(
    O,
    {
      kind: "videoinput",
      onActiveDeviceChange: (p, M2) => y(M2 ?? "default")
    }
  ))), t.screenShare && s2 && e2.createElement(
    va,
    {
      source: Track.Source.ScreenShare,
      captureOptions: { audio: true, selfBrowserSurface: "include" },
      showIcon: i2,
      onChange: E,
      onDeviceError: (p) => n == null ? void 0 : n({ source: Track.Source.ScreenShare, error: p })
    },
    v && (f ? "Stop screen share" : "Share screen")
  ), t.chat && e2.createElement(sa2, null, i2 && e2.createElement(ua2, null), v && "Chat"), t.settings && e2.createElement(Je2, null, i2 && e2.createElement(da2, null), v && "Settings"), t.leave && e2.createElement(ia2, null, i2 && e2.createElement(ma, null), v && "Leave"), e2.createElement(ga, null));
}
function at2({
  chatMessageFormatter: r,
  chatMessageDecoder: d,
  chatMessageEncoder: u,
  SettingsComponent: n,
  ...S
}) {
  var s2, f;
  const [g, m] = e2.useState({
    showChat: false,
    unreadMessages: 0,
    showSettings: false
  }), l = e2.useRef(null), c = Yn(
    [
      { source: Track.Source.Camera, withPlaceholder: true },
      { source: Track.Source.ScreenShare, withPlaceholder: false }
    ],
    { updateOnlyOn: [RoomEvent.ActiveSpeakersChanged], onlySubscribed: false }
  ), I3 = (o) => {
    L.debug("updating widget state", o), m(o);
  }, t = ra(), h = c.filter(B).filter((o) => o.publication.source === Track.Source.ScreenShare), i2 = (s2 = Vn2(t)) == null ? void 0 : s2[0], v = c.filter((o) => !ts(o, i2));
  return e2.useEffect(() => {
    var o, E, a, w, b, A3;
    if (h.some((y) => y.publication.isSubscribed) && l.current === null ? (L.debug("Auto set screen share focus:", { newScreenShareTrack: h[0] }), (E = (o = t.pin).dispatch) == null || E.call(o, { msg: "set_pin", trackReference: h[0] }), l.current = h[0]) : l.current && !h.some(
      (y) => {
        var L3, T2;
        return y.publication.trackSid === ((T2 = (L3 = l.current) == null ? void 0 : L3.publication) == null ? void 0 : T2.trackSid);
      }
    ) && (L.debug("Auto clearing screen share focus."), (w = (a = t.pin).dispatch) == null || w.call(a, { msg: "clear_pin" }), l.current = null), i2 && !B(i2)) {
      const y = c.find(
        (L3) => L3.participant.identity === i2.participant.identity && L3.source === i2.source
      );
      y !== i2 && B(y) && ((A3 = (b = t.pin).dispatch) == null || A3.call(b, { msg: "set_pin", trackReference: y }));
    }
  }, [
    h.map((o) => `${o.publication.trackSid}_${o.publication.isSubscribed}`).join(),
    (f = i2 == null ? void 0 : i2.publication) == null ? void 0 : f.trackSid,
    c
  ]), j2(), e2.createElement("div", { className: "lk-video-conference", ...S }, is() && e2.createElement(
    Ra,
    {
      value: t,
      onWidgetChange: I3
    },
    e2.createElement("div", { className: "lk-video-conference-inner" }, i2 ? e2.createElement("div", { className: "lk-focus-layout-wrapper" }, e2.createElement(Ea, null, e2.createElement(ka, { tracks: v }, e2.createElement(Ot2, null)), i2 && e2.createElement(pa2, { trackRef: i2 }))) : e2.createElement("div", { className: "lk-grid-layout-wrapper" }, e2.createElement(wa, { tracks: c }, e2.createElement(Ot2, null))), e2.createElement(te3, { controls: { chat: true, settings: !!n } })),
    e2.createElement(
      ee2,
      {
        style: { display: g.showChat ? "grid" : "none" },
        messageFormatter: r,
        messageEncoder: u,
        messageDecoder: d
      }
    ),
    n && e2.createElement(
      "div",
      {
        className: "lk-settings-menu-modal",
        style: { display: g.showSettings ? "block" : "none" }
      },
      e2.createElement(n, null)
    )
  ), e2.createElement(ba, null), e2.createElement(Ia, null));
}
function nt2({ ...r }) {
  const [d, u] = e2.useState({
    showChat: false,
    unreadMessages: 0
  }), n = Yn([Track.Source.Microphone]);
  return j2(), e2.createElement(Ra, { onWidgetChange: u }, e2.createElement("div", { className: "lk-audio-conference", ...r }, e2.createElement("div", { className: "lk-audio-conference-stage" }, e2.createElement(Ce3, { tracks: n }, e2.createElement(Ca, null))), e2.createElement(
    te3,
    {
      controls: { microphone: true, screenShare: false, camera: false, chat: true }
    }
  ), d.showChat && e2.createElement(ee2, null)));
}
function ct2({
  controls: r,
  saveUserChoices: d = true,
  onDeviceError: u,
  ...n
}) {
  const S = { leave: true, microphone: true, ...r }, g = In2(), { microphoneTrack: m, localParticipant: l } = Oe2(), c = e2.useMemo(() => ({
    participant: l,
    source: Track.Source.Microphone,
    publication: m
  }), [l, m]);
  g ? S.microphone ?? (S.microphone = g.canPublish) : S.microphone = false;
  const I3 = G2({ className: "lk-agent-control-bar" }, n), { saveAudioInputEnabled: t, saveAudioInputDeviceId: h } = Zn2({
    preventSave: !d
  }), i2 = e2.useCallback(
    (v, s2) => {
      s2 && t(v);
    },
    [t]
  );
  return e2.createElement("div", { ...I3 }, S.microphone && e2.createElement("div", { className: "lk-button-group" }, e2.createElement(
    va,
    {
      source: Track.Source.Microphone,
      showIcon: true,
      onChange: i2,
      onDeviceError: (v) => u == null ? void 0 : u({ source: Track.Source.Microphone, error: v })
    },
    e2.createElement(Kt3, { trackRef: c, barCount: 7, options: { minHeight: 5 } })
  ), e2.createElement("div", { className: "lk-button-group-menu" }, e2.createElement(
    O,
    {
      kind: "audioinput",
      onActiveDeviceChange: (v, s2) => h(s2 ?? "default")
    }
  ))), S.leave && e2.createElement(ia2, null, "Disconnect"), e2.createElement(ga, null));
}
export {
  dn2 as AgentEvent,
  nt2 as AudioConference,
  ne3 as AudioTrack,
  Ma as AudioVisualizer,
  Kt3 as BarVisualizer,
  pt2 as CameraDisabledIcon,
  wt2 as CameraIcon,
  ka as CarouselLayout,
  ee2 as Chat,
  oa2 as ChatCloseIcon,
  xa as ChatEntry,
  ua2 as ChatIcon,
  sa2 as ChatToggle,
  ie2 as Chevron,
  ca2 as ClearPinButton,
  ye3 as ConnectionQualityIndicator,
  la2 as ConnectionState,
  Ia as ConnectionStateToast,
  te3 as ControlBar,
  ia2 as DisconnectButton,
  pa2 as FocusLayout,
  Ea as FocusLayoutContainer,
  Tt as FocusToggle,
  kt2 as FocusToggleIcon,
  da2 as GearIcon,
  wa as GridLayout,
  Xo as LKFeatureContext,
  Wn as LayoutContext,
  Ra as LayoutContextProvider,
  ma as LeaveIcon,
  W2 as LiveKitRoom,
  Rt2 as LockLockedIcon,
  O as MediaDeviceMenu,
  fa2 as MediaDeviceSelect,
  vn2 as MessagesEvent,
  Mt2 as MicDisabledIcon,
  yt2 as MicIcon,
  Ca as ParticipantAudioTile,
  Vn as ParticipantContext,
  jt3 as ParticipantContextIfNeeded,
  ya as ParticipantLoop,
  K2 as ParticipantName,
  Nt2 as ParticipantPlaceholder,
  Ot2 as ParticipantTile,
  tt2 as PreJoin,
  bt2 as QualityExcellentIcon,
  St as QualityGoodIcon,
  Ct2 as QualityPoorIcon,
  It2 as QualityUnknownIcon,
  ba as RoomAudioRenderer,
  Hn as RoomContext,
  Sa as RoomName,
  Re2 as ScreenShareIcon,
  xt3 as ScreenShareStopIcon,
  pn2 as SessionEvent,
  Ta as SessionProvider,
  oe2 as SpinnerIcon,
  ha as StartAudio,
  ga as StartMediaButton,
  Gt2 as Toast,
  Ce3 as TrackLoop,
  be2 as TrackMutedIndicator,
  jn as TrackRefContext,
  _t2 as TrackRefContextIfNeeded,
  va as TrackToggle,
  Pt2 as UnfocusToggleIcon,
  at2 as VideoConference,
  Bt3 as VideoTrack,
  ct2 as VoiceAssistantControlBar,
  Pa as formatChatMessageLinks,
  B as isTrackReference,
  ls as setLogExtension,
  us as setLogLevel,
  Ie2 as useAgent,
  wn2 as useAudioPlayback,
  ss2 as useAudioWaveform,
  Kt2 as useChat,
  Jn2 as useChatToggle,
  Pn2 as useClearPinButton,
  Ln2 as useConnectionQualityIndicator,
  te2 as useConnectionState,
  ra as useCreateLayoutContext,
  An2 as useDataChannel,
  Rn2 as useDisconnectButton,
  ia as useEnsureCreateLayoutContext,
  na as useEnsureLayoutContext,
  ca as useEnsureParticipant,
  la as useEnsureRoom,
  da as useEnsureSession,
  sa as useEnsureTrackRef,
  us2 as useEvents,
  Bt2 as useFacingMode,
  pa as useFeatureContext,
  Dn2 as useFocusToggle,
  On2 as useGridLayout,
  es2 as useIsEncrypted,
  Se as useIsMuted,
  as2 as useIsRecording,
  jt2 as useIsSpeaking,
  ta as useLayoutContext,
  $ as useLiveKitRoom,
  Oe2 as useLocalParticipant,
  In2 as useLocalParticipantPermissions,
  Ko as useMaybeLayoutContext,
  Go as useMaybeParticipantContext,
  Qo as useMaybeRoomContext,
  Jo as useMaybeSessionContext,
  Bn as useMaybeTrackRefContext,
  Nn2 as useMediaDeviceSelect,
  _n2 as useMediaDevices,
  ns2 as useMultibandTrackVolume,
  Fn2 as usePagination,
  rs2 as useParticipantAttribute,
  on2 as useParticipantAttributes,
  aa as useParticipantContext,
  xn2 as useParticipantInfo,
  Un2 as useParticipantPermissions,
  Hn2 as useParticipantTile,
  re as useParticipantTracks,
  Wt2 as useParticipants,
  Zn2 as usePersistentUserChoices,
  Vn2 as usePinnedTracks,
  et2 as usePreviewDevice,
  Ke2 as usePreviewTracks,
  qn as useRemoteParticipant,
  pe2 as useRemoteParticipants,
  ua as useRoomContext,
  Bn2 as useRoomInfo,
  cs2 as useSequentialRoomConnectDisconnect,
  is2 as useSession,
  fa as useSessionContext,
  ls2 as useSessionMessages,
  jn2 as useSortedParticipants,
  Gt as useSpeakingParticipants,
  zn2 as useStartAudio,
  Wn2 as useStartVideo,
  Gn as useSwipe,
  an2 as useTextStream,
  $n2 as useToken,
  Xn2 as useTrackByName,
  Qn as useTrackMutedIndicator,
  oa as useTrackRefContext,
  Kn as useTrackToggle,
  rn2 as useTrackTranscription,
  ts2 as useTrackVolume,
  Yn as useTracks,
  cn2 as useTranscriptions,
  zt2 as useVisualStableUpdate,
  os2 as useVoiceAssistant
};
//# sourceMappingURL=@livekit_components-react.js.map
